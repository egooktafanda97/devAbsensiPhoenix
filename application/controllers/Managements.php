<?php
header('Access-Control-Allow-Origin: *');
defined('BASEPATH') OR exit('No direct script access allowed');

class Managements extends CI_Controller {

    
    function __construct(){
        parent::__construct();
        $this->load->model('Agivest_model');
        $this->load->model('Home_model');
        $this->load->model('Email_model');
        // $this->load->model('OnlineCashierEmailLibrary');
        $this->load->helper('form');
        $this->load->helper('url');
        $this->load->helper('cookie');
        $this->load->helper('html');
        $this->load->helper('string');
        $this->load->library('form_validation');
        $this->load->library('session');
        $this->load->library('upload');
    }

    protected $statsSent = 0;
    
//-------------------------Tampilan Dashboard-------------------------------------------------


    public function index()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];
            $kodeDesa = $namaadmin['kodeDesa'];

            $result = array();
            $hasil['kontenKK'] = "";

            $data['dataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE kodeDesa='$kodeDesa'");

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");

            $NIKUSERLOGINED="";
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $NIKUSERLOGINED = $row->NIK;
            }

            $data['showLayananRequest'] = $this->Home_model->getSelectData("*,DATE_FORMAT(notification.tglCreated, '%d-%b-%Y %H:%i:%s WIB') tglLahirFormat, notification.keterangan ketx","notification,penduduk", "WHERE notification.idPengirim=penduduk.NIK AND notification.idPenerima=$NIKUSERLOGINED  AND notification.statusNotif IN('belum_dibaca') ORDER BY notification.tglCreated DESC LIMIT 3");
            $data['showLayananRequestAll'] = $this->Home_model->getSelectData("*,DATE_FORMAT(notification.tglCreated, '%d-%b-%Y %H:%i:%s WIB') tglLahirFormat, notification.keterangan ketx","notification,penduduk", "WHERE notification.idPengirim=penduduk.NIK AND notification.idPenerima=$NIKUSERLOGINED  AND notification.statusNotif IN('belum_dibaca') ");
            

            $data['dataToday'] = $this->Home_model->getSelectData("*","notification", "WHERE DATE(tglCreated)=CURDATE()  AND notification.statusNotif NOT IN ('hapus') GROUP BY randomCode,idPenerima");
            $data['dataWeek'] = $this->Home_model->getSelectData("*","notification", "WHERE WEEK(tglCreated)=WEEK(NOW()) AND notification.statusNotif NOT IN ('hapus') GROUP BY randomCode,idPenerima");
            $data['dataYear'] = $this->Home_model->getSelectData("*","notification", "WHERE YEAR(tglCreated)=YEAR(NOW()) AND notification.statusNotif NOT IN ('hapus') GROUP BY randomCode,idPenerima");
            $data['dataMonth'] = $this->Home_model->getSelectData("*","notification", "WHERE MONTH(tglCreated)=MONTH(NOW()) AND notification.statusNotif NOT IN ('hapus') GROUP BY randomCode,idPenerima");


            $data['dataSuratWaiting'] = $this->Home_model->getSelectData("*","notification", "WHERE  notification.statusNotif IN ('selesai') GROUP BY randomCode");
            $data['dataSuratAll'] = $this->Home_model->getSelectData("*","notification", "WHERE  notification.statusNotif NOT IN ('hapus') GROUP BY randomCode");

            

            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");


            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/index' , $data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }


    public function getSignKades()
    {
        // if($this->session->userdata('adminSession')){        
        //     $namaadmin = $this->session->userdata('adminSession');
        //     $data['namaLengkap'] = $namaadmin['namaLengkap'];
        //     $userLoginName = $namaadmin['namaLengkap'];
        //     $data['levelUser'] = $namaadmin['levelUser'];
        //     $data['idUser'] = $namaadmin['idUser'];
            
        //     $idUser = $namaadmin['idUser'];

        //     $namaUser = "";
        //     $pictureUser = "";
        //     $jabatan = "";

            $idKades = $this->input->post('idData');

            $getDataKades = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idKades AND jabatan='Kepala Desa'");

            foreach ($getDataKades->result() as $row) {
                $pictureUser = $row->pictureSignature;
            }
            //Menampilkan Array dalam Format JSON
                        if ($pictureUser) {
                            $hasil['resultnya'] = base_url().$pictureUser;
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "Tidak ada ttd";
                            echo json_encode($hasil);
                        }
        // }else{

        //     $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        // }

        // $this->load->view('index');
    }

    public function showInfografis_mobile()
    {
            $keyword="0";
            $keyword = $this->uri->segment(3);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['ternak'] = $this->Home_model->getSelectData("SUM(jumlahTernak) jmlTernak, jenisTernak","data_ternak", " GROUP BY jenisTernak ORDER BY jenisTernak ASC");
                $data['pendidikanAnak'] = $this->Home_model->getSelectData("COUNT(idPenduduk) jmlSiswa, pendidikanTerakhir","penduduk", " GROUP BY pendidikanTerakhir ORDER BY pendidikanTerakhir ASC");
                $data['pendidikanMasihSekolah'] = $this->Home_model->getSelectData("COUNT(idPenduduk) jmlSiswa, pendidikanTerakhir","penduduk", "WHERE pendidikanTerakhir NOT LIKE '%BELUM TAMAT%'");
                $data['pendidikanTidakSekolah'] = $this->Home_model->getSelectData("COUNT(idPenduduk) jmlSiswa, pendidikanTerakhir","penduduk", "WHERE pendidikanTerakhir LIKE '%BELUM TAMAT%' AND kedudukanDalamKeluarga='ANAK'");

                $data['dataBerita'] = $this->Home_model->getSelectData("*","berita_desa", "ORDER BY RAND() LIMIT 5");
                $data['dataSekolah'] = $this->Home_model->getSelectData("*","data_sekolah", "WHERE status='Aktif'");
                $data['dataLembagaKesehatan'] = $this->Home_model->getSelectData("*","data_lembaga_kesehatan", "WHERE status='Aktif'");
                $data['dataKeberagamanAgama'] = $this->Home_model->getSelectData("*,COUNT(NIK) mmm","penduduk", "WHERE jenisPengurangan='' GROUP BY agama");
                $data['dataAlamatPenduduk'] = $this->Home_model->getSelectData("*","penduduk", "WHERE jenisPengurangan=''");
                $data['dataBanyakDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE statusDusun='aktif'");
                $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                $data['getDataMonografiUmum'] = $this->Home_model->getSelectData("*","data_monografi_umum", "WHERE status='Aktif'");
                $data['ternak'] = $this->Home_model->getSelectData("SUM(jumlahTernak) jmlTernak, jenisTernak","data_ternak", " GROUP BY jenisTernak ORDER BY jenisTernak ASC");
                $data['ternakLengkap'] = $this->Home_model->getSelectData("*","data_ternak", " WHERE status='Aktif' ORDER BY pemilik ASC");
                $data['getDataPenduduk'] = $this->Home_model->getSelectData("*, COUNT(NIK) jmlPenduduk, (SELECT COUNT(*) FROM penduduk WHERE jenisKelamin='LAKI-LAKI' AND jenisPengurangan='') jmlPria,(SELECT COUNT(*) FROM penduduk WHERE jenisKelamin='PEREMPUAN'  AND jenisPengurangan='') jmlWanita","penduduk", "WHERE jenisPengurangan=''");
                $data['getDataPekerjaanGroup'] = $this->Home_model->getSelectData("*, COUNT(NIK) jmlPenduduk,(@cnt := @cnt + 1) AS rowNumber","penduduk", "CROSS JOIN (SELECT @cnt := 0) AS dummy WHERE jenisPengurangan='' GROUP BY pekerjaan ORDER BY jmlPenduduk DESC LIMIT 5");
                $e = $this->Home_model->getSelectData("*, COUNT(NIK) jmlPenduduk ","penduduk", "WHERE jenisPengurangan='' GROUP BY pekerjaan ORDER BY jmlPenduduk DESC LIMIT 1");
                
                $maxNilai = 0;
                foreach($e->result() as $r){
                    $maxNilai = $r->jmlPenduduk;
                }
                $data['getDataPekerjaanGroupMax'] = $maxNilai;

                $data['getDataBalita'] = $this->Home_model->getSelectData("*","penduduk", "WHERE ((YEAR(NOW()) - YEAR(tanggalLahir)) between 0 and 1) AND  jenisPengurangan=''");
                $data['getDataAnakAnak'] = $this->Home_model->getSelectData("*","penduduk", "WHERE ((YEAR(NOW()) - YEAR(tanggalLahir)) between 2 and 10) AND  jenisPengurangan=''");
                $data['getDataRemaja'] = $this->Home_model->getSelectData("*","penduduk", "WHERE ((YEAR(NOW()) - YEAR(tanggalLahir)) between 11 and 19) AND  jenisPengurangan=''");
                $data['getDataDewasa'] = $this->Home_model->getSelectData("*","penduduk", "WHERE ((YEAR(NOW()) - YEAR(tanggalLahir)) between 20 and 60) AND  jenisPengurangan=''");
                $data['getLansia'] = $this->Home_model->getSelectData("*","penduduk", "WHERE ((YEAR(NOW()) - YEAR(tanggalLahir)) > 60) AND  jenisPengurangan=''");

                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/monografi/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }

    }


    //-------------------------Biodata Penduduk - Formulir Kartu Keluarga-(F1) --------------------------------------


    public function f1_kartu_keluarga()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataFormInisial'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE kode_formulir='f1'");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "WHERE kedudukanDalamKeluarga='KEPALA KELUARGA' ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f1_kartu_keluarga";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f1_kartu_keluarga/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

  


    public function add_f1_kartu_keluarga()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f1",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f1_kartu_keluarga' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            
                                $dataInput = array(
                                      'kode_formulir' => "f1_kartu_keluarga",
                                      'idPengirim' => "-",
                                      'idPenerima' => "-",
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request kartu keluarga",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }

    public function add_f1_kartu_keluarga_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f1",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f1_kartu_keluarga' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }



                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f1_kartu_keluarga",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request kartu keluarga",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                        
                            

    }


    public function update_f1_kartu_keluarga()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f1",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f1_kartu_keluarga' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f1_kartu_keluarga()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f1_kartu_keluarga' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }




    public function selectUserByAjax()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%' || nomorKK LIKE '%$keyword%') AND kedudukanDalamKeluarga='KEPALA KELUARGA' ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }

    public function selectAllUserByAjax()
    {
        $result = array();

        $keyword = urldecode( $this->uri->segment(3));
        
        $kategoriOthers = $this->uri->segment(4);
        // $keyword = $this->input->post('term');

        $selectAllShop="";

        if($kategoriOthers!=""){
            if ($kategoriOthers=="ibu") {
                $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%' || nomorKK LIKE '%$keyword%') AND penduduk.jenisKelamin='PEREMPUAN' ORDER BY namaLengkap ASC");
            }else if ($kategoriOthers=="ayah") {
                $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%' || nomorKK LIKE '%$keyword%') AND penduduk.jenisKelamin='LAKI-LAKI' ORDER BY namaLengkap ASC");
            }
            
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%' || nomorKK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        }
       
        
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }

    public function cariWilayah()
    {
        $result = array();

        $keyword = urldecode( $this->uri->segment(3));
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","o_wilayah_indonesia", "WHERE nama LIKE '%$keyword%' ORDER BY nama ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'kode'  => $row->kode,
                'nama'  => $row->nama,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;

        }

        $selectByNomorKK = $this->Home_model->getSelectData("*","penduduk", "WHERE nomorKK='$noKK' AND NIK NOT IN($keyword)");
        foreach ($selectByNomorKK->result() as $row) {
            $hasil['kontenKK'].= '
                <input type="text" class="form-control" value="['.$row->kedudukanDalamKeluarga.'] '.$row->namaLengkap.'" readonly="" required="">
            ';

        }

        
            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        echo json_encode($hasil);

    }

    public function showPendudukData_f3()
    {

        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];
            $kodeDesa = $namaadmin['kodeDesa'];

            $result = array();
            $hasil['kontenKK'] = "";

            $data['dataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE kodeDesa='$kodeDesa'");
            


            $alamatTambahan ="";
            foreach ($data['dataDesa']->result() as $row) {
                $alamatTambahan = "Desa ".$row->namaDesa." Kecamatan ".$row->namaKecamatan." Kabupaten ".$row->namaKabupaten;

                $nmdesa = $row->namaDesa;
                $nmkecamatan = $row->namaKecamatan;
                $nmkabupaten = $row->namaKabupaten;
                $nmprovinsi = $row->namaProvinsi;
            }

            // $keyword = $this->uri->segment(3);
            $keyword = $this->input->post('NIK');

            $noKK;
            $namaKepalaKK;       $kelengkapanPenduduk;
            $NIKKepalaKeluarga;
            $pendidikanTerakhir;
            $pekerjaan;
            $agama;
            $tglLahir;
            $tglLahirReal;
            $umur;
            $pekerjaan;
            $kewarganegaraan;
            $tempatLahir;
            $namaKepalaKeluarga;
            $anakKe = 0;
            $jenisKelamin ;
            $alamatSekarang ;
            $alamatLengkap;
            $statusPerkawinan ;
            $dusunNow ;
            $namaAyah ;
            $namaIbu ;
            $anakKe;
            $kebangsaan;
            $dusun;
            $desa;
            $kecamatan;
            $kabupaten;
            $provinsi;
            $nomorRumah;
            $selectOrtu = $this->Home_model->getSelectData("*","penduduk_orangtua", "WHERE NIK='$keyword'");
            foreach ($selectOrtu->result() as $row) {
                $namaAyah = $row->namaAyah;
                $namaIbu = $row->namaIbu;
            }
            $selectAllShop = $this->Home_model->getSelectData("*,TIMESTAMPDIFF(YEAR,tanggalLahir,CURDATE()) as umur","penduduk", "WHERE NIK='$keyword'");
            foreach ($selectAllShop->result() as $row) {
                    //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

                $noKK = $row->nomorKK;
                $namaKepalaKK = $row->namaLengkap;
                $NIKKepalaKeluarga = $row->NIK;
                $pendidikanTerakhir = $row->pendidikanTerakhir;
                $pekerjaan = $row->pekerjaan;
                $agama = $row->agama;
                $tglLahir = $row->tanggalLahir;
                $tglLahirReal = $row->tanggalLahir;
                $umur = $row->umur;
                $pekerjaan = $row->pekerjaan;
                $kewarganegaraan = $row->kewarganegaraan;
                $tempatLahir = $row->tempatLahir;
                $jenisKelamin = $row->jenisKelamin;
                $alamatSekarang = $row->alamatLengkap;
                $alamatLengkap = $row->alamatLengkap;
                $statusPerkawinan = $row->statusPerkawinan;
                $anakke = explode(";", $row->kelahiran);
                $anakKe = $anakke[3];
                $bangsa = explode(";", $row->umum);
                $kebangsaan = $bangsa[3];
                $norumah = explode(";", $row->umum);
                $nomorRumah = $norumah[1];

            }

            $getDataPrimaryPenduduk = $this->Home_model->getSelectData("*","penduduk,penduduk_orangtua", "WHERE penduduk.NIK=penduduk_orangtua.NIK");
            foreach ($getDataPrimaryPenduduk->result() as $row) {
                if ( ($row->namaIbu=="default"||$row->namaAyah=="default") ) {
                    $kelengkapanPenduduk = "belum_lengkap";
                }
            }

            $selectKKDataKepalaKeluarga = $this->Home_model->getSelectData("*","penduduk", "WHERE nomorKK='$noKK' AND kedudukanDalamKeluarga='KEPALA KELUARGA'");
            foreach ($selectKKDataKepalaKeluarga->result() as $row) {
                $namaKepalaKeluargaReal = $row->namaLengkap;
            }

            $selectKKDataAnakKe = $this->Home_model->getSelectData("*, penduduk.NIK nikAnak","penduduk", "WHERE nomorKK='$noKK' AND kedudukanDalamKeluarga='KEPALA KELUARGA'");

            $tglLahir = explode("-", $tglLahir);
            $tglLahir = $tglLahir[2]."/".$tglLahir[1]."/".$tglLahir[0];


            $alamatSekarang = explode(",", $alamatSekarang);
            $dusunNow = strtoupper($alamatSekarang[0]);

            $alamatSekarang = $alamatSekarang[0]." ".strtoupper($alamatTambahan);

            

                //Menampilkan Array dalam Format JSON
            $hasil['noKK'] = $noKK;
            $hasil['kewarganegaraan'] = $kewarganegaraan;
            $hasil['tempatLahir'] = $tempatLahir;
            $hasil['namaKepalaKK'] = $namaKepalaKK;
            $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
            $hasil['pendidikanTerakhir'] = $pendidikanTerakhir;
            $hasil['agama'] = $agama;
            $hasil['tglLahir'] = $tglLahir;
            $hasil['tglLahirReal'] = $tglLahirReal;
            $hasil['umur'] = $umur;
            $hasil['alamatSekarang'] = $alamatSekarang;
            $hasil['alamatLengkap'] = $alamatLengkap;
            $hasil['dusunSekarang'] = $dusunNow;
            $hasil['jenisKelamin'] = $jenisKelamin;
            $hasil['pekerjaan'] = strtoupper($pekerjaan);
            $hasil['namaKepalaKeluargaReal'] = strtoupper($namaKepalaKeluargaReal);
            $hasil['anakKe'] = $anakKe;
            $hasil['statusPerkawinan'] = $statusPerkawinan;
            $hasil['namaAyah'] = $namaAyah;
            $hasil['namaIbu'] = $namaIbu;
            $hasil['anakKe'] = $anakKe;
            $hasil['kebangsaan'] = $kebangsaan;
            $hasil['dusun'] = ucwords(strtolower($dusunNow));
            $hasil['desa'] = $nmdesa;
            $hasil['kecamatan'] = $nmkecamatan;
            $hasil['kabupaten'] = $nmkabupaten;
            $hasil['provinsi'] = $nmprovinsi;
            $hasil['nomorRumah'] = $nomorRumah;
            




            echo json_encode($hasil);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

    }

    public function showPendudukData_f3_mobile()
    {

        
            $kodeDesa = "14.09.07.2005";

            $result = array();
            $hasil['kontenKK'] = "";

            $data['dataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE kodeDesa='$kodeDesa'");
            $alamatTambahan ="";
            foreach ($data['dataDesa']->result() as $row) {
                $alamatTambahan = "Kecamatan ".$row->namaKecamatan." Kabupaten ".$row->namaKabupaten;
            }

            // $keyword = $this->uri->segment(3);
            $keyword = $this->input->post('NIK');

            $noKK;
            $namaKepalaKK;       $kelengkapanPenduduk;
            $NIKKepalaKeluarga;
            $pendidikanTerakhir;
            $pekerjaan;
            $agama;
            $tglLahir;
            $tglLahirReal;
            $umur;
            $pekerjaan;
            $kewarganegaraan;
            $tempatLahir;
            $namaKepalaKeluarga;
            $anakKe = 0;
            $jenisKelamin ;
            $alamatSekarang ;
            $statusPerkawinan ;
            $dusunNow ;
            $namaAyah ;
            $namaOrtu ;
            $namaIbu ;
            $selectOrtu = $this->Home_model->getSelectData("*","penduduk_orangtua", "WHERE NIK='$keyword'");
            foreach ($selectOrtu->result() as $row) {
                $namaAyah = $row->namaAyah;
                $namaIbu = $row->namaIbu;
            }
            $selectAllShop = $this->Home_model->getSelectData("*,TIMESTAMPDIFF(YEAR,tanggalLahir,CURDATE()) as umur","penduduk", "WHERE NIK='$keyword'");
            foreach ($selectAllShop->result() as $row) {
                    //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

                $noKK = $row->nomorKK;
                $namaKepalaKK = $row->namaLengkap;
                $NIKKepalaKeluarga = $row->NIK;
                $pendidikanTerakhir = $row->pendidikanTerakhir;
                $pekerjaan = $row->pekerjaan;
                $agama = $row->agama;
                $tglLahir = $row->tanggalLahir;
                $tglLahirReal = $row->tanggalLahir;
                $umur = $row->umur;
                $pekerjaan = $row->pekerjaan;
                $kewarganegaraan = $row->kewarganegaraan;
                $tempatLahir = $row->tempatLahir;
                $jenisKelamin = $row->jenisKelamin;
                $alamatSekarang = $row->alamatLengkap;
                $statusPerkawinan = $row->statusPerkawinan;

            }

            $selectKKDataKepalaKeluarga = $this->Home_model->getSelectData("*","penduduk", "WHERE nomorKK='$noKK' AND kedudukanDalamKeluarga='KEPALA KELUARGA'");
            foreach ($selectKKDataKepalaKeluarga->result() as $row) {
                $namaKepalaKeluargaReal = $row->namaLengkap;
            }

            $selectKKDataAnakKe = $this->Home_model->getSelectData("*, penduduk.NIK nikAnak","penduduk", "WHERE nomorKK='$noKK' AND kedudukanDalamKeluarga='KEPALA KELUARGA'");

            $tglLahir = explode("-", $tglLahir);
            $tglLahir = $tglLahir[2]."/".$tglLahir[1]."/".$tglLahir[0];


            $alamatSekarang = explode(",", $alamatSekarang);
            $dusunNow = strtoupper($alamatSekarang[0]);

            $alamatSekarang = $alamatSekarang[0]." ".strtoupper($alamatTambahan);

            

                //Menampilkan Array dalam Format JSON
            $hasil['noKK'] = $noKK;
            $hasil['kewarganegaraan'] = $kewarganegaraan;
            $hasil['tempatLahir'] = $tempatLahir;
            $hasil['namaKepalaKK'] = $namaKepalaKK;
            $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
            $hasil['pendidikanTerakhir'] = $pendidikanTerakhir;
            $hasil['agama'] = $agama;
            $hasil['tglLahir'] = $tglLahir;
            $hasil['tglLahirReal'] = $tglLahirReal;
            $hasil['umur'] = $umur;
            $hasil['alamatSekarang'] = ucwords(strtolower($alamatSekarang));
            $hasil['dusunSekarang'] = $dusunNow;
            $hasil['jenisKelamin'] = $jenisKelamin;
            $hasil['pekerjaan'] = strtoupper($pekerjaan);
            $hasil['namaKepalaKeluargaReal'] = strtoupper($namaKepalaKeluargaReal);
            $hasil['anakKe'] = $anakKe;
            $hasil['statusPerkawinan'] = $statusPerkawinan;
            $hasil['namaAyah'] = $namaAyah;
            $hasil['namaIbu'] = $namaIbu;
            echo json_encode($hasil);
        
    }

    public function showPendudukData_f4_mobile()
    {

            $kodeDesa = "14.09.07.2005";

            $result = array();
            $hasil['kontenKK'] = "";

            $data['dataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE kodeDesa='$kodeDesa'");
            $alamatTambahan ="";
            foreach ($data['dataDesa']->result() as $row) {
                $alamatTambahan = "Kecamatan ".$row->namaKecamatan." Kabupaten ".$row->namaKabupaten;

                $nmdesa = $row->namaDesa;
                $nmkecamatan = $row->namaKecamatan;
                $nmkabupaten = $row->namaKabupaten;
                $nmprovinsi = $row->namaProvinsi;
            }

            // $keyword = $this->uri->segment(3);
            $keyword = $this->input->post('NIK');

            $noKK;
            $namaKepalaKK;       $kelengkapanPenduduk;
            $NIKKepalaKeluarga;
            $pendidikanTerakhir;
            $pekerjaan;
            $agama;
            $tglLahir;
            $umur;
            $pekerjaan;
            $kewarganegaraan;
            $tempatLahir;
            $namaKepalaKeluarga;
            $anakKe = 0;
            $jenisKelamin ;
            $alamatSekarang;
            $alamatLengkap;
            $statusPerkawinan ;
            $anakKe ;
            $kebangsaan;
            $dusun;
            $desa;
            $kecamatan;
            $kabupaten;
            $provinsi;
            $nomorRumah;
            $selectAllShop = $this->Home_model->getSelectData("*,TIMESTAMPDIFF(YEAR,tanggalLahir,CURDATE()) as umur","penduduk", "WHERE NIK='$keyword'");
            foreach ($selectAllShop->result() as $row) {
                    //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

                $noKK = $row->nomorKK;
                $namaKepalaKK = $row->namaLengkap;
                $NIKKepalaKeluarga = $row->NIK;
                $pendidikanTerakhir = $row->pendidikanTerakhir;
                $pekerjaan = $row->pekerjaan;
                $agama = $row->agama;
                $tglLahir = $row->tanggalLahir;
                $umur = $row->umur;
                $pekerjaan = $row->pekerjaan;
                $kewarganegaraan = $row->kewarganegaraan;
                $tempatLahir = $row->tempatLahir;
                $jenisKelamin = $row->jenisKelamin;
                $alamatSekarang = $row->alamatLengkap;
                $alamatLengkap = $row->alamatLengkap;
                $statusPerkawinan = $row->statusPerkawinan;
                $anakke = explode(";", $row->kelahiran);
                $anakKe = $anakke[3];
                $bangsa = explode(";", $row->umum);
                $kebangsaan = $bangsa[3];
                $norumah = explode(";", $row->umum);
                $nomorRumah = $norumah[1];

            }

            $selectKKDataKepalaKeluarga = $this->Home_model->getSelectData("*","penduduk", "WHERE nomorKK='$noKK' AND kedudukanDalamKeluarga='KEPALA KELUARGA'");
            foreach ($selectKKDataKepalaKeluarga->result() as $row) {
                $namaKepalaKeluargaReal = $row->namaLengkap;
            }

            $selectKKDataAnakKe = $this->Home_model->getSelectData("*, penduduk.NIK nikAnak","penduduk", "WHERE nomorKK='$noKK' AND kedudukanDalamKeluarga='KEPALA KELUARGA'");

            $tglLahir = explode("-", $tglLahir);
            $tglLahir = $tglLahir[2]."/".$tglLahir[1]."/".$tglLahir[0];

            $alamatSekarang = explode(",", $alamatSekarang);
            $dusunNow = strtoupper($alamatSekarang[0]);
            $alamatSekarang = $alamatSekarang[0]." ".strtoupper($alamatTambahan);

            
                //Menampilkan Array dalam Format JSON
            $hasil['noKK'] = $noKK;
            $hasil['kewarganegaraan'] = $kewarganegaraan;
            $hasil['tempatLahir'] = $tempatLahir;
            $hasil['namaKepalaKK'] = $namaKepalaKK;
            $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
            $hasil['pendidikanTerakhir'] = $pendidikanTerakhir;
            $hasil['agama'] = $agama;
            $hasil['tglLahir'] = $tglLahir;
            $hasil['tanggalLahir'] = $row->tanggalLahir;
            $hasil['umur'] = $umur;
            $hasil['alamatSekarang'] = $alamatSekarang;
            $hasil['alamatLengkap'] = $alamatLengkap;
            $hasil['jenisKelamin'] = $jenisKelamin;
            $hasil['pekerjaan'] = strtoupper($pekerjaan);
            $hasil['namaKepalaKeluargaReal'] = strtoupper($namaKepalaKeluargaReal);
            $hasil['statusPerkawinan'] = $statusPerkawinan;
            $hasil['anakKe'] = $anakKe;
            $hasil['kebangsaan'] = $kebangsaan;
            $hasil['dusun'] = ucwords(strtolower($dusunNow));
            $hasil['desa'] = $nmdesa;
            $hasil['kecamatan'] = $nmkecamatan;
            $hasil['kabupaten'] = $nmkabupaten;
            $hasil['provinsi'] = $nmprovinsi;
            $hasil['nomorRumah'] = $nomorRumah;
            echo json_encode($hasil);
        
    }


    public function showTableLayananRequest()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];
            $kodeDesa = $namaadmin['kodeDesa'];

            $NIKUSERLOGINED="";
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $NIKUSERLOGINED = $row->NIK;
            }

                $result = array();

                $keyword = $this->uri->segment(3);
                // $keyword = $this->input->post('term');

                if ($keyword!="") {
                    $selectAllShop = $this->Home_model->getSelectData("*, notification.keterangan ketx","notification,penduduk", "WHERE notification.idPengirim=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%' || penduduk.nomorKK LIKE '%$keyword%' || notification.keterangan LIKE '%$keyword%') AND notification.idPenerima=$NIKUSERLOGINED  AND notification.statusNotif NOT IN('hapus','selesai')  AND notification.keterangan NOT LIKE '%Hai,%'");    
                }else {
                    $selectAllShop = $this->Home_model->getSelectData("*, notification.keterangan ketx","notification,penduduk", "WHERE notification.idPengirim=penduduk.NIK AND notification.idPenerima=$NIKUSERLOGINED  AND notification.statusNotif NOT IN('hapus','selesai')  AND notification.keterangan NOT LIKE '%Hai,%'");
                }
               
                $number=0;
                $jabatan = "";
                $namaTable = "";
                $namaadmin = $this->session->userdata('adminSession');
                $idUser = $namaadmin['idUser'];
                $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
                foreach ($selectUser->result() as $row) {
                    $jabatan = strtolower($row->jabatan);
                }
          

                $btnSide = "";
                foreach ($selectAllShop->result() as $row) {
                        //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
                   
                    $parseKodeFormulir = $row->kode_formulir;
                    $parseKodeFormulirEx = explode("_", $parseKodeFormulir);

                    $namaTable = $row->kode_formulir;
                    $statusSigns="";
                    $statusPrints="";
                    $statusSignedGets = $this->Home_model->getSelectData("*",$namaTable, "WHERE $namaTable.randomCode='$row->randomCode'");
                    foreach ($statusSignedGets->result() as $roxzx) {
                        $statusSigns = $roxzx->tertandai;
                        $statusPrints = $roxzx->printed;
                    }

                    $noSuratConfirm ="";
                    $noSuratTerakhir ="";
                    $selectDataGet = $this->Home_model->getSelectData("*",$parseKodeFormulir, "WHERE randomCode='$row->randomCode'");
                    foreach ($selectDataGet->result() as $rem) {
                        $noSuratConfirm = $rem->nomorSurat;
                    }

                    $showSigned = "";
                    $showPrinted = "";

                    if($statusSigns!=null){
                        $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
                    }else {
                        if(strtolower($jabatan)=='kepala desa'){
                            $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                        }else {
                            $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                        }
                    }

                    if($statusPrints!=null){
                        $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
                    }else {
                        $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
                    }

                    $btnSend = "";
                        if($noSuratConfirm=='Diisi oleh pihak desa'){

                            $selectGetSecond = $this->Home_model->getSelectData("*",$parseKodeFormulir, "WHERE randomCode!='$row->randomCode' ORDER BY id DESC LIMIT 1");
                            foreach ($selectGetSecond->result() as $rem) {
                                $noSuratTerakhir = $rem->nomorSurat;
                            }

                            $btnSend = '<button type="button" onclick="change_no_surat(\''.$row->randomCode.'\',\''.$parseKodeFormulir.'\',\''.$noSuratTerakhir.'\')" class="btn btn-primary btn-mini waves-effect waves-light"><i class="fa fa-eye"></i>Tampilkan berkas</button>';
                        }else {
                            $btnSend = '<button type="button" onclick="window.open(\''.base_url().'Managements/printForm/'.$parseKodeFormulirEx[0].'/'.$row->randomCode.'\',\'_blank\')" class="btn btn-primary btn-mini waves-effect waves-light"><i class="fa fa-eye"></i>Tampilkan berkas</button>';
                        }
                    array_push($result,array(
                        $number+=1,
                        $row->namaLengkap,
                        $row->ketx,
                        $btnSend,
                        $showSigned." ".$showPrinted,
                        $btnSide='
                        <button type="button" onclick="change_stats('.$row->id.',\'belum_dibaca\',\''.$row->idPengirim.'\',\''.$row->kode_formulir.'\',\''.$row->ketx.'\',\''.$row->randomCode.'\')" class="btn '. (($row->statusNotif == "belum_dibaca") ? "btn-danger" : "btn-secondary") . '  btn-mini ketx-effect waves-light"><i class="fa fa-crosshairs"></i>Belum dibaca</button>
                        <button type="button" onclick="change_stats('.$row->id.',\'proses\',\''.$row->idPengirim.'\',\''.$row->kode_formulir.'\',\''.$row->ketx.'\',\''.$row->randomCode.'\')" class="btn '. (($row->statusNotif == "proses") ? "btn-warning" : "btn-secondary") . ' btn-mini waves-effect waves-light"><i class="icofont icofont-file"></i>Diproses</button>
                        <button type="button" onclick="change_stats('.$row->id.',\'selesai\',\''.$row->idPengirim.'\',\''.$row->kode_formulir.'\',\''.$row->ketx.'\',\''.$row->randomCode.'\')" class="btn '. (($row->statusNotif == "selesai") ? "btn-success" : "btn-secondary") . ' btn-mini waves-effect waves-light"><i class="icofont icofont-check"></i>Selesai</button>
                        '
                        
                    ));
                }

                
                    //Menampilkan Array dalam Format JSON
                echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));
            }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }
    }

    public function showTableLayananRequestSuccess()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];
            $kodeDesa = $namaadmin['kodeDesa'];

            $NIKUSERLOGINED="";
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $NIKUSERLOGINED = $row->NIK;
            }

                $result = array();

                $keyword = $this->uri->segment(3);
                // $keyword = $this->input->post('term');

                if ($keyword!="") {
                    $selectAllShop = $this->Home_model->getSelectData("*, notification.keterangan ketx","notification,penduduk", "WHERE notification.idPengirim=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%' || penduduk.nomorKK LIKE '%$keyword%') AND notification.idPenerima=$NIKUSERLOGINED AND notification.statusNotif='selesai'  AND notification.keterangan NOT LIKE '%Hai,%'");    
                }else {
                    $selectAllShop = $this->Home_model->getSelectData("*, notification.keterangan ketx","notification,penduduk", "WHERE notification.idPengirim=penduduk.NIK AND notification.idPenerima=$NIKUSERLOGINED  AND notification.statusNotif='selesai' AND notification.keterangan NOT LIKE '%Hai,%'");
                }
               
                

                $number=0;

           

                $btnSide = "";
                foreach ($selectAllShop->result() as $row) {
                        //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
                   
                    

                    array_push($result,array(
                        $number+=1,
                        $row->namaLengkap,
                        $row->ketx,
                        // ucfirst(strtolower($row->kode_formulir)),
                        $btnSide='
                        <button type="button" onclick="change_stats('.$row->id.',\'hapus\')" class="btn '. (($row->statusNotif == "hapus") ? "btn-success" : "btn-secondary") . ' btn-mini waves-effect waves-light"><i class="icofont icofont-close"></i>Hapus</button>
                        '
                        
                    ));
                }

                
                    //Menampilkan Array dalam Format JSON
                echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));
            }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }
    }

    public function change_stats_func()
    {

        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $NIKUSERLOGINED="";
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $NIKUSERLOGINED = $row->NIK;
            }

            $idData = $this->input->post('idData');
            $status = $this->input->post('status');
            $idPengirim = $this->input->post('idPengirim');
            $kode_formulir = $this->input->post('kode_formulir');
            $resultx = $this->input->post('resultx');
            $keterangan = $this->input->post('keterangan');
            $randomCode = $this->input->post('randomCode');

            $subjectSend = "";
            $statusSend = "";
            if($status=='belum_dibaca'){
                $subjectSend =  $keterangan." dalam proses";
                $statusSend = "Mohon menunggu, ".$keterangan." anda dalam proses pengecekan";
            }else if($status=='proses'){
                $subjectSend = $keterangan." sedang di proses";
                $statusSend = "Hai, harap menunggu ya, ".$keterangan." Anda sedang kami proses dan akan kami kabari dalam 2x24 jam";
            }else {
                $subjectSend = $keterangan." telah selesai";
                $statusSend = "Hai, ".$keterangan." Anda sudah selesai. Silahkan diambil ke kantor desa dalam waktu dekat. Terimakasih";
            }
            
                                    $dataInput = array(
                                          
                                          'statusNotif' => $status,
                                          
                                          
                                    );
                                    $simpan = $this->Home_model->updateData('notification' , $dataInput,"randomCode='$randomCode'");
                                    
                                

                                //Menampilkan Array dalam Format JSON
                                if ($simpan) {
                                    $hasil['resultnya'] = "true";
                                    echo json_encode($hasil);
                                }else {
                                    $hasil['resultnya'] = "false";
                                    echo json_encode($hasil);
                                }

                                //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                                $dataInput = array(
                                      'kode_formulir' => $kode_formulir,
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $idPengirim,
                                      'randomCode' => $resultx,
                                      'subjectNotif' => $subjectSend,
                                      'keterangan' => $statusSend,
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

                            

            
                            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }
        
        
                            

    }

    public function showTableF1()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f1_kartu_keluarga,penduduk", "WHERE f1_kartu_keluarga.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%' || penduduk.nomorKK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f1_kartu_keluarga,penduduk", "WHERE f1_kartu_keluarga.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f1_kartu_keluarga";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

           
        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
            
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                
                    $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }
            

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nomorKK,
                ucfirst(strtoupper($row->namaLengkap)),
                $showSigned . " " . $showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f1_kartu_keluarga(\''.$row->randomCode.'\',\''.$row->nomorKK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f1_kartu_keluarga('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f1_kartu_keluarga('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

    public function showTableF3()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f3_perubahan_data_kependudukan,penduduk", "WHERE f3_perubahan_data_kependudukan.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%' || penduduk.nomorKK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*, f3_perubahan_data_kependudukan.pekerjaan pekerjaanX, f3_perubahan_data_kependudukan.pendidikanTerakhir penterX, f3_perubahan_data_kependudukan.agama agamaX","f3_perubahan_data_kependudukan,penduduk", "WHERE f3_perubahan_data_kependudukan.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f3_perubahan_data_kependudukan";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->NIK,
                strtoupper($row->namaLengkap),
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f3_perubahan_data_kependudukan(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f3_perubahan_data_kependudukan('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\',\''.$row->penterX.'\',\''.$row->dasarPerubahanPendidikanTerakhir.'\',\''.$row->pekerjaanX.'\',\''.$row->dasarPerubahanPekerjaan.'\',\''.$row->agamaX.'\',\''.$row->dasarPerubahanAgama.'\',\''.$row->namaLengkap.'\',\''.$row->perubahanLainnyaKeterangan.'\',\''.$row->perubahanLainnya.'\',\''.$row->dasarPerubahanPerubahanLainnya.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f3_perubahan_data_kependudukan('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm()
    {
        // if($this->session->userdata('adminSession')){        
        //     $namaadmin = $this->session->userdata('adminSession');
        //     $data['namaLengkap'] = $namaadmin['namaLengkap'];
        //     $userLoginName = $namaadmin['namaLengkap'];
        //     $data['levelUser'] = $namaadmin['levelUser'];
        //     $data['idUser'] = $namaadmin['idUser'];
            
            // $idUser = $namaadmin['idUser'];
            $kodeDesa = "14.09.07.2005";

            // $namaUser = "";
            // $pictureUser = "";
            // $jabatan = "";

            // $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            // $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE kodeDesa='$kodeDesa'");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "WHERE kedudukanDalamKeluarga='KEPALA KELUARGA' ORDER BY namaLengkap ASC");
            
            // foreach ($selectUser->result() as $row) {
            //     # code...
            //     $namaUser = $row->namaLengkap;
            //     $pictureUser = $row->pictureProfile;
            //     $jabatan = $row->jabatan;
            // }

            // $data['namaUserGiven'] = $namaUser;
            // $data['pictureUserGiven'] = $pictureUser;
            // strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f1'){

                $value1 = $this->uri->segment(4);
                
                $data['showData'] = $this->Home_model->getSelectData("*","f1_kartu_keluarga, penduduk", "WHERE f1_kartu_keluarga.NIK=penduduk.NIK AND f1_kartu_keluarga.randomCode='$value1'");

                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $idNoKK = $row->nomorKK;
                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk,penduduk_orangtua", "WHERE penduduk.nomorKK=$idNoKK AND penduduk.NIK=penduduk_orangtua.NIK GROUP BY penduduk.NIK ORDER BY penduduk.kedudukanDalamKeluarga DESC");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");


                
                $this->load->view('adminPage/f1_kartu_keluarga/print/print_page' ,$data);
            }else if($kode_form=='f2'){

                $value1 = $this->uri->segment(4);
                

                $data['showData'] = $this->Home_model->getSelectData("*","f2_pendaftaran_peristiwa_kependudukan, penduduk", "WHERE f2_pendaftaran_peristiwa_kependudukan.NIK=penduduk.NIK AND f2_pendaftaran_peristiwa_kependudukan.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $this->load->view('adminPage/f2_pendaftaran_peristiwa_kependudukan/print/print_page' ,$data);
            }else if($kode_form=='f3'){

                $value1 = $this->uri->segment(4);
                

                $data['showData'] = $this->Home_model->getSelectData("*, f3_perubahan_data_kependudukan.pekerjaan pekerjaanX, f3_perubahan_data_kependudukan.pendidikanTerakhir penterX, f3_perubahan_data_kependudukan.agama agamaX","f3_perubahan_data_kependudukan, penduduk", "WHERE f3_perubahan_data_kependudukan.NIK=penduduk.NIK AND f3_perubahan_data_kependudukan.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $idNoKK = $row->nomorKK;
                    $ttd = $row->tertandai;
                }

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                $this->load->view('adminPage/f3_perubahan_data_kependudukan/print/print_page' ,$data);
            }else if($kode_form=='f4'){

                $value1 = $this->uri->segment(4);
                
                $data['showData'] = $this->Home_model->getSelectData("*","f4_formulir_permohonan_ktp, penduduk", "WHERE f4_formulir_permohonan_ktp.NIK=penduduk.NIK AND f4_formulir_permohonan_ktp.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                    
                    $ttd = $row->tertandai;
                }

                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");


                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $this->load->view('adminPage/f4_formulir_permohonan_ktp/print/print_page' ,$data);
            }else if($kode_form=='f5'){

                $value1 = $this->uri->segment(4);

                $data['showData'] = $this->Home_model->getSelectData("*,DATE_FORMAT(f5_surat_keterangan_domisili.tanggalLahir, '%d-%m-%Y') tanggalLahirx,LOWER(jenisKelamin)jenisKelamin,LOWER(statusPerkawinan)statusPerkawinan,LOWER(agama)agama,LOWER(jenisKelamin)jenisKelamin,LOWER(alamatDusun)alamatDusun,LOWER(pekerjaan)pekerjaan","f5_surat_keterangan_domisili", "WHERE f5_surat_keterangan_domisili.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                    $ttd = $row->tertandai;
                }

                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                
                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f5_surat_keterangan_domisili/print/print_page' ,$data);
            }else if($kode_form=='f6'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);

                $data['showData'] = $this->Home_model->getSelectData("*,LOWER(jenisKelamin) jenisKelamin,LOWER(agama) agama,LOWER(alamatLengkap) alamatLengkap,LOWER(pekerjaan) pekerjaan","f6_surat_ket_hilang_kk, penduduk", "WHERE f6_surat_ket_hilang_kk.NIK=penduduk.NIK AND f6_surat_ket_hilang_kk.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $idNoKK = $row->nomorKK;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk,penduduk_orangtua", "WHERE penduduk.nomorKK=$idNoKK AND penduduk.NIK=penduduk_orangtua.NIK  GROUP BY penduduk.NIK ORDER BY penduduk.kedudukanDalamKeluarga DESC");
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f6_surat_ket_hilang_kartu_keluarga/print/print_page' ,$data);
            }

            else if($kode_form=='f7'){

                $value1 = $this->uri->segment(4);
                

                $data['showData'] = $this->Home_model->getSelectData("*","f7_kepindahan, penduduk", "WHERE f7_kepindahan.NIK=penduduk.NIK AND f7_kepindahan.randomCode='$value1'");

                $xmxmx = "";
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $xmxmx.= $row->yangMengikuti;

                    $ttd = $row->tertandai;
                }

                $xmxmx = substr($xmxmx, 0,-1);
                $strForm = explode(";", $xmxmx);
                $xmx2="";
                for ($i=0; $i < count($strForm); $i++) { 
                    $xmx2.= "'".$strForm[$i]."',";
                }

                $xmx2 = substr($xmx2, 0,-1);

                $data['showDataPengikut'] = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.NIK IN ($xmx2) GROUP BY penduduk.NIK");

                

                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $this->load->view('adminPage/f7_kepindahan/print/print_page' ,$data);
            }

            else if($kode_form=='f8'){

                $value1 = $this->uri->segment(4);
                

                $data['showData'] = $this->Home_model->getSelectData("*","f8_suket_kelahiran, penduduk", "WHERE f8_suket_kelahiran.NIKAnak=penduduk.NIK AND f8_suket_kelahiran.randomCode='$value1' GROUP BY penduduk.NIK");

                $dataGenderPelapor;
                $dataGenderSaksi1;
                $dataGenderSaksi2;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $dataGenderPelapor = $row->dataPelapor;
                    $dataGenderSaksi1 = $row->dataSaksi1;
                    $dataGenderSaksi2 = $row->dataSaksi2;

                    $ttd = $row->tertandai;
                }

                $expGPelapor = explode(";", $dataGenderPelapor);
                $expGSaksi1 = explode(";", $dataGenderSaksi1);
                $expGSaksi2 = explode(";", $dataGenderSaksi2);

                $selectGenderPelaporX = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK=".$expGPelapor[5]);
                $selectGenderSaksi1X = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK=".$expGSaksi1[5]);
                $selectGenderSaksi2X = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK=".$expGSaksi2[5]);

                foreach ($selectGenderPelaporX->result() as $row) {
                    $dataGenderPelapor = $row->jenisKelamin;
                }
                foreach ($selectGenderSaksi1X->result() as $row) {
                    $dataGenderSaksi1 = $row->jenisKelamin;
                }
                foreach ($selectGenderSaksi2X->result() as $row) {
                    $dataGenderSaksi2 = $row->jenisKelamin;
                }

                $data['genderPelapor'] = $dataGenderPelapor;
                $data['genderSaksi1'] = $dataGenderSaksi1;
                $data['genderSaksi2'] = $dataGenderSaksi2;

                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $this->load->view('adminPage/f8_suket_kelahiran/print/print_page' ,$data);
            }else if($kode_form=='f9'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f9_kebenaran_data_kelahiran", "WHERE f9_kebenaran_data_kelahiran.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                
                $this->load->view('adminPage/f9_kebenaran_data_kelahiran/print/print_page' ,$data);
            }else if($kode_form=='f10'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f10_kebenaran_pasangan_suamiistri", "WHERE f10_kebenaran_pasangan_suamiistri.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                
                $this->load->view('adminPage/f10_kebenaran_pasangan_suamiistri/print/print_page' ,$data);
            }else if($kode_form=='f11'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f11_pernyataan_belummemiliki_aktalahir", "WHERE f11_pernyataan_belummemiliki_aktalahir.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                
                $this->load->view('adminPage/f11_pernyataan_belummemiliki_aktalahir/print/print_page' ,$data);
            }else if($kode_form=='f12'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f12_surat_keterangan_kematian", "WHERE f12_surat_keterangan_kematian.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['showDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif' LIMIT 1");
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                
                $this->load->view('adminPage/f12_surat_keterangan_kematian/print/print_page' ,$data);
            }else if($kode_form=='f13'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f13_surat_kematian", "WHERE f13_surat_kematian.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['showDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif' LIMIT 1");
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $this->load->view('adminPage/f13_surat_kematian/print/print_page_utama' ,$data);
            }else if($kode_form=='f13SK'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f13_surat_kematian", "WHERE f13_surat_kematian.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['showDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif' LIMIT 1");

                $data['showKetKematian'] = $this->Home_model->getSelectData("*","f12_surat_keterangan_kematian", "WHERE f12_surat_keterangan_kematian.NIK=$NIK");


                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                
                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f13_surat_kematian/print/print_page_sk' ,$data);
            }else if($kode_form=='f14'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*,DATE_FORMAT(f14_surat_keterangan_penguburan.tanggalLahir, '%d-%m-%Y'),LOWER(pekerjaan)pekerjaan","f14_surat_keterangan_penguburan", "WHERE f14_surat_keterangan_penguburan.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                
                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f14_surat_keterangan_penguburan/print/print_page' ,$data);
            }else if($kode_form=='f15'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);

                if ($value2=="n2") {
                    $data['showData'] = $this->Home_model->getSelectData("*","f15_surat_keterangan_pengantar_nikah", "WHERE f15_surat_keterangan_pengantar_nikah.randomCode='$value1'");

                    $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
                    $data['dataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE kodeDesa='14.09.07.2005'");

                    $idNoKK;
                    $ttd;
                    foreach ($data['showData']->result() as $row) {
                        $NIK = $row->NIK;

                        $ttd = $row->tertandai;
                    }

                    $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");
                    $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");

                    $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                    $this->load->view('adminPage/f15_surat_keterangan_pengantar_nikah/print/print_page_n2' ,$data);

                }else if ($value2=="n3") {
                    $data['showData'] = $this->Home_model->getSelectData("*","f15_surat_keterangan_pengantar_nikah", "WHERE f15_surat_keterangan_pengantar_nikah.randomCode='$value1'");

                    $idNoKK;
                    $ttd;
                    foreach ($data['showData']->result() as $row) {
                        $NIK = $row->NIK;

                        $ttd = $row->tertandai;
                    }

                    $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");
                    $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                    $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                    
                    $this->load->view('adminPage/f15_surat_keterangan_pengantar_nikah/print/print_page_n3' ,$data);
                    
                }else if ($value2=="n4") {
                    $data['showData'] = $this->Home_model->getSelectData("*","f15_surat_keterangan_pengantar_nikah", "WHERE f15_surat_keterangan_pengantar_nikah.randomCode='$value1'");

                    $idNoKK;
                    $ttd;
                    foreach ($data['showData']->result() as $row) {
                        $NIK = $row->NIK;

                        $ttd = $row->tertandai;
                    }

                    $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");
                    $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                    $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                    
                    $this->load->view('adminPage/f15_surat_keterangan_pengantar_nikah/print/print_page_n4' ,$data);
                    
                }else if ($value2=="n5") {
                    $data['showData'] = $this->Home_model->getSelectData("*","f15_surat_keterangan_pengantar_nikah", "WHERE f15_surat_keterangan_pengantar_nikah.randomCode='$value1'");

                    $idNoKK;
                    $ttd;
                    foreach ($data['showData']->result() as $row) {
                        $NIK = $row->NIK;

                        $ttd = $row->tertandai;
                    }

                    $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");
                    $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                    $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                    
                    $this->load->view('adminPage/f15_surat_keterangan_pengantar_nikah/print/print_page_n5' ,$data);
                    
                }else {

                    $data['showData'] = $this->Home_model->getSelectData("*","f15_surat_keterangan_pengantar_nikah", "WHERE f15_surat_keterangan_pengantar_nikah.randomCode='$value1'");

                    $idNoKK;
                    $ttd;
                    foreach ($data['showData']->result() as $row) {
                        $NIK = $row->NIK;

                        $ttd = $row->tertandai;
                    }

                    $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");
                    $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                    $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                    
                    $this->load->view('adminPage/f15_surat_keterangan_pengantar_nikah/print/print_page' ,$data);    
                }


                
            }else if($kode_form=='f16'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f16_surat_keterangan_pernah_nikah", "WHERE f16_surat_keterangan_pernah_nikah.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                    $NIKO = $row->NIKIstri;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                $data['showDataIstri'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIKO");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                
                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f16_surat_keterangan_pernah_nikah/print/print_page' ,$data);
            }else if($kode_form=='f17'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f17_surat_keterangan_belumpernahnikah", "WHERE f17_surat_keterangan_belumpernahnikah.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                
                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f17_surat_keterangan_belumpernahnikah/print/print_page' ,$data);
            }else if($kode_form=='f18'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f18_surat_keterangan_dudajanda", "WHERE f18_surat_keterangan_dudajanda.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                    $NIKO = $row->NIKPasanganTerdahulu;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                $data['showDataPasangan'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIKO");


                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f18_surat_keterangan_dudajanda/print/print_page' ,$data);
            }else if($kode_form=='f19'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f19_surat_keterangan_usaha", "WHERE f19_surat_keterangan_usaha.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                
                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f19_surat_keterangan_usaha/print/print_page' ,$data);
            }else if($kode_form=='f20'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*, LOWER(pekerjaan)pekerjaan","f20_surat_keterangan_tempat_usaha", "WHERE f20_surat_keterangan_tempat_usaha.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                
                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f20_surat_keterangan_tempat_usaha/print/print_page' ,$data);
            }else if($kode_form=='f21'){

                $value1 = $this->uri->segment(4);
                

                $data['showData'] = $this->Home_model->getSelectData("*","f21_suket_pengantar_barang, penduduk", "WHERE f21_suket_pengantar_barang.NIK=penduduk.NIK AND f21_suket_pengantar_barang.randomCode='$value1'");
                
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }
               
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f21_suket_pengantar_barang/print/print_page' ,$data);
            }else if($kode_form=='f22'){

                $value1 = $this->uri->segment(4);
                

                $data['showData'] = $this->Home_model->getSelectData("*","f22_suket_pengantar_ternak, penduduk", "WHERE f22_suket_pengantar_ternak.NIK=penduduk.NIK AND f22_suket_pengantar_ternak.randomCode='$value1'");

                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }
               
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");


                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f22_suket_pengantar_ternak/print/print_page' ,$data);

            }else if($kode_form=='f23'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*, LOWER(pekerjaanAyah)pekerjaanAy, LOWER(pekerjaanIbu)pekerjaanIb","f23_surat_keterangan_tidakmampusekolah", "WHERE f23_surat_keterangan_tidakmampusekolah.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                    $NIKA = $row->NIKAyah;
                    $NIKI = $row->NIKIbu;

                    $ttd = $row->tertandai;
                }
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['showDataAyah'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIKA");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f23_surat_keterangan_tidakmampusekolah/print/print_page' ,$data);
            }else if($kode_form=='f24'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f24_suket_tidakmampuumum", "WHERE f24_suket_tidakmampuumum.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                    $noKK = $row->nomorKK;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.nomorKK=$noKK AND penduduk.NIK NOT IN ($NIK)");
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                // $data['showKetKematian'] = $this->Home_model->getSelectData("*","f12_surat_keterangan_kematian", "WHERE f12_surat_keterangan_kematian.NIK=$NIK");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f24_suket_tidakmampuumum/print/print_page' ,$data);
            }else if($kode_form=='f25'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);

                $data['showData'] = $this->Home_model->getSelectData("*","f25_surat_keterangan_rumahtangga_miskinsekali, penduduk", "WHERE f25_surat_keterangan_rumahtangga_miskinsekali.NIK=penduduk.NIK AND f25_surat_keterangan_rumahtangga_miskinsekali.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f25_surat_keterangan_rumahtangga_miskinsekali/print/print_page' ,$data);
            }else if($kode_form=='f26'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f26_surat_keterangan_penghasilan_orangtua", "WHERE f26_surat_keterangan_penghasilan_orangtua.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                    $NIKO = $row->NIKOrangTua;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['showDataOrtu'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIKO");
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                
                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f26_surat_keterangan_penghasilan_orangtua/print/print_page' ,$data);
            }else if($kode_form=='f27'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f27_permohonan_izin_keramaian_pesta", "WHERE f27_permohonan_izin_keramaian_pesta.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f27_permohonan_izin_keramaian_pesta/print/print_page' ,$data);
            }else if($kode_form=='f28'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f28_surat_pengantar_skck", "WHERE f28_surat_pengantar_skck.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f28_surat_pengantar_SKCK/print/print_page' ,$data);
            }else if($kode_form=='f29'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f29_surat_keterangan_ahli_waris", "WHERE f29_surat_keterangan_ahli_waris.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                    $NIKO = $row->NIKPewaris;

                    $ttd = $row->tertandai;

                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                $data['showDataPewaris'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIKO");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                
                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f29_surat_keterangan_ahli_waris/print/print_page' ,$data);
            }else if($kode_form=='f30'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f30_surat_keterangan_bepergian", "WHERE f30_surat_keterangan_bepergian.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                
                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f30_surat_keterangan_bepergian/print/print_page' ,$data);
            }
            else if($kode_form=='f31'){

                $value1 = $this->uri->segment(4);
                
                $data['showData'] = $this->Home_model->getSelectData("*","f31_suket_tidak_ditempat, penduduk", "WHERE f31_suket_tidak_ditempat.NIK=penduduk.NIK AND f31_suket_tidak_ditempat.randomCode='$value1'");
                $data['showDetailDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE o_data_desa.kodeDesa='$kodeDesa'");

                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");

                $idNoKK;
                $namalain;
                $namalainOK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $idNoKK = $row->nomorKK;
                    $namalain = $row->NIKLain;

                    $ttd = $row->tertandai;
                }

                $getNamaLain = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.NIK='$namalain'");
                foreach ($getNamaLain->result() as $row) {
                    $namalainOK = $row->namaLengkap;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk,penduduk_orangtua", "WHERE penduduk.nomorKK=$idNoKK AND penduduk.NIK=penduduk_orangtua.NIK GROUP BY penduduk.NIK ORDER BY penduduk.kedudukanDalamKeluarga DESC");
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                $data['namaLainX'] = $namalainOK;

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                
                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f31_suket_tidak_ditempat/print/print_page' ,$data);
            }else if($kode_form=='f32'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f32_surat_keterangan_beda_identitas", "WHERE f32_surat_keterangan_beda_identitas.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f32_surat_keterangan_beda_identitas/print/print_page' ,$data);
            }else if($kode_form=='f33'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f33_surat_keterangan_lainnya", "WHERE f33_surat_keterangan_lainnya.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f33_surat_keterangan_lainnya/print/print_page' ,$data);
            }else if($kode_form=='f34'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f34_surat_keterangan_pencocokan", "WHERE f34_surat_keterangan_pencocokan.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f34_surat_keterangan_pencocokan/print/print_page1' ,$data);
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f34_surat_keterangan_pencocokan/print/print_page2' ,$data);
            }else if($kode_form=='f35'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f35_sporandik", "WHERE f35_sporandik.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f35_sporandik/print/print_page' ,$data);
            }else if($kode_form=='f36'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f36_surat_keterangan_kepemilikan_tanah", "WHERE f36_surat_keterangan_kepemilikan_tanah.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");
                 $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f36_surat_keterangan_kepemilikan_tanah/print/print_page' ,$data);
            }else if($kode_form=='f37'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f37_keterangan_jaminanrumah", "WHERE f37_keterangan_jaminanrumah.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                
                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f37_keterangan_jaminanrumah/print/print_page' ,$data);
            }else if($kode_form=='f38'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f38_permohonan_mutasi", "WHERE f38_permohonan_mutasi.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                    $ttd = $row->tertandai;
                }

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f38_permohonan_mutasi/print/print_page' ,$data);
            }else if($kode_form=='f38SPOP'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f38_permohonan_mutasi", "WHERE f38_permohonan_mutasi.randomCode='$value1'");

                $idNoKK;

                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                    $idMut = $row->id;
                }

                $data['showjumlahbangunan'] = $this->Home_model->getSelectData("*","f38_lampiran", "WHERE f38_lampiran.idMutasi=$idMut");

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                
                $this->load->view('adminPage/f38_permohonan_mutasi/print/print_spop' ,$data);
            }else if($kode_form=='f38Lampiran'){

               $value1 = $this->uri->segment(4);


                $data['showData'] = $this->Home_model->getSelectData("*,count(id) jumlahBangunan","f38_lampiran", "WHERE f38_lampiran.id='$value1'");

                $idMut;
                foreach ($data['showData']->result() as $row) {
                    $idMut = $row->idMutasi;
                }

                $data['showDataMutasi'] = $this->Home_model->getSelectData("*","f38_permohonan_mutasi", "WHERE f38_permohonan_mutasi.id=$idMut");

                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                
                $data['showjumlahbangunan'] = $this->Home_model->getSelectData("*","f38_lampiran", "WHERE f38_lampiran.idMutasi=$idMut");

                $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                
                $this->load->view('adminPage/f38_permohonan_mutasi/print/print_lampiran' ,$data);

            }
             else if($kode_form=='f39'){

                $value1 = $this->uri->segment(4);
                

                $data['showData'] = $this->Home_model->getSelectData("*","f39_keterangan_ahli_waris, penduduk", "WHERE f39_keterangan_ahli_waris.NIK=penduduk.NIK AND f39_keterangan_ahli_waris.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->kuasaAhliWaris;

                    $ttd = $row->tertandai;
                }

                // $data['showKuasa'] = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.NIK=$NIK");
               
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $this->load->view('adminPage/f39_keterangan_ahli_waris/print/print_page' ,$data);

            }else if($kode_form=='f40'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*,UPPER(jenisSurat)jenSurat","f40_keterangan_desa", "WHERE f40_keterangan_desa.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    // $NIK = $row->NIK;
                    $ttd = $row->tertandai;
                }
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                // $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                
                $this->load->view('adminPage/f40_keterangan_desa/print/print_page' ,$data);
            }else if($kode_form=='f41'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f41_surat_keterangan_hibah", "WHERE f41_surat_keterangan_hibah.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f41_surat_keterangan_hibah/print/print_page' ,$data);
            }else if($kode_form=='f42'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f42_surat_kuasa", "WHERE f42_surat_kuasa.randomCode='$value1'");

                $idNoKK;
                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;

                    $ttd = $row->tertandai;
                }
                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");
                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                
                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f42_surat_kuasa/print/print_page' ,$data);
            }else if($kode_form=='f43'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);

                $data['showData'] = $this->Home_model->getSelectData("*","f43_pengajuan_registrasiprodukumkm", "WHERE f43_pengajuan_registrasiprodukumkm.randomCode='$value1'");

                $ttd = "";
                $data['tertandai'] = $ttd; $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
                
                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f43_pengajuan_registrasiprodukumkm/print/print_page' ,$data);
            }else if($kode_form=='f44'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f44_surat_format_baru", "WHERE f44_surat_format_baru.randomCode='$value1'");

                $ttd;
                foreach ($data['showData']->result() as $row) {
                    $ttd = $row->tertandai;
                }

                $data['showDataWithTTDKepDes'] = $this->Home_model->getSelectData("*","user", "WHERE user.jabatan='Kepala Desa' AND user.pictureSignature LIKE 'assets%' LIMIT 1");

                $data['tertandai'] = $ttd;  $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['kopSurat'] = $this->Home_model->getSelectData("*","list_formulir", "WHERE list_formulir.kode_formulir='$kode_form'");
                
                $this->load->view('adminPage/template/kop_surat' ,$data);
                $this->load->view('adminPage/f44_surat_format_baru/print/print_page' ,$data);


           } else {

            }
              
            
        // }else{

        //     $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            // $this->load->view('loginregister/login.php',$data); 
        // }


    }


    public function f3_perubahan_data_kependudukan()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "WHERE kedudukanDalamKeluarga='KEPALA KELUARGA' ORDER BY namaLengkap ASC");
            $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
            $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
            $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f3_perubahan_data_kependudukan";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f3_perubahan_data_kependudukan/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

   


    public function f1_kartu_keluarga_mobile()
    {
            $keyword="0";
            $keyword = $this->uri->segment(3);
            $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }

    }

     public function f3_perubahan_data_kependudukan_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");

                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f3_perubahan_data_kependudukan/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }

     public function f7_kepindahan_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");

                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f7_kepindahan/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }

    public function f8_suket_kelahiran_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");


                //copy new-----------
                $noKK="";
                $nikayah="";
                $nikibu="";
                $getKK = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");
                foreach ($getKK->result() as $row) {
                    $noKK = $row->nomorKK;
                }
                $getDataAyah = $this->Home_model->getSelectData("*","penduduk", "WHERE nomorKK='$noKK' AND kedudukanDalamKeluarga='KEPALA KELUARGA'");
                foreach ($getDataAyah->result() as $row) {
                    $nikayah = $row->NIK;
                }
                $getDataIbu = $this->Home_model->getSelectData("*","penduduk", "WHERE nomorKK='$noKK' AND kedudukanDalamKeluarga='ISTRI'");
                foreach ($getDataIbu->result() as $row) {
                    $nikibu = $row->NIK;
                }
                $data['nikAYAH'] = $nikayah;
                $data['nikIBU'] = $nikibu;
                //copy new-----------

                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f8_suket_kelahiran/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }

    public function f21_suket_pengantar_barang_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "WHERE kedudukanDalamKeluarga='KEPALA KELUARGA' ORDER BY namaLengkap ASC");
                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");

                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f21_suket_pengantar_barang/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }

    public function f31_suket_tidak_ditempat_mobile()
    {

            $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "WHERE kedudukanDalamKeluarga='KEPALA KELUARGA' ORDER BY namaLengkap ASC");
                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");

                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f31_suket_tidak_ditempat/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }

    
    public function add_f3_perubahan_data_kependudukan()

    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        // $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $randomCode = $this->input->post('randomCode');
        
        $selectPendidikanTerakhirBaru = $this->input->post('selectPendidikanTerakhirBaru');
        $selectPekerjaanTerakhirBaru = $this->input->post('selectPekerjaanTerakhirBaru');
        $selectAgamaTerakhirBaru = $this->input->post('selectAgamaTerakhirBaru');
        
        $poinLainnya = $this->input->post('poinLainnya');
        $lainnyaBaru = $this->input->post('lainnyaBaru');
        $lainnyaNow = $this->input->post('lainnyaNow');
        $keteranganPerubahanLainnya = $this->input->post('keteranganPerubahanLainnya');
        $nomorPerubahanLainnya = $this->input->post('nomorPerubahanLainnya');
        $tglPerubahanLainnya = $this->input->post('tglPerubahanLainnya');
        
        $pendidikanTerakhirNow = $this->input->post('pendidikanTerakhirNow');
        $pekerjaanTerakhirNow = $this->input->post('pekerjaanTerakhirNow');
        $agamaTerakhirNow = $this->input->post('agamaTerakhirNow');
        
        $keteranganPerubahan = $this->input->post('keteranganPerubahan');
        $keteranganPerubahanPekerjaan = $this->input->post('keteranganPerubahanPekerjaan');
        $keteranganPerubahanAgama = $this->input->post('keteranganPerubahanAgama');
        
        $nomorPerubahan = $this->input->post('nomorPerubahan');
        $nomorPerubahanPekerjaan = $this->input->post('nomorPerubahanPekerjaan');
        $nomorPerubahanAgama = $this->input->post('nomorPerubahanAgama');
        
        $tglPerubahanPendidikan = $this->input->post('tglPerubahanPendidikan');
        $tglPerubahanPendidikanPekerjaan = $this->input->post('tglPerubahanPendidikanPekerjaan');
        $tglPerubahanAgama = $this->input->post('tglPerubahanAgama');
       
                        $dataInput = array(
                              'kode_formulir' => "f3",
                              'nomorSurat' => $noSurat,
                              'NIK' => $noKK,
                              
                              'pendidikanTerakhir' => $pendidikanTerakhirNow.";".$selectPendidikanTerakhirBaru,
                              'dasarPerubahanPendidikanTerakhir' => $keteranganPerubahan.";".$nomorPerubahan.";".$tglPerubahanPendidikan,

                              'pekerjaan' => $pekerjaanTerakhirNow.";".$selectPekerjaanTerakhirBaru,
                              'dasarPerubahanPekerjaan' => $keteranganPerubahanPekerjaan.";".$nomorPerubahanPekerjaan.";".$tglPerubahanPendidikanPekerjaan,

                              'agama' => $agamaTerakhirNow.";".$selectAgamaTerakhirBaru,
                              'agama' => $agamaTerakhirNow.";".$selectAgamaTerakhirBaru,
                              'dasarPerubahanAgama' => $keteranganPerubahanAgama.";".$nomorPerubahanAgama.";".$tglPerubahanAgama,

                              'perubahanLainnyaKeterangan' => $poinLainnya,
                              'perubahanLainnya' => $lainnyaNow.";".$lainnyaBaru,
                              'perubahanLainnya' => $lainnyaNow.";".$lainnyaBaru,
                              'dasarPerubahanPerubahanLainnya' => $keteranganPerubahanLainnya.";".$nomorPerubahanLainnya.";".$tglPerubahanLainnya,

                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f3_perubahan_data_kependudukan' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f3_perubahan_data_kependudukan_mobile()

    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        // $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $randomCode = $this->input->post('randomCode');
        
        $selectPendidikanTerakhirBaru = $this->input->post('selectPendidikanTerakhirBaru');
        $selectPekerjaanTerakhirBaru = $this->input->post('selectPekerjaanTerakhirBaru');
        $selectAgamaTerakhirBaru = $this->input->post('selectAgamaTerakhirBaru');
        
        $poinLainnya = $this->input->post('poinLainnya');
        $lainnyaBaru = $this->input->post('lainnyaBaru');
        $lainnyaNow = $this->input->post('lainnyaNow');
        $keteranganPerubahanLainnya = $this->input->post('keteranganPerubahanLainnya');
        $nomorPerubahanLainnya = $this->input->post('nomorPerubahanLainnya');
        $tglPerubahanLainnya = $this->input->post('tglPerubahanLainnya');
        
        $pendidikanTerakhirNow = $this->input->post('pendidikanTerakhirNow');
        $pekerjaanTerakhirNow = $this->input->post('pekerjaanTerakhirNow');
        $agamaTerakhirNow = $this->input->post('agamaTerakhirNow');
        
        $keteranganPerubahan = $this->input->post('keteranganPerubahan');
        $keteranganPerubahanPekerjaan = $this->input->post('keteranganPerubahanPekerjaan');
        $keteranganPerubahanAgama = $this->input->post('keteranganPerubahanAgama');
        
        $nomorPerubahan = $this->input->post('nomorPerubahan');
        $nomorPerubahanPekerjaan = $this->input->post('nomorPerubahanPekerjaan');
        $nomorPerubahanAgama = $this->input->post('nomorPerubahanAgama');
        
        $tglPerubahanPendidikan = $this->input->post('tglPerubahanPendidikan');
        $tglPerubahanPendidikanPekerjaan = $this->input->post('tglPerubahanPendidikanPekerjaan');
        $tglPerubahanAgama = $this->input->post('tglPerubahanAgama');
       
                        $dataInput = array(
                              'kode_formulir' => "f3",
                              'nomorSurat' => $noSurat,
                              'NIK' => $noKK,
                              
                              'pendidikanTerakhir' => $pendidikanTerakhirNow.";".$selectPendidikanTerakhirBaru,
                              'dasarPerubahanPendidikanTerakhir' => $keteranganPerubahan.";".$nomorPerubahan.";".$tglPerubahanPendidikan,

                              'pekerjaan' => $pekerjaanTerakhirNow.";".$selectPekerjaanTerakhirBaru,
                              'dasarPerubahanPekerjaan' => $keteranganPerubahanPekerjaan.";".$nomorPerubahanPekerjaan.";".$tglPerubahanPendidikanPekerjaan,

                              'agama' => $agamaTerakhirNow.";".$selectAgamaTerakhirBaru,
                              'agama' => $agamaTerakhirNow.";".$selectAgamaTerakhirBaru,
                              'dasarPerubahanAgama' => $keteranganPerubahanAgama.";".$nomorPerubahanAgama.";".$tglPerubahanAgama,

                              'perubahanLainnyaKeterangan' => $poinLainnya,
                              'perubahanLainnya' => $lainnyaNow.";".$lainnyaBaru,
                              'perubahanLainnya' => $lainnyaNow.";".$lainnyaBaru,
                              'dasarPerubahanPerubahanLainnya' => $keteranganPerubahanLainnya.";".$nomorPerubahanLainnya.";".$tglPerubahanLainnya,

                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f3_perubahan_data_kependudukan' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f3_perubahan_data_kependudukan",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request perubahan data kependudukan",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }

    public function update_f3_perubahan_data_kependudukan()

    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        // $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $randomCode = $this->input->post('randomCode');
        
        $selectPendidikanTerakhirBaru = $this->input->post('selectPendidikanTerakhirBaru');
        $selectPekerjaanTerakhirBaru = $this->input->post('selectPekerjaanTerakhirBaru');
        $selectAgamaTerakhirBaru = $this->input->post('selectAgamaTerakhirBaru');

        $poinLainnya = $this->input->post('poinLainnya');
        $lainnyaBaru = $this->input->post('lainnyaBaru');
        $lainnyaNow = $this->input->post('lainnyaNow');
        $keteranganPerubahanLainnya = $this->input->post('keteranganPerubahanLainnya');
        $nomorPerubahanLainnya = $this->input->post('nomorPerubahanLainnya');
        $tglPerubahanLainnya = $this->input->post('tglPerubahanLainnya');
        
        $pendidikanTerakhirNow = $this->input->post('pendidikanTerakhirNow');
        $pekerjaanTerakhirNow = $this->input->post('pekerjaanTerakhirNow');
        $agamaTerakhirNow = $this->input->post('agamaTerakhirNow');
        
        $keteranganPerubahan = $this->input->post('keteranganPerubahan');
        $keteranganPerubahanPekerjaan = $this->input->post('keteranganPerubahanPekerjaan');
        $keteranganPerubahanAgama = $this->input->post('keteranganPerubahanAgama');
        
        $nomorPerubahan = $this->input->post('nomorPerubahan');
        $nomorPerubahanPekerjaan = $this->input->post('nomorPerubahanPekerjaan');
        $nomorPerubahanAgama = $this->input->post('nomorPerubahanAgama');
        
        $tglPerubahanPendidikan = $this->input->post('tglPerubahanPendidikan');
        $tglPerubahanPendidikanPekerjaan = $this->input->post('tglPerubahanPendidikanPekerjaan');
        $tglPerubahanAgama = $this->input->post('tglPerubahanAgama');
       
                        $dataInput = array(
                              'nomorSurat' => $noSurat,
                              'NIK' => $noKK,
                              
                              'pendidikanTerakhir' => $pendidikanTerakhirNow.";".$selectPendidikanTerakhirBaru,
                              'dasarPerubahanPendidikanTerakhir' => $keteranganPerubahan.";".$nomorPerubahan.";".$tglPerubahanPendidikan,

                              'pekerjaan' => $pekerjaanTerakhirNow.";".$selectPekerjaanTerakhirBaru,
                              'dasarPerubahanPekerjaan' => $keteranganPerubahanPekerjaan.";".$nomorPerubahanPekerjaan.";".$tglPerubahanPendidikanPekerjaan,

                              'agama' => $agamaTerakhirNow.";".$selectAgamaTerakhirBaru,
                              'dasarPerubahanAgama' => $keteranganPerubahanAgama.";".$nomorPerubahanAgama.";".$tglPerubahanAgama,

                              'perubahanLainnyaKeterangan' => $poinLainnya,
                              'perubahanLainnya' => $lainnyaNow.";".$lainnyaBaru,
                              'perubahanLainnya' => $lainnyaNow.";".$lainnyaBaru,
                              'dasarPerubahanPerubahanLainnya' => $keteranganPerubahanLainnya.";".$nomorPerubahanLainnya.";".$tglPerubahanLainnya,

                              'status' => "aktif",
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f3_perubahan_data_kependudukan' , $dataInput,"id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function delete_f3_perubahan_data_kependudukan()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f3_perubahan_data_kependudukan' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function f7_kepindahan()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "WHERE kedudukanDalamKeluarga='KEPALA KELUARGA' ORDER BY namaLengkap ASC");
            $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
            $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
            $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f7_kepindahan";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f7_kepindahan/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }



    public function showPendudukData_f7()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaProvinsi="";
        $namaKabupaten="";
        $namaKecamatan="";
        $namaDesa="";

        $k1;
        $k2;
        $k3;
        $k4;

        $selectAllShop = $this->Home_model->getSelectData("*,SUBSTRING_INDEX(kode,'.',1) k1,SUBSTRING_INDEX(SUBSTRING_INDEX(kode,'.',2),'.',-1) k2, SUBSTRING_INDEX(SUBSTRING_INDEX(kode,'.',-2),'.',1) k3,SUBSTRING_INDEX(kode,'.',-1) k4","o_wilayah_indonesia", "WHERE kode='$keyword'");


        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
            $k1 = $row->k1;
            $k2 = $row->k2;
            $k3 = $row->k3;
            $k4 = $row->k4;
            

        }

        $selectProvinsi = $this->Home_model->getSelectData("*","o_wilayah_indonesia", "WHERE kode='$k1'");
        $selectKabupaten = $this->Home_model->getSelectData("*","o_wilayah_indonesia", "WHERE kode='$k1.$k2'");
        $selectKecamatan = $this->Home_model->getSelectData("*","o_wilayah_indonesia", "WHERE kode='$k1.$k2.$k3'");
        $selectDesa = $this->Home_model->getSelectData("*","o_wilayah_indonesia", "WHERE kode='$k1.$k2.$k3.$k4'");

        foreach ($selectProvinsi->result() as $row) {
            $namaProvinsi = $row->nama;
        }

        foreach ($selectKabupaten->result() as $row) {
            $namaKabupaten = $row->nama;
        }

        foreach ($selectKecamatan->result() as $row) {
            $namaKecamatan = $row->nama;
        }

        foreach ($selectDesa->result() as $row) {
            $namaDesa = $row->nama;
        }

        
            //Menampilkan Array dalam Format JSON
        $hasil['namaProvinsi'] = $namaProvinsi;
        $hasil['namaKabupaten'] = $namaKabupaten;
        $hasil['namaKecamatan'] = $namaKecamatan;
        $hasil['namaDesa'] = $namaDesa;
        
        echo json_encode($hasil);

    }

    //-------------------------Request Layanan --------------------------------------


    public function request_layanan()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";
            $NIKUSERLOGINED = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "WHERE kedudukanDalamKeluarga='KEPALA KELUARGA' ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
                $NIKUSERLOGINED = $row->NIK;
            }

            $data['dataToday'] = $this->Home_model->getSelectData("*","notification", "WHERE DATE(tglCreated)=CURDATE() AND idPenerima='$NIKUSERLOGINED' AND notification.statusNotif NOT IN ('hapus') GROUP BY randomCode");

            $data['dataSuratWaiting'] = $this->Home_model->getSelectData("*","notification", "WHERE  idPenerima='$NIKUSERLOGINED' AND notification.statusNotif IN ('selesai') GROUP BY randomCode");
            $data['dataSuratAll'] = $this->Home_model->getSelectData("*","notification", "WHERE idPenerima='$NIKUSERLOGINED' AND notification.statusNotif NOT IN ('hapus') GROUP BY randomCode");

            $data['dataMonth'] = $this->Home_model->getSelectData("*","notification", "WHERE MONTH(tglCreated)=MONTH(NOW()) AND idPenerima='$NIKUSERLOGINED' AND notification.statusNotif NOT IN ('hapus') GROUP BY randomCode");
            

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/request_layanan/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function add_f7_kepindahan()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $alamatLengkapDeskripsi = $this->input->post('alamatLengkapDeskripsi');
        $desaKelurahan = $this->input->post('desaKelurahan');
        $kecamatan = $this->input->post('kecamatan');
        $kabupatenKota = $this->input->post('kabupatenKota');
        $provinsi = $this->input->post('provinsi');
        $tglPindah = $this->input->post('tglPindah');
        $alasanPindah = $this->input->post('alasanPindah');
        $yangMengikuti = $this->input->post('yangMengikuti');
        $randomCode = $this->input->post('randomCode');

        $ngikutMember = "";

        for ($i=0; $i < count($yangMengikuti); $i++) { 
            $ngikutMember.= $yangMengikuti[$i].";";
        }
       
                        $dataInput = array(
                              'kode_formulir' => "f7",
                              'nomorSurat' => $noSurat,
                              
                              'NIK' => $noKK,

                              'alamatPindah' => $alamatLengkapDeskripsi.";".$desaKelurahan.";".$kecamatan.";".$kabupatenKota.";".$provinsi,
                              'tanggalPindah' => $tglPindah,
                              'alasanPindah' => $alasanPindah,
                              'yangMengikuti' => $ngikutMember,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f7_kepindahan' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f7_kepindahan_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $alamatLengkapDeskripsi = $this->input->post('alamatLengkapDeskripsi');
        $desaKelurahan = $this->input->post('desaKelurahan');
        $kecamatan = $this->input->post('kecamatan');
        $kabupatenKota = $this->input->post('kabupatenKota');
        $provinsi = $this->input->post('provinsi');
        $tglPindah = $this->input->post('tglPindah');
        $alasanPindah = $this->input->post('alasanPindah');
        $yangMengikuti = $this->input->post('yangMengikuti');
        $randomCode = $this->input->post('randomCode');

        $ngikutMember = "";

        for ($i=0; $i < count($yangMengikuti); $i++) { 
            $ngikutMember.= $yangMengikuti[$i].";";
        }
       
                        $dataInput = array(
                              'kode_formulir' => "f7",
                              'nomorSurat' => $noSurat,
                              
                              'NIK' => $noKK,

                              'alamatPindah' => $alamatLengkapDeskripsi.";".$desaKelurahan.";".$kecamatan.";".$kabupatenKota.";".$provinsi,
                              'tanggalPindah' => $tglPindah,
                              'alasanPindah' => $alasanPindah,
                              'yangMengikuti' => $ngikutMember,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f7_kepindahan' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f7_kepindahan",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan pindah",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }



    public function update_f7_kepindahan()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $alamatLengkapDeskripsi = $this->input->post('alamatLengkapDeskripsi');
        $desaKelurahan = $this->input->post('desaKelurahan');
        $kecamatan = $this->input->post('kecamatan');
        $kabupatenKota = $this->input->post('kabupatenKota');
        $provinsi = $this->input->post('provinsi');
        $tglPindah = $this->input->post('tglPindah');
        $alasanPindah = $this->input->post('alasanPindah');
        $yangMengikuti = $this->input->post('yangMengikuti');
        $randomCode = $this->input->post('randomCode');

        $ngikutMember = "";

        for ($i=0; $i < count($yangMengikuti); $i++) { 
            $ngikutMember.= $yangMengikuti[$i].";";
        }
       
                        $dataInput = array(
                              'nomorSurat' => $noSurat,
                              'NIK' => $noKK,
                              'alamatPindah' => $alamatLengkapDeskripsi.";".$desaKelurahan.";".$kecamatan.";".$kabupatenKota.";".$provinsi,
                              'tanggalPindah' => $tglPindah,
                              'alasanPindah' => $alasanPindah,
                              'yangMengikuti' => $ngikutMember,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f7_kepindahan' , $dataInput,"id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function update_no_surat_order_mobile()
    {
        
        $idKodeSurat = $this->input->post('idKodeSurat');
        $noSurat = $this->input->post('noSurat');
        $kodeForm = $this->input->post('kodeForm');
        
       
                        $dataInput = array(
                              'nomorSurat' => $noSurat,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData($kodeForm , $dataInput,"randomCode='$idKodeSurat'");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function delete_f7_kepindahan()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f7_kepindahan' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }

    public function showTableF7()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f7_kepindahan,penduduk", "WHERE f7_kepindahan.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%' || penduduk.nomorKK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f7_kepindahan,penduduk", "WHERE f7_kepindahan.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f7_kepindahan";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $alamatStr = explode(";", $row->alamatPindah);
            // $senTo = $alamatStr[0].", Desa ".$alamatStr[1].", Kec. ".$alamatStr[2].", Kab. ".$alamatStr[3].", Prov. ".$alamatStr[4];
            $senTo = $alamatStr[0];

            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->NIK,
                strtoupper($row->namaLengkap),
                strtolower($senTo),
                // strtoupper($row->tanggalPindah),
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f7_kepindahan(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f7_kepindahan('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\',\''.$row->alamatPindah.'\',\''.$row->tanggalPindah.'\',\''.$row->alasanPindah.'\',\''.$row->yangMengikuti.'\',\''.$row->namaLengkap.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f7_kepindahan('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }



    public function f8_suket_kelahiran()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "WHERE kedudukanDalamKeluarga='KEPALA KELUARGA' ORDER BY namaLengkap ASC");
            $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
            $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
            $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f8_suket_kelahiran";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f8_suket_kelahiran/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function showTableF8()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f8_suket_kelahiran,penduduk", "WHERE f8_suket_kelahiran.NIKAnak=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%' || penduduk.nomorKK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f8_suket_kelahiran,penduduk", "WHERE f8_suket_kelahiran.NIKAnak=penduduk.NIK");
        }


       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f8_suket_kelahiran";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $alamatStr = explode(";", $row->dataAyah);
            // $senTo = $alamatStr[0].", Desa ".$alamatStr[1].", Kec. ".$alamatStr[2].", Kab. ".$alamatStr[3].", Prov. ".$alamatStr[4];
            $senTo = $alamatStr[0];

            $dataPelapor = explode(";", $row->dataPelapor);

            $dataPelaporGet = $dataPelapor[5];
            $selectAllShopDataPelapor = $this->Home_model->getSelectData("*","penduduk", "WHERE  penduduk.NIK=$dataPelaporGet");

            $names = "";
            foreach ($selectAllShopDataPelapor->result() as $rowx) {
                $names = $rowx->namaLengkap;
            }

            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->NIK,
                strtoupper($row->namaLengkap),
                
                strtoupper($names),
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f8_suket_kelahiran(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f8_suket_kelahiran('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\',\''.$row->dataKelahiranAnak.'\',\''.$row->dataIbu.'\',\''.$row->dataAyah.'\',\''.$row->dataPelapor.'\',\''.$row->dataSaksi1.'\',\''.$row->dataSaksi2.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f8_suket_kelahiran('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

    public function add_f8_suket_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $randomCode = $this->input->post('randomCode');
        
        //datakelahirananak
        $namaLengkapAnak = $this->input->post('namaLengkapAnak');
        $jenisKelaminAnak = $this->input->post('jenisKelaminAnak');
        $tempatDilahirkanAnak = $this->input->post('tempatDilahirkanAnak');
        $tempatAlamatLahirAnak = $this->input->post('tempatAlamatLahirAnak');
        $tglLahirAnak = $this->input->post('tglLahirAnak');
        $jamLahirAnak = $this->input->post('jamLahirAnak');
        $waktuLahirAnak = $this->input->post('waktuLahirAnak');
        $anakKe = $this->input->post('anakKe');
        $jenisKelahiranAnak = $this->input->post('jenisKelahiranAnak');
        $penolongKelahiranAnak = $this->input->post('penolongKelahiranAnak');
        $beratBayiAnak = $this->input->post('beratBayiAnak');
        $panjangBayiAnak = $this->input->post('panjangBayiAnak');
        $nomor_kartu_keluarga_ayah = $this->input->post('nomor_kartu_keluarga_ayah');
        $nama_ayah_real = $this->input->post('nama_ayah_real');
        $randomCode = $this->input->post('randomCode');

        //dataibu
        $alamatDusunIbu = $this->input->post('alamatDusunIbu');
        $alamatDesaIbu = $this->input->post('alamatDesaIbu');
        $alamatKecamatanIbu = $this->input->post('alamatKecamatanIbu');
        $alamatKabupatenIbu = $this->input->post('alamatKabupatenIbu');
        $alamatProvinsiIbu = $this->input->post('alamatProvinsiIbu');
        $NIKIbu = $this->input->post('NIKIbu');
        $namaLengkapIbu = $this->input->post('namaLengkapIbu');
        $tglLahirIbu = $this->input->post('tglLahirIbu');
        $pekerjaanIbu = $this->input->post('pekerjaanIbu');
        $umurIbu = $this->input->post('umurIbu');
        $kewarganegaraanIbu = $this->input->post('kewarganegaraanIbu');
        $kebangsaanIbu = $this->input->post('kebangsaanIbu');
        $tglKawinIbu = $this->input->post('tglKawinIbu');

        //dataayah
        $alamatDusunAyah = $this->input->post('alamatDusunAyah');
        $alamatDesaAyah = $this->input->post('alamatDesaAyah');
        $alamatKecamatanAyah = $this->input->post('alamatKecamatanAyah');
        $alamatKabupatenAyah = $this->input->post('alamatKabupatenAyah');
        $alamatProvinsiAyah = $this->input->post('alamatProvinsiAyah');
        $NIKAyah = $this->input->post('NIKAyah');
        $namaLengkapAyah = $this->input->post('namaLengkapAyah');
        $tglLahirAyah = $this->input->post('tglLahirAyah');
        $pekerjaanAyah = $this->input->post('pekerjaanAyah');
        $umurAyah = $this->input->post('umurAyah');
        $kewarganegaraanAyah = $this->input->post('kewarganegaraanAyah');
        $kebangsaanAyah = $this->input->post('kebangsaanAyah');

        //datapelapor
        $alamatDusun_Pelapor = $this->input->post('alamatDusun_Pelapor');
        $alamatDesa_Pelapor = $this->input->post('alamatDesa_Pelapor');
        $alamatKecamatan_Pelapor = $this->input->post('alamatKecamatan_Pelapor');
        $alamatKabupaten_Pelapor = $this->input->post('alamatKabupaten_Pelapor');
        $alamatProvinsi_Pelapor = $this->input->post('alamatProvinsi_Pelapor');
        $NIK_Pelapor = $this->input->post('NIK_Pelapor');
        $namaLengkap_Pelapor = $this->input->post('namaLengkap_Pelapor');
        $tglLahir_Pelapor = $this->input->post('tglLahir_Pelapor');
        $pekerjaan_Pelapor = $this->input->post('pekerjaan_Pelapor');
        $umur_Pelapor = $this->input->post('umur_Pelapor');
        $kewarganegaraan_Pelapor = $this->input->post('kewarganegaraan_Pelapor');
        $kebangsaan_Pelapor = $this->input->post('kebangsaan_Pelapor');

        //datasaksi1
        $alamatDusun_Saksi1 = $this->input->post('alamatDusun_Saksi1');
        $alamatDesa_Saksi1 = $this->input->post('alamatDesa_Saksi1');
        $alamatKecamatan_Saksi1 = $this->input->post('alamatKecamatan_Saksi1');
        $alamatKabupaten_Saksi1 = $this->input->post('alamatKabupaten_Saksi1');
        $alamatProvinsi_Saksi1 = $this->input->post('alamatProvinsi_Saksi1');
        $NIK_Saksi1 = $this->input->post('NIK_Saksi1');
        $namaLengkap_Saksi1 = $this->input->post('namaLengkap_Saksi1');
        $tglLahir_Saksi1 = $this->input->post('tglLahir_Saksi1');
        $pekerjaan_Saksi1 = $this->input->post('pekerjaan_Saksi1');
        $umur_Saksi1 = $this->input->post('umur_Saksi1');
        $kewarganegaraan_Saksi1 = $this->input->post('kewarganegaraan_Saksi1');
        $kebangsaan_Saksi1 = $this->input->post('kebangsaan_Saksi1');

        //datasaksi1
        $alamatDusun_Saksi2 = $this->input->post('alamatDusun_Saksi2');
        $alamatDesa_Saksi2 = $this->input->post('alamatDesa_Saksi2');
        $alamatKecamatan_Saksi2 = $this->input->post('alamatKecamatan_Saksi2');
        $alamatKabupaten_Saksi2 = $this->input->post('alamatKabupaten_Saksi2');
        $alamatProvinsi_Saksi2 = $this->input->post('alamatProvinsi_Saksi2');
        $NIK_Saksi2 = $this->input->post('NIK_Saksi2');
        $namaLengkap_Saksi2 = $this->input->post('namaLengkap_Saksi2');
        $tglLahir_Saksi2 = $this->input->post('tglLahir_Saksi2');
        $pekerjaan_Saksi2 = $this->input->post('pekerjaan_Saksi2');
        $umur_Saksi2 = $this->input->post('umur_Saksi2');
        $kewarganegaraan_Saksi2 = $this->input->post('kewarganegaraan_Saksi2');
        $kebangsaan_Saksi2 = $this->input->post('kebangsaan_Saksi2');

                        $dataInput = array(
                              'kode_formulir' => "f8",
                              'nomorSurat' => $noSurat,
                              'NIKAnak' => $noKK,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              'dataKelahiranAnak' => $namaLengkapAnak.";".$jenisKelaminAnak.";".$tempatDilahirkanAnak.";".$tempatAlamatLahirAnak.";".$tglLahirAnak.";".$jamLahirAnak.";".$waktuLahirAnak.";".$anakKe.";".$jenisKelahiranAnak.";".$penolongKelahiranAnak.";".$beratBayiAnak.";".$panjangBayiAnak.";".$nomor_kartu_keluarga_ayah.";".$nama_ayah_real,
                              'dataIbu' => $alamatDusunIbu.";".$alamatDesaIbu.";".$alamatKecamatanIbu.";".$alamatKabupatenIbu.";".$alamatProvinsiIbu.";".$NIKIbu.";".$namaLengkapIbu.";".$tglLahirIbu.";".$pekerjaanIbu.";".$pekerjaanIbu.";".$umurIbu.";".$kewarganegaraanIbu.";".$kebangsaanIbu.";".$tglKawinIbu,
                              'dataAyah' => $alamatDusunAyah.";".$alamatDesaAyah.";".$alamatKecamatanAyah.";".$alamatKabupatenAyah.";".$alamatProvinsiAyah.";".$NIKAyah.";".$namaLengkapAyah.";".$tglLahirAyah.";".$pekerjaanAyah.";".$pekerjaanAyah.";".$umurAyah.";".$kewarganegaraanAyah.";".$kebangsaanAyah,
                              'dataAyah' => $alamatDusunAyah.";".$alamatDesaAyah.";".$alamatKecamatanAyah.";".$alamatKabupatenAyah.";".$alamatProvinsiAyah.";".$NIKAyah.";".$namaLengkapAyah.";".$tglLahirAyah.";".$pekerjaanAyah.";".$pekerjaanAyah.";".$umurAyah.";".$kewarganegaraanAyah.";".$kebangsaanAyah,
                              'dataPelapor' => $alamatDusun_Pelapor.";".$alamatDesa_Pelapor.";".$alamatKecamatan_Pelapor.";".$alamatKabupaten_Pelapor.";".$alamatProvinsi_Pelapor.";".$NIK_Pelapor.";".$namaLengkap_Pelapor.";".$tglLahir_Pelapor.";".$pekerjaan_Pelapor.";".$pekerjaan_Pelapor.";".$umur_Pelapor.";".$kewarganegaraan_Pelapor.";".$kebangsaan_Pelapor,
                              'dataSaksi1' => $alamatDusun_Saksi1.";".$alamatDesa_Saksi1.";".$alamatKecamatan_Saksi1.";".$alamatKabupaten_Saksi1.";".$alamatProvinsi_Saksi1.";".$NIK_Saksi1.";".$namaLengkap_Saksi1.";".$tglLahir_Saksi1.";".$pekerjaan_Saksi1.";".$pekerjaan_Saksi1.";".$umur_Saksi1.";".$kewarganegaraan_Saksi1.";".$kebangsaan_Saksi1,
                              'dataSaksi2' => $alamatDusun_Saksi2.";".$alamatDesa_Saksi2.";".$alamatKecamatan_Saksi2.";".$alamatKabupaten_Saksi2.";".$alamatProvinsi_Saksi2.";".$NIK_Saksi2.";".$namaLengkap_Saksi2.";".$tglLahir_Saksi2.";".$pekerjaan_Saksi2.";".$pekerjaan_Saksi2.";".$umur_Saksi2.";".$kewarganegaraan_Saksi2.";".$kebangsaan_Saksi2,

                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f8_suket_kelahiran' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f8_suket_kelahiran",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan kelahiran",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }



    public function add_f8_suket()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $randomCode = $this->input->post('randomCode');
        
        //datakelahirananak
        $namaLengkapAnak = $this->input->post('namaLengkapAnak');
        $jenisKelaminAnak = $this->input->post('jenisKelaminAnak');
        $tempatDilahirkanAnak = $this->input->post('tempatDilahirkanAnak');
        $tempatAlamatLahirAnak = $this->input->post('tempatAlamatLahirAnak');
        $tglLahirAnak = $this->input->post('tglLahirAnak');
        $jamLahirAnak = $this->input->post('jamLahirAnak');
        $waktuLahirAnak = $this->input->post('waktuLahirAnak');
        $anakKe = $this->input->post('anakKe');
        $jenisKelahiranAnak = $this->input->post('jenisKelahiranAnak');
        $penolongKelahiranAnak = $this->input->post('penolongKelahiranAnak');
        $beratBayiAnak = $this->input->post('beratBayiAnak');
        $panjangBayiAnak = $this->input->post('panjangBayiAnak');
        $nomor_kartu_keluarga_ayah = $this->input->post('nomor_kartu_keluarga_ayah');
        $nama_ayah_real = $this->input->post('nama_ayah_real');
        $randomCode = $this->input->post('randomCode');

        //dataibu
        $alamatDusunIbu = $this->input->post('alamatDusunIbu');
        $alamatDesaIbu = $this->input->post('alamatDesaIbu');
        $alamatKecamatanIbu = $this->input->post('alamatKecamatanIbu');
        $alamatKabupatenIbu = $this->input->post('alamatKabupatenIbu');
        $alamatProvinsiIbu = $this->input->post('alamatProvinsiIbu');
        $NIKIbu = $this->input->post('NIKIbu');
        $namaLengkapIbu = $this->input->post('namaLengkapIbu');
        $tglLahirIbu = $this->input->post('tglLahirIbu');
        $pekerjaanIbu = $this->input->post('pekerjaanIbu');
        $umurIbu = $this->input->post('umurIbu');
        $kewarganegaraanIbu = $this->input->post('kewarganegaraanIbu');
        $kebangsaanIbu = $this->input->post('kebangsaanIbu');
        $tglKawinIbu = $this->input->post('tglKawinIbu');

        //dataayah
        $alamatDusunAyah = $this->input->post('alamatDusunAyah');
        $alamatDesaAyah = $this->input->post('alamatDesaAyah');
        $alamatKecamatanAyah = $this->input->post('alamatKecamatanAyah');
        $alamatKabupatenAyah = $this->input->post('alamatKabupatenAyah');
        $alamatProvinsiAyah = $this->input->post('alamatProvinsiAyah');
        $NIKAyah = $this->input->post('NIKAyah');
        $namaLengkapAyah = $this->input->post('namaLengkapAyah');
        $tglLahirAyah = $this->input->post('tglLahirAyah');
        $pekerjaanAyah = $this->input->post('pekerjaanAyah');
        $umurAyah = $this->input->post('umurAyah');
        $kewarganegaraanAyah = $this->input->post('kewarganegaraanAyah');
        $kebangsaanAyah = $this->input->post('kebangsaanAyah');

        //datapelapor
        $alamatDusun_Pelapor = $this->input->post('alamatDusun_Pelapor');
        $alamatDesa_Pelapor = $this->input->post('alamatDesa_Pelapor');
        $alamatKecamatan_Pelapor = $this->input->post('alamatKecamatan_Pelapor');
        $alamatKabupaten_Pelapor = $this->input->post('alamatKabupaten_Pelapor');
        $alamatProvinsi_Pelapor = $this->input->post('alamatProvinsi_Pelapor');
        $NIK_Pelapor = $this->input->post('NIK_Pelapor');
        $namaLengkap_Pelapor = $this->input->post('namaLengkap_Pelapor');
        $tglLahir_Pelapor = $this->input->post('tglLahir_Pelapor');
        $pekerjaan_Pelapor = $this->input->post('pekerjaan_Pelapor');
        $umur_Pelapor = $this->input->post('umur_Pelapor');
        $kewarganegaraan_Pelapor = $this->input->post('kewarganegaraan_Pelapor');
        $kebangsaan_Pelapor = $this->input->post('kebangsaan_Pelapor');

        //datasaksi1
        $alamatDusun_Saksi1 = $this->input->post('alamatDusun_Saksi1');
        $alamatDesa_Saksi1 = $this->input->post('alamatDesa_Saksi1');
        $alamatKecamatan_Saksi1 = $this->input->post('alamatKecamatan_Saksi1');
        $alamatKabupaten_Saksi1 = $this->input->post('alamatKabupaten_Saksi1');
        $alamatProvinsi_Saksi1 = $this->input->post('alamatProvinsi_Saksi1');
        $NIK_Saksi1 = $this->input->post('NIK_Saksi1');
        $namaLengkap_Saksi1 = $this->input->post('namaLengkap_Saksi1');
        $tglLahir_Saksi1 = $this->input->post('tglLahir_Saksi1');
        $pekerjaan_Saksi1 = $this->input->post('pekerjaan_Saksi1');
        $umur_Saksi1 = $this->input->post('umur_Saksi1');
        $kewarganegaraan_Saksi1 = $this->input->post('kewarganegaraan_Saksi1');
        $kebangsaan_Saksi1 = $this->input->post('kebangsaan_Saksi1');

        //datasaksi1
        $alamatDusun_Saksi2 = $this->input->post('alamatDusun_Saksi2');
        $alamatDesa_Saksi2 = $this->input->post('alamatDesa_Saksi2');
        $alamatKecamatan_Saksi2 = $this->input->post('alamatKecamatan_Saksi2');
        $alamatKabupaten_Saksi2 = $this->input->post('alamatKabupaten_Saksi2');
        $alamatProvinsi_Saksi2 = $this->input->post('alamatProvinsi_Saksi2');
        $NIK_Saksi2 = $this->input->post('NIK_Saksi2');
        $namaLengkap_Saksi2 = $this->input->post('namaLengkap_Saksi2');
        $tglLahir_Saksi2 = $this->input->post('tglLahir_Saksi2');
        $pekerjaan_Saksi2 = $this->input->post('pekerjaan_Saksi2');
        $umur_Saksi2 = $this->input->post('umur_Saksi2');
        $kewarganegaraan_Saksi2 = $this->input->post('kewarganegaraan_Saksi2');
        $kebangsaan_Saksi2 = $this->input->post('kebangsaan_Saksi2');
        

        
                        $dataInput = array(
                              'kode_formulir' => "f8",
                              'nomorSurat' => $noSurat,
                              'NIKAnak' => $noKK,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                              'dataKelahiranAnak' => $namaLengkapAnak.";".$jenisKelaminAnak.";".$tempatDilahirkanAnak.";".$tempatAlamatLahirAnak.";".$tglLahirAnak.";".$jamLahirAnak.";".$waktuLahirAnak.";".$anakKe.";".$jenisKelahiranAnak.";".$penolongKelahiranAnak.";".$beratBayiAnak.";".$panjangBayiAnak.";".$nomor_kartu_keluarga_ayah.";".$nama_ayah_real,
                              'dataIbu' => $alamatDusunIbu.";".$alamatDesaIbu.";".$alamatKecamatanIbu.";".$alamatKabupatenIbu.";".$alamatProvinsiIbu.";".$NIKIbu.";".$namaLengkapIbu.";".$tglLahirIbu.";".$pekerjaanIbu.";".$pekerjaanIbu.";".$umurIbu.";".$kewarganegaraanIbu.";".$kebangsaanIbu.";".$tglKawinIbu,
                              'dataAyah' => $alamatDusunAyah.";".$alamatDesaAyah.";".$alamatKecamatanAyah.";".$alamatKabupatenAyah.";".$alamatProvinsiAyah.";".$NIKAyah.";".$namaLengkapAyah.";".$tglLahirAyah.";".$pekerjaanAyah.";".$pekerjaanAyah.";".$umurAyah.";".$kewarganegaraanAyah.";".$kebangsaanAyah,
                              'dataAyah' => $alamatDusunAyah.";".$alamatDesaAyah.";".$alamatKecamatanAyah.";".$alamatKabupatenAyah.";".$alamatProvinsiAyah.";".$NIKAyah.";".$namaLengkapAyah.";".$tglLahirAyah.";".$pekerjaanAyah.";".$pekerjaanAyah.";".$umurAyah.";".$kewarganegaraanAyah.";".$kebangsaanAyah,
                              'dataPelapor' => $alamatDusun_Pelapor.";".$alamatDesa_Pelapor.";".$alamatKecamatan_Pelapor.";".$alamatKabupaten_Pelapor.";".$alamatProvinsi_Pelapor.";".$NIK_Pelapor.";".$namaLengkap_Pelapor.";".$tglLahir_Pelapor.";".$pekerjaan_Pelapor.";".$pekerjaan_Pelapor.";".$umur_Pelapor.";".$kewarganegaraan_Pelapor.";".$kebangsaan_Pelapor,
                              'dataSaksi1' => $alamatDusun_Saksi1.";".$alamatDesa_Saksi1.";".$alamatKecamatan_Saksi1.";".$alamatKabupaten_Saksi1.";".$alamatProvinsi_Saksi1.";".$NIK_Saksi1.";".$namaLengkap_Saksi1.";".$tglLahir_Saksi1.";".$pekerjaan_Saksi1.";".$pekerjaan_Saksi1.";".$umur_Saksi1.";".$kewarganegaraan_Saksi1.";".$kebangsaan_Saksi1,
                              'dataSaksi2' => $alamatDusun_Saksi2.";".$alamatDesa_Saksi2.";".$alamatKecamatan_Saksi2.";".$alamatKabupaten_Saksi2.";".$alamatProvinsi_Saksi2.";".$NIK_Saksi2.";".$namaLengkap_Saksi2.";".$tglLahir_Saksi2.";".$pekerjaan_Saksi2.";".$pekerjaan_Saksi2.";".$umur_Saksi2.";".$kewarganegaraan_Saksi2.";".$kebangsaan_Saksi2,

                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f8_suket_kelahiran' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function update_f8_suket_kelahiran()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $randomCode = $this->input->post('randomCode');
        
        //datakelahirananak
        $namaLengkapAnak = $this->input->post('namaLengkapAnak');
        $jenisKelaminAnak = $this->input->post('jenisKelaminAnak');
        $tempatDilahirkanAnak = $this->input->post('tempatDilahirkanAnak');
        $tempatAlamatLahirAnak = $this->input->post('tempatAlamatLahirAnak');
        $tglLahirAnak = $this->input->post('tglLahirAnak');
        $jamLahirAnak = $this->input->post('jamLahirAnak');
        $waktuLahirAnak = $this->input->post('waktuLahirAnak');
        $anakKe = $this->input->post('anakKe');
        $jenisKelahiranAnak = $this->input->post('jenisKelahiranAnak');
        $penolongKelahiranAnak = $this->input->post('penolongKelahiranAnak');
        $beratBayiAnak = $this->input->post('beratBayiAnak');
        $panjangBayiAnak = $this->input->post('panjangBayiAnak');
        $nomor_kartu_keluarga_ayah = $this->input->post('nomor_kartu_keluarga_ayah');
        $nama_ayah_real = $this->input->post('nama_ayah_real');
        $randomCode = $this->input->post('randomCode');

        //dataibu
        $alamatDusunIbu = $this->input->post('alamatDusunIbu');
        $alamatDesaIbu = $this->input->post('alamatDesaIbu');
        $alamatKecamatanIbu = $this->input->post('alamatKecamatanIbu');
        $alamatKabupatenIbu = $this->input->post('alamatKabupatenIbu');
        $alamatProvinsiIbu = $this->input->post('alamatProvinsiIbu');
        $NIKIbu = $this->input->post('NIKIbu');
        $namaLengkapIbu = $this->input->post('namaLengkapIbu');
        $tglLahirIbu = $this->input->post('tglLahirIbu');
        $pekerjaanIbu = $this->input->post('pekerjaanIbu');
        $umurIbu = $this->input->post('umurIbu');
        $kewarganegaraanIbu = $this->input->post('kewarganegaraanIbu');
        $kebangsaanIbu = $this->input->post('kebangsaanIbu');
        $tglKawinIbu = $this->input->post('tglKawinIbu');

        //dataayah
        $alamatDusunAyah = $this->input->post('alamatDusunAyah');
        $alamatDesaAyah = $this->input->post('alamatDesaAyah');
        $alamatKecamatanAyah = $this->input->post('alamatKecamatanAyah');
        $alamatKabupatenAyah = $this->input->post('alamatKabupatenAyah');
        $alamatProvinsiAyah = $this->input->post('alamatProvinsiAyah');
        $NIKAyah = $this->input->post('NIKAyah');
        $namaLengkapAyah = $this->input->post('namaLengkapAyah');
        $tglLahirAyah = $this->input->post('tglLahirAyah');
        $pekerjaanAyah = $this->input->post('pekerjaanAyah');
        $umurAyah = $this->input->post('umurAyah');
        $kewarganegaraanAyah = $this->input->post('kewarganegaraanAyah');
        $kebangsaanAyah = $this->input->post('kebangsaanAyah');

        //datapelapor
        $alamatDusun_Pelapor = $this->input->post('alamatDusun_Pelapor');
        $alamatDesa_Pelapor = $this->input->post('alamatDesa_Pelapor');
        $alamatKecamatan_Pelapor = $this->input->post('alamatKecamatan_Pelapor');
        $alamatKabupaten_Pelapor = $this->input->post('alamatKabupaten_Pelapor');
        $alamatProvinsi_Pelapor = $this->input->post('alamatProvinsi_Pelapor');
        $NIK_Pelapor = $this->input->post('NIK_Pelapor');
        $namaLengkap_Pelapor = $this->input->post('namaLengkap_Pelapor');
        $tglLahir_Pelapor = $this->input->post('tglLahir_Pelapor');
        $pekerjaan_Pelapor = $this->input->post('pekerjaan_Pelapor');
        $umur_Pelapor = $this->input->post('umur_Pelapor');
        $kewarganegaraan_Pelapor = $this->input->post('kewarganegaraan_Pelapor');
        $kebangsaan_Pelapor = $this->input->post('kebangsaan_Pelapor');

        //datasaksi1
        $alamatDusun_Saksi1 = $this->input->post('alamatDusun_Saksi1');
        $alamatDesa_Saksi1 = $this->input->post('alamatDesa_Saksi1');
        $alamatKecamatan_Saksi1 = $this->input->post('alamatKecamatan_Saksi1');
        $alamatKabupaten_Saksi1 = $this->input->post('alamatKabupaten_Saksi1');
        $alamatProvinsi_Saksi1 = $this->input->post('alamatProvinsi_Saksi1');
        $NIK_Saksi1 = $this->input->post('NIK_Saksi1');
        $namaLengkap_Saksi1 = $this->input->post('namaLengkap_Saksi1');
        $tglLahir_Saksi1 = $this->input->post('tglLahir_Saksi1');
        $pekerjaan_Saksi1 = $this->input->post('pekerjaan_Saksi1');
        $umur_Saksi1 = $this->input->post('umur_Saksi1');
        $kewarganegaraan_Saksi1 = $this->input->post('kewarganegaraan_Saksi1');
        $kebangsaan_Saksi1 = $this->input->post('kebangsaan_Saksi1');

        //datasaksi1
        $alamatDusun_Saksi2 = $this->input->post('alamatDusun_Saksi2');
        $alamatDesa_Saksi2 = $this->input->post('alamatDesa_Saksi2');
        $alamatKecamatan_Saksi2 = $this->input->post('alamatKecamatan_Saksi2');
        $alamatKabupaten_Saksi2 = $this->input->post('alamatKabupaten_Saksi2');
        $alamatProvinsi_Saksi2 = $this->input->post('alamatProvinsi_Saksi2');
        $NIK_Saksi2 = $this->input->post('NIK_Saksi2');
        $namaLengkap_Saksi2 = $this->input->post('namaLengkap_Saksi2');
        $tglLahir_Saksi2 = $this->input->post('tglLahir_Saksi2');
        $pekerjaan_Saksi2 = $this->input->post('pekerjaan_Saksi2');
        $umur_Saksi2 = $this->input->post('umur_Saksi2');
        $kewarganegaraan_Saksi2 = $this->input->post('kewarganegaraan_Saksi2');
        $kebangsaan_Saksi2 = $this->input->post('kebangsaan_Saksi2');
        

        
                        $dataInput = array(
                              'kode_formulir' => "f8",
                              'nomorSurat' => $noSurat,
                              'NIKAnak' => $noKK,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                              'dataKelahiranAnak' => $namaLengkapAnak.";".$jenisKelaminAnak.";".$tempatDilahirkanAnak.";".$tempatAlamatLahirAnak.";".$tglLahirAnak.";".$jamLahirAnak.";".$waktuLahirAnak.";".$anakKe.";".$jenisKelahiranAnak.";".$penolongKelahiranAnak.";".$beratBayiAnak.";".$panjangBayiAnak.";".$nomor_kartu_keluarga_ayah.";".$nama_ayah_real,
                              'dataIbu' => $alamatDusunIbu.";".$alamatDesaIbu.";".$alamatKecamatanIbu.";".$alamatKabupatenIbu.";".$alamatProvinsiIbu.";".$NIKIbu.";".$namaLengkapIbu.";".$tglLahirIbu.";".$pekerjaanIbu.";".$pekerjaanIbu.";".$umurIbu.";".$kewarganegaraanIbu.";".$kebangsaanIbu.";".$tglKawinIbu,
                              'dataAyah' => $alamatDusunAyah.";".$alamatDesaAyah.";".$alamatKecamatanAyah.";".$alamatKabupatenAyah.";".$alamatProvinsiAyah.";".$NIKAyah.";".$namaLengkapAyah.";".$tglLahirAyah.";".$pekerjaanAyah.";".$pekerjaanAyah.";".$umurAyah.";".$kewarganegaraanAyah.";".$kebangsaanAyah,
                              'dataAyah' => $alamatDusunAyah.";".$alamatDesaAyah.";".$alamatKecamatanAyah.";".$alamatKabupatenAyah.";".$alamatProvinsiAyah.";".$NIKAyah.";".$namaLengkapAyah.";".$tglLahirAyah.";".$pekerjaanAyah.";".$pekerjaanAyah.";".$umurAyah.";".$kewarganegaraanAyah.";".$kebangsaanAyah,
                              'dataPelapor' => $alamatDusun_Pelapor.";".$alamatDesa_Pelapor.";".$alamatKecamatan_Pelapor.";".$alamatKabupaten_Pelapor.";".$alamatProvinsi_Pelapor.";".$NIK_Pelapor.";".$namaLengkap_Pelapor.";".$tglLahir_Pelapor.";".$pekerjaan_Pelapor.";".$pekerjaan_Pelapor.";".$umur_Pelapor.";".$kewarganegaraan_Pelapor.";".$kebangsaan_Pelapor,
                              'dataSaksi1' => $alamatDusun_Saksi1.";".$alamatDesa_Saksi1.";".$alamatKecamatan_Saksi1.";".$alamatKabupaten_Saksi1.";".$alamatProvinsi_Saksi1.";".$NIK_Saksi1.";".$namaLengkap_Saksi1.";".$tglLahir_Saksi1.";".$pekerjaan_Saksi1.";".$pekerjaan_Saksi1.";".$umur_Saksi1.";".$kewarganegaraan_Saksi1.";".$kebangsaan_Saksi1,
                              'dataSaksi2' => $alamatDusun_Saksi2.";".$alamatDesa_Saksi2.";".$alamatKecamatan_Saksi2.";".$alamatKabupaten_Saksi2.";".$alamatProvinsi_Saksi2.";".$NIK_Saksi2.";".$namaLengkap_Saksi2.";".$tglLahir_Saksi2.";".$pekerjaan_Saksi2.";".$pekerjaan_Saksi2.";".$umur_Saksi2.";".$kewarganegaraan_Saksi2.";".$kebangsaan_Saksi2,

                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f8_suket_kelahiran' , $dataInput,"id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function delete_f8_suket_kelahiran()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f8_suket_kelahiran' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }

    public function pengaturan_profil()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");


            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/pengaturan/akun/index' , $data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }



    //PENGATURAN
   
    public function update_pengaturan_profil()
    {

        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $username = $this->input->post('username');
            $namaLengkap = $this->input->post('namaLengkap');
            $jabatan = $this->input->post('jabatan');
            $email = $this->input->post('email');
            $noHP = $this->input->post('noHP');
            $foto = $this->input->post('filesss');
            $pass = $this->input->post('pass');
            $passOldSSS = $this->input->post('passOld');

            $passConvert = md5($pass);

            $passOld = "";
            $namaImageLama = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $passOld = $row->password;
                $namaImageLama = $row->pictureProfile;
            }


            
            if(md5($passOldSSS)==$passOld){

                            $imagename = "";

                                $initialize = $this->upload->initialize(array(
                                    "upload_path" => 'assets/jpg/',
                                    "allowed_types" => "*",
                                    "remove_spaces" => TRUE,
                                    "overwrite" => TRUE
                                ));

                                if (!$this->upload->do_upload('filesss')) {
                                    $error = array('error' => $this->upload->display_errors());
                                    // echo $this->upload->display_errors();
                                } else {
                                    $data = $this->upload->data();
                                    $imagename = $data['file_name'];
                                    
                                } 

                                if($imagename!=""){
                                    $dataInput = array(
                                          'username' => $username,
                                          'namaLengkap' => $namaLengkap,
                                          'jabatan' => $jabatan,
                                          'email' => $email,
                                          'noTelp' => $noHP,
                                          'password' => md5($pass),
                                          'pictureProfile' => 'assets/jpg/'.$imagename,
                                    );
                                    $simpan = $this->Home_model->updateData('user' , $dataInput," idUser=$idUser");
                                }else {
                                    $dataInput = array(
                                          'username' => $username,
                                          'namaLengkap' => $namaLengkap,
                                          'jabatan' => $jabatan,
                                          'email' => $email,
                                          'noTelp' => $noHP,
                                          'password' => md5($pass),
                                          
                                    );
                                    $simpan = $this->Home_model->updateData('user' , $dataInput," idUser=$idUser");
                                }

                                if ($imagename=="") {
                                    $hasil['urlimage'] = $namaImageLama;
                                }else {
                                    $hasil['urlimage'] = 'assets/jpg/'.$imagename;
                                }

                                
                                
                                

                                //Menampilkan Array dalam Format JSON
                                if ($simpan) {
                                    $hasil['resultnya'] = "true";
                                    echo json_encode($hasil);
                                }else {
                                    $hasil['resultnya'] = "false";
                                    echo json_encode($hasil);
                                }

                            

            }else {
                $hasil['resultnya'] = "wrong_pass";
                echo json_encode($hasil);
            }
           
                            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }
        
        
                            

    }

    public function update_ttd_user_desa()
    {

        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $idUserGets = $this->input->post('idUser');
            $showResult = $this->input->post('filesss');

             $image_file="";

             $image_array_1 = explode(";", $showResult);

             $image_array_2 = explode(",", $image_array_1[1]);

             $data = base64_decode($image_array_2[1]);

             $imageName = time() . '.png';

             file_put_contents('assets/jpg/ttd/'.$imageName, $data);


             // $image_file = addslashes(file_get_contents($imageName));
            

                                // $initialize = $this->upload->initialize(array(
                                //     "upload_path" => 'assets/jpg/ttd/',
                                //     "allowed_types" => "*",
                                //     "remove_spaces" => TRUE,
                                //     "overwrite" => TRUE
                                // ));

                                // if (!$this->upload->do_upload('filesss')) {
                                //     $error = array('error' => $this->upload->display_errors());
                                //     // echo $this->upload->display_errors();
                                // } else {
                                //     $data = $this->upload->data();
                                //     $imagename = $data['file_name'];
                                    
                                // } 

                                if($imageName!=""){
                                    $dataInput = array(
                                          'pictureSignature' => 'assets/jpg/ttd/'.$imageName,
                                    );
                                    $simpan = $this->Home_model->updateData('user' , $dataInput," idUser=$idUserGets");
                                }else {
                                   $dataInput = array(
                                          'status' => "aktif",
                                    );
                                    $simpan = $this->Home_model->updateData('user' , $dataInput," idUser=$idUserGets");
                                }

                                
                                
                                
                                

                                //Menampilkan Array dalam Format JSON
                                if ($simpan) {
                                    $hasil['resultnya'] = "true";
                                    // $hasil['asadd'] = $showResult;
                                    echo json_encode($hasil);
                                }else {
                                    $hasil['resultnya'] = "false";
                                    echo json_encode($hasil);
                                }

                            

            
                            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }
        
        
                            

    }

    public function pengaturan_info_desa()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            $data['kodeDesa'] = $namaadmin['kodeDesa'];
            
            $idUser = $namaadmin['idUser'];
            $kodeDesa = $namaadmin['kodeDesa'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['selectDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE kodeDesa='$kodeDesa'");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");


            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/pengaturan/pengaturan_umum_desa/index' , $data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function update_pengaturan_info_desa()
    {
        
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];
            $kodeDesa = $namaadmin['kodeDesa'];

            $ibukota = $this->input->post('ibukota');
            $namaDesa = $this->input->post('namaDesa');
            $ibuKotaKecamatan = $this->input->post('ibuKotaKecamatan');
            $namaKecamatan = $this->input->post('namaKecamatan');
            $namaKabupaten = $this->input->post('namaKabupaten');
            $namaProvinsi = $this->input->post('namaProvinsi');
            $sebutanNamaDesa = $this->input->post('sebutanNamaDesa');
            $sebutanNamaDusun = $this->input->post('sebutanNamaDusun');
            $sebutanPemimpinDesa = $this->input->post('sebutanPemimpinDesa');
            $kodePos = $this->input->post('kodePos');
            $noTelpDesa = $this->input->post('noTelpDesa');
            $visi = $this->input->post('visi');
            $misi = $this->input->post('misi');
                    


                    $imagename = "";

                        $initialize = $this->upload->initialize(array(
                            "upload_path" => 'assets/jpg/logo_desa',
                            "allowed_types" => "*",
                            "remove_spaces" => TRUE,
                            "overwrite" => TRUE
                        ));

                        if (!$this->upload->do_upload('filesss')) {
                            $error = array('error' => $this->upload->display_errors());
                            // echo $this->upload->display_errors();
                        } else {
                            $data = $this->upload->data();
                            $imagename = $data['file_name'];
                            
                        } 

                        if($imagename!=""){
                            $dataInput = array(
                                  
                                  'ibuKotaDesa' => $ibukota,
                                  'namaDesa' => $namaDesa,
                                  'ibuKotaKecamatan' => $ibuKotaKecamatan,
                                  'namaKecamatan' => $namaKecamatan,
                                  'namaKabupaten' => $namaKabupaten,
                                  'namaProvinsi' => $namaProvinsi,
                                  'sebutanNamaDesa' => $sebutanNamaDesa,
                                  'sebutanNamaDusun' => $sebutanNamaDusun,
                                  'sebutanPemimpinDesa' => $sebutanPemimpinDesa,
                                  'kodePos' => $kodePos,
                                  'nomorTeleponDesa' => $noTelpDesa,
                                  'visi' => $visi,
                                  'misi' => $misi,
                                  'logo' => 'assets/jpg/logo_desa/'.$imagename,
                            );

                            $simpan = $this->Home_model->updateData('o_data_desa' , $dataInput," kodeDesa='$kodeDesa'");
                        
                        }else {
                            $dataInput = array(
                                  'ibuKotaDesa' => $ibukota,
                                  'namaDesa' => $namaDesa,
                                  'ibuKotaKecamatan' => $ibuKotaKecamatan,
                                  'namaKecamatan' => $namaKecamatan,
                                  'namaKabupaten' => $namaKabupaten,
                                  'namaProvinsi' => $namaProvinsi,
                                  'sebutanNamaDesa' => $sebutanNamaDesa,
                                  'sebutanNamaDusun' => $sebutanNamaDusun,
                                  'sebutanPemimpinDesa' => $sebutanPemimpinDesa,
                                  'kodePos' => $kodePos,
                                  'nomorTeleponDesa' => $noTelpDesa,
                                  'visi' => $visi,
                                  'misi' => $misi,
                                  
                            );

                            $simpan = $this->Home_model->updateData('o_data_desa' , $dataInput," kodeDesa='$kodeDesa'");
                        
                        }


            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }
        
    }


    public function pengaturan_headline_web()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            $data['kodeDesa'] = $namaadmin['kodeDesa'];
            
            $idUser = $namaadmin['idUser'];
            $kodeDesa = $namaadmin['kodeDesa'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['selectPengaturanWeb'] = $this->Home_model->getSelectData("*","o_pengaturan_web", "LIMIT 1");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");


            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/pengaturan/pengaturan_headline_web/index' , $data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function update_headline_web()
    {
        
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];
            $kodeDesa = $namaadmin['kodeDesa'];

            $id = $this->input->post('id');
            $taglineSatu = $this->input->post('taglineSatu');
            $taglineDua = $this->input->post('taglineDua');

                            
                            $dataInput = array(
                                  'tagline1' => $taglineSatu,
                                  'tagline2' => $taglineDua,
                                  
                            );

                            $simpan = $this->Home_model->updateData('o_pengaturan_web' , $dataInput," id='$id'");
                        


            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }
        
    }

    public function showDataDesa()
    {
        
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];
            $kodeDesa = $namaadmin['kodeDesa'];

            $selectDataDesa = $this->Home_model->getSelectData("*",'o_data_dusun' , "WHERE kodeDesa='$kodeDesa' ORDER BY namaDusun ASC");

            $resulData = "";
            $no = 1;

            if (!$selectDataDesa->result()) {
                $resulData = 'Belum ada data desa';
            }

            foreach ($selectDataDesa->result() as $row) {
                $resulData.='
                    <div class="row" style="padding: 10px;margin-bottom: 0px;">
                    <div class="col-sm-2">'.$no++.'</div>
                    <div class="col-sm-8">'.$row->namaDusun.'</div>
                    <div class="col-sm-2"><button type="button" id="btnRemoveDusun" onclick="delete_data_dusun(\''.$row->idDusun.'\')" class="btn btn-sm btn-danger waves-effect waves-light " style="border-radius: 0px; border-top-left-radius: 10px;border-bottom-left-radius: 10px;padding: 2px; padding-right: 10px; text-align: center;padding-left: 0px; display: block; padding-left: 5px; margin-right: -10px;"><i class="ti-minus text-c-white p-r-10"></i></button></div>
                  </div>
                ';
            }
        
     
            //Menampilkan Array dalam Format JSON
                        $hasil['resultnya'] = $resulData;
                            echo json_encode($hasil);

        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }
                            
    }

    public function add_new_dusun()
    {
        
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];
            $kodeDesa = $namaadmin['kodeDesa'];

            $namaDUsunBaru = $this->input->post('namaDUsunBaru');

            if ($namaDUsunBaru!="") {
                 $dataInput = array(
                              'kodeDesa' => $kodeDesa,
                              'namaDusun' => $namaDUsunBaru,
                              'statusDusun' => "aktif",
                              
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('o_data_dusun' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
            }else {
                $hasil['resultnya'] = "wrong_pass";
                            echo json_encode($hasil);
            }
            
                       
                            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }
        
    }

    public function delete_data_dusun()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('o_data_dusun' , "idDusun='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function manajemen_akun()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "WHERE kedudukanDalamKeluarga='KEPALA KELUARGA' ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/pengaturan/pengaturan_akses_user/index' , $data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function showDaftarUser()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","user", "WHERE (namaLengkap LIKE '%$keyword%' || username LIKE '%$keyword%' || jabatan LIKE '%$keyword%') AND statusLevelUser='10' AND status='aktif'");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","user", "WHERE statusLevelUser='10' AND status='aktif'");
        }
       
        

        $number=0;

          

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
           $levelUserText = $row->statusLevelUser;

           if($levelUserText=='10'){
            $levelUserText = "Admin";
           }else if($levelUserText=='5'){
            $levelUserText = "Staf level 1";
           }else if($levelUserText=='1'){
            $levelUserText = "Staf level 2";
           }
            

            array_push($result,array(
                $number+=1,
                $levelUserText,
                $row->namaLengkap.'<label class="label label-success m-l-10">'.$row->status.'</label>',
                ucfirst(strtolower($row->username)),
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px;display:block; margin:auto; text-align:center">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="reset_password_user('.$row->idUser.')"><i class="icofont icofont-refresh"></i> Reset Password</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_user('.$row->idUser.',\''.$row->username.'\',\''.$row->namaLengkap.'\',\''.$row->jabatan.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_user('.$row->idUser.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div><button onclick="update_ttd('.$row->idUser.',\''.$row->pictureSignature.'\')" class="btn btn-sm m-l-10  waves-effect waves-light btn-grd-inverse "><i class="fa fa-lastfm"></i> TTD</button>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

    public function add_akses_user()
    {
        
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];
            $kodeDesa = $namaadmin['kodeDesa'];

            $usermame = $this->input->post('usermame');
            $namaLengkap = $this->input->post('namaLengkap');
            $jabatan = $this->input->post('jabatan');
            $randomCode = $this->input->post('randomCode');
            $noKK = $this->input->post('noKK');

            if ($usermame!="") {
                 $dataInput = array(
                              'kodeDesa' => $kodeDesa,
                              'username' => $usermame,
                              'NIK' => $noKK,
                              'password' => md5($randomCode),
                              'namaLengkap' => $namaLengkap,
                              'jabatan' => $jabatan,
                              'status' => "aktif",
                              'statusLevelUser' => "10",
                              
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('user' , $dataInput);

            //Menampilkan Array dalam Format JSON

                        $hasil['namePass'] = $usermame;
                        $hasil['randomPass'] = $randomCode;

                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
            }else {
                $hasil['resultnya'] = "wrong_pass";
                            echo json_encode($hasil);
            }
            
                       
                            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }
        
    }

    public function update_data_user()
    {
        
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];
            $kodeDesa = $namaadmin['kodeDesa'];

            $IDDataUpdate = $this->input->post('IDDataUpdate');
            $usermame = $this->input->post('username');
            $namaLengkap = $this->input->post('namaLengkap');
            $jabatan = $this->input->post('jabatan');
            $randomCode = $this->input->post('randomCode');

            if ($usermame!="") {
                 $dataInput = array(
                              'kodeDesa' => $kodeDesa,
                              'username' => $usermame,
                              'namaLengkap' => $namaLengkap,
                              'jabatan' => $jabatan,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('user' , $dataInput,"idUser=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON

                        
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
            }else {
                $hasil['resultnya'] = "wrong_pass";
                            echo json_encode($hasil);
            }
            
                       
                            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }
        
    }

    public function reset_password_user()
    {
        
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];
            $kodeDesa = $namaadmin['kodeDesa'];

            $id = $this->input->post('id');
            $randomCode = $this->input->post('resultx');

            if ($id!="") {
                 $dataInput = array(
                              'password' => md5($randomCode),
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('user' , $dataInput,"idUser=$id");

                        $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$id");
                        $nameUser = "";
                        foreach ($selectUser->result() as $row) {
                            $nameUser = $row->username;
                        }

            //Menampilkan Array dalam Format JSON

                        $hasil['namePass'] = $nameUser;
                        $hasil['randomPass'] = $randomCode;

                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
            }else {
                $hasil['resultnya'] = "wrong_pass";
                            echo json_encode($hasil);
            }
            
                       
                            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }
        
    }

    public function delete_akses_user()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('user' , "idUser='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function f31_suket_tidak_ditempat()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "WHERE kedudukanDalamKeluarga='KEPALA KELUARGA' ORDER BY namaLengkap ASC");
            $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);
            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f31_suket_tidak_ditempat";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f31_suket_tidak_ditempat/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }


    public function add_f31_suket_tidak_ditempat()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $randomCode = $this->input->post('randomCode');
        
        $NIKLainnya = $this->input->post('NIKLainnya');
        $namaLainnya = $this->input->post('namaLainnya');
        $alamatDomisili = $this->input->post('alamatDomisili');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $pekerjaan = $this->input->post('pekerjaan');
        $alamatSekarang = $this->input->post('alamatSekarang');
        $keperluanSurat = $this->input->post('keperluanSurat');
        $statusDalamKeluarga = $this->input->post('statusDalamKeluarga');
        
                        $dataInput = array(
                              'kode_formulir' => "f31",
                              'nomorSurat' => $noSurat,
                              'NIK' => $noKK,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                              'hubunganKeluarga' => $statusDalamKeluarga,
                              'alamatDomisili' => $alamatDomisili,
                              'NIKLain' => $NIKLainnya,
                              'keperluanSurat' => $keperluanSurat.";".$tempatLahir.";".$tanggalLahir.";".$jenisKelamin.";".$pekerjaan.";".$alamatSekarang.";".$namaLainnya,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f31_suket_tidak_ditempat' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f31_suket_tidak_ditempat_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $randomCode = $this->input->post('randomCode');
        
        $NIKLainnya = $this->input->post('NIKLainnya');
        $namaLainnya = $this->input->post('namaLainnya');
        $alamatDomisili = $this->input->post('alamatDomisili');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $pekerjaan = $this->input->post('pekerjaan');
        $alamatSekarang = $this->input->post('alamatSekarang');
        $keperluanSurat = $this->input->post('keperluanSurat');
        $statusDalamKeluarga = $this->input->post('statusDalamKeluarga');
        
                        $dataInput = array(
                              'kode_formulir' => "f31",
                              'nomorSurat' => $noSurat,
                              'NIK' => $noKK,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              'hubunganKeluarga' => $statusDalamKeluarga,
                              'alamatDomisili' => $alamatDomisili,
                              'NIKLain' => $NIKLainnya,
                              'keperluanSurat' => $keperluanSurat.";".$tempatLahir.";".$tanggalLahir.";".$jenisKelamin.";".$pekerjaan.";".$alamatSekarang.";".$namaLainnya,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f31_suket_tidak_ditempat' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }


                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f31_suket_tidak_ditempat",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan tidak ditempat",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f31_suket_tidak_ditempat()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $randomCode = $this->input->post('randomCode');
        
        $NIKLainnya = $this->input->post('NIKLainnya');
        $namaLainnya = $this->input->post('namaLainnya');
        $alamatDomisili = $this->input->post('alamatDomisili');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $pekerjaan = $this->input->post('pekerjaan');
        $alamatSekarang = $this->input->post('alamatSekarang');
        $keperluanSurat = $this->input->post('keperluanSurat');
        $statusDalamKeluarga = $this->input->post('statusDalamKeluarga');
       
                        $dataInput = array(
                              'nomorSurat' => $noSurat,
                              'NIK' => $noKK,
                              'randomCode' => $randomCode,
                              'hubunganKeluarga' => $statusDalamKeluarga,
                              'alamatDomisili' => $alamatDomisili,
                              'NIKLain' => $NIKLainnya,
                              'keperluanSurat' => $keperluanSurat.";".$tempatLahir.";".$tanggalLahir.";".$jenisKelamin.";".$pekerjaan.";".$alamatSekarang.";".$namaLainnya,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f31_suket_tidak_ditempat' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f31_suket_tidak_ditempat()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f31_suket_tidak_ditempat' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function showTablef31()
    {


        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            $data['kodeDesa'] = $namaadmin['kodeDesa'];
            
            $idUser = $namaadmin['idUser'];
            $kodeDesa = $namaadmin['kodeDesa'];

        $result = array();

        $er="1409020601087335";

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f31_suket_tidak_ditempat,penduduk", "WHERE f31_suket_tidak_ditempat.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%' || penduduk.nomorKK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f31_suket_tidak_ditempat,penduduk", "WHERE f31_suket_tidak_ditempat.NIK=penduduk.NIK");
        }

        $data['dataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE kodeDesa='$kodeDesa'");
            $alamatTambahan ="";
            foreach ($data['dataDesa']->result() as $row) {
                $alamatTambahan = "Kecamatan ".$row->namaKecamatan." Kabupaten ".$row->namaKabupaten;
            }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f31_suket_tidak_ditempat";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

           $tmptLahir="-";
           $tglLahir="-";
           $jenKelamin="-";
           $jenPekerjaan="-";
           $alamatLain="-";
           $namaLain="-";
           

           $getSelectedActor = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.NIK=".$er);


        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
           foreach ($getSelectedActor->result() as $roz) {
               $tmptLahir = $roz->tempatLahir;
               $tglLahir = $roz->tanggalLahir;
               $jenKelamin = $roz->jenisKelamin;
               $jenPekerjaan = $roz->pekerjaan;
               $alamatLain = $roz->alamatLengkap;
               $namaLain = $roz->namaLengkap;
           }
            
           $alamatSekarang = explode(",", $alamatLain);
           $alamatSekarang = $alamatSekarang[0]." ".strtoupper($alamatTambahan);


           $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                
                    $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->namaLengkap,
                $row->alamatDomisili,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f31_suket_tidak_ditempat(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f31_suket_tidak_ditempat('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\',\''.$row->hubunganKeluarga.'\',\''.$row->alamatDomisili.'\',\''.$row->NIKLain.'\',\''.$row->keperluanSurat.'\',\''.$row->namaLengkap.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f31_suket_tidak_ditempat('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

    }



    //form f21
    public function f21_suket_pengantar_barang()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "WHERE kedudukanDalamKeluarga='KEPALA KELUARGA' ORDER BY namaLengkap ASC");
            $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
            $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
            $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
            $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f21_suket_pengantar_barang";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f21_suket_pengantar_barang/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function showPendudukData_f21()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaProvinsi="";
        $namaKabupaten="";
        $namaKecamatan="";
        $namaDesa="";

        $k1;
        $k2;
        $k3;
        $k4;

        $selectAllShop = $this->Home_model->getSelectData("*,SUBSTRING_INDEX(kode,'.',1) k1,SUBSTRING_INDEX(SUBSTRING_INDEX(kode,'.',2),'.',-1) k2, SUBSTRING_INDEX(SUBSTRING_INDEX(kode,'.',-2),'.',1) k3,SUBSTRING_INDEX(kode,'.',-1) k4","o_wilayah_indonesia", "WHERE kode='$keyword'");


        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
            $k1 = $row->k1;
            $k2 = $row->k2;
            $k3 = $row->k3;
            $k4 = $row->k4;
            

        }

        $selectProvinsi = $this->Home_model->getSelectData("*","o_wilayah_indonesia", "WHERE kode='$k1'");
        $selectKabupaten = $this->Home_model->getSelectData("*","o_wilayah_indonesia", "WHERE kode='$k1.$k2'");
        $selectKecamatan = $this->Home_model->getSelectData("*","o_wilayah_indonesia", "WHERE kode='$k1.$k2.$k3'");
        $selectDesa = $this->Home_model->getSelectData("*","o_wilayah_indonesia", "WHERE kode='$k1.$k2.$k3.$k4'");

        foreach ($selectProvinsi->result() as $row) {
            $namaProvinsi = $row->nama;
        }

        foreach ($selectKabupaten->result() as $row) {
            $namaKabupaten = $row->nama;
        }

        foreach ($selectKecamatan->result() as $row) {
            $namaKecamatan = $row->nama;
        }

        foreach ($selectDesa->result() as $row) {
            $namaDesa = $row->nama;
        }

        
            //Menampilkan Array dalam Format JSON
        $hasil['namaProvinsi'] = $namaProvinsi;
        $hasil['namaKabupaten'] = $namaKabupaten;
        $hasil['namaKecamatan'] = $namaKecamatan;
        $hasil['namaDesa'] = $namaDesa;
        
        echo json_encode($hasil);

    }

    public function add_f21_suket_pengantar_barang_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $randomCode = $this->input->post('randomCode');
        
        $nikPengantar = $this->input->post('nikPengantar');
        $namaPengantar = $this->input->post('namaPengantar');
        $umurPengantar = $this->input->post('umurPengantar');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $jenisPekerjaan = $this->input->post('jenisPekerjaan');
        $alamatPengantar = $this->input->post('alamatPengantar');

        $alamatAsalBarang = $this->input->post('alamatAsalBarang');
        $alamatTujuanAntar = $this->input->post('alamatTujuanAntar');

        $jumlahBarang = $this->input->post('jumlahBarang');
        $keteranganBarang = $this->input->post('keteranganBarang');
        $namaSupir = $this->input->post('namaSupir');
        $jenisKendaraan = $this->input->post('jenisKendaraan');
        $nomorPolisi = $this->input->post('nomorPolisi');


        $jmlBarangParsed = "";
        $ketBarangParsed = "";
        $namSupirParsed = "";
        $jenKendaraanParsed = "";
        $noPolisiParsed = "";
        
        for ($i=0; $i < count($jumlahBarang); $i++) { 
            $jmlBarangParsed.= $jumlahBarang[$i].";";
        }

        for ($i=0; $i < count($keteranganBarang); $i++) { 
            $ketBarangParsed.= $keteranganBarang[$i].";";
        }

        for ($i=0; $i < count($namaSupir); $i++) { 
            $namSupirParsed.= $namaSupir[$i].";";
        }

        for ($i=0; $i < count($jenisKendaraan); $i++) { 
            $jenKendaraanParsed.= $jenisKendaraan[$i].";";
        }

        for ($i=0; $i < count($nomorPolisi); $i++) { 
            $noPolisiParsed.= $nomorPolisi[$i].";";
        }
        
       
                        $dataInput = array(
                              'kode_formulir' => "f21",
                              'nomorSurat' => $noSurat,
                              'NIK' => $noKK,
                              'dataPengantar' => $nikPengantar.";".$namaPengantar.";".$namaPengantar.";".$umurPengantar.";".$jenisKelamin.";".$jenisPekerjaan.";".$alamatPengantar,
                              'dataPengiriman' => $alamatAsalBarang.";".$alamatTujuanAntar,
                              'jumlahBarang' => $jmlBarangParsed,
                              'keteranganBarang' => $ketBarangParsed,
                              'namaSupir' => $namSupirParsed,
                              'jenisKendaraan' => $jenKendaraanParsed,
                              'nomorPolisi' => $noPolisiParsed,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                            );
                        
                        $simpan = $this->Home_model->insertData('f21_suket_pengantar_barang' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f21_suket_pengantar_barang",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan pengantar barang",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }

    public function add_f21_suket_pengantar_barang()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $randomCode = $this->input->post('randomCode');
        
        $nikPengantar = $this->input->post('nikPengantar');
        $namaPengantar = $this->input->post('namaPengantar');
        $umurPengantar = $this->input->post('umurPengantar');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $jenisPekerjaan = $this->input->post('jenisPekerjaan');
        $alamatPengantar = $this->input->post('alamatPengantar');

        $alamatAsalBarang = $this->input->post('alamatAsalBarang');
        $alamatTujuanAntar = $this->input->post('alamatTujuanAntar');

        $jumlahBarang = $this->input->post('jumlahBarang');
        $keteranganBarang = $this->input->post('keteranganBarang');
        $namaSupir = $this->input->post('namaSupir');
        $jenisKendaraan = $this->input->post('jenisKendaraan');
        $nomorPolisi = $this->input->post('nomorPolisi');


        $jmlBarangParsed = "";
        $ketBarangParsed = "";
        $namSupirParsed = "";
        $jenKendaraanParsed = "";
        $noPolisiParsed = "";
        
        for ($i=0; $i < count($jumlahBarang); $i++) { 
            $jmlBarangParsed.= $jumlahBarang[$i].";";
        }

        for ($i=0; $i < count($keteranganBarang); $i++) { 
            $ketBarangParsed.= $keteranganBarang[$i].";";
        }

        for ($i=0; $i < count($namaSupir); $i++) { 
            $namSupirParsed.= $namaSupir[$i].";";
        }

        for ($i=0; $i < count($jenisKendaraan); $i++) { 
            $jenKendaraanParsed.= $jenisKendaraan[$i].";";
        }

        for ($i=0; $i < count($nomorPolisi); $i++) { 
            $noPolisiParsed.= $nomorPolisi[$i].";";
        }
        
       
                        $dataInput = array(
                              'kode_formulir' => "f21",
                              'nomorSurat' => $noSurat,
                              'NIK' => $noKK,
                              'dataPengantar' => $nikPengantar.";".$namaPengantar.";".$namaPengantar.";".$umurPengantar.";".$jenisKelamin.";".$jenisPekerjaan.";".$alamatPengantar,
                              'dataPengiriman' => $alamatAsalBarang.";".$alamatTujuanAntar,
                              'jumlahBarang' => $jmlBarangParsed,
                              'keteranganBarang' => $ketBarangParsed,
                              'namaSupir' => $namSupirParsed,
                              'jenisKendaraan' => $jenKendaraanParsed,
                              'nomorPolisi' => $noPolisiParsed,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                            );
                        
                        $simpan = $this->Home_model->insertData('f21_suket_pengantar_barang' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function update_f21_suket_pengantar_barang()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $randomCode = $this->input->post('randomCode');
        
        $nikPengantar = $this->input->post('nikPengantar');
        $namaPengantar = $this->input->post('namaPengantar');
        $umurPengantar = $this->input->post('umurPengantar');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $jenisPekerjaan = $this->input->post('jenisPekerjaan');
        $alamatPengantar = $this->input->post('alamatPengantar');

        $alamatAsalBarang = $this->input->post('alamatAsalBarang');
        $alamatTujuanAntar = $this->input->post('alamatTujuanAntar');

        $jumlahBarang = $this->input->post('jumlahBarang');
        $keteranganBarang = $this->input->post('keteranganBarang');
        $namaSupir = $this->input->post('namaSupir');
        $jenisKendaraan = $this->input->post('jenisKendaraan');
        $nomorPolisi = $this->input->post('nomorPolisi');


        $jmlBarangParsed = "";
        $ketBarangParsed = "";
        $namSupirParsed = "";
        $jenKendaraanParsed = "";
        $noPolisiParsed = "";
        
        for ($i=0; $i < count($jumlahBarang); $i++) { 
            $jmlBarangParsed.= $jumlahBarang[$i].";";
        }

        for ($i=0; $i < count($keteranganBarang); $i++) { 
            $ketBarangParsed.= $keteranganBarang[$i].";";
        }

        for ($i=0; $i < count($namaSupir); $i++) { 
            $namSupirParsed.= $namaSupir[$i].";";
        }

        for ($i=0; $i < count($jenisKendaraan); $i++) { 
            $jenKendaraanParsed.= $jenisKendaraan[$i].";";
        }

        for ($i=0; $i < count($nomorPolisi); $i++) { 
            $noPolisiParsed.= $nomorPolisi[$i].";";
        }
       
                        $dataInput = array(
                              'kode_formulir' => "f21",
                              'nomorSurat' => $noSurat,
                              'NIK' => $noKK,
                              'dataPengantar' => $nikPengantar.";".$namaPengantar.";".$namaPengantar.";".$umurPengantar.";".$jenisKelamin.";".$jenisPekerjaan.";".$alamatPengantar,
                              'dataPengiriman' => $alamatAsalBarang.";".$alamatTujuanAntar,
                              'jumlahBarang' => $jmlBarangParsed,
                              'keteranganBarang' => $ketBarangParsed,
                              'namaSupir' => $namSupirParsed,
                              'jenisKendaraan' => $jenKendaraanParsed,
                              'nomorPolisi' => $noPolisiParsed,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                            );
                        
                        
                        $simpan = $this->Home_model->updateData('f21_suket_pengantar_barang' , $dataInput,"id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function delete_f21_suket_pengantar_barang()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f21_suket_pengantar_barang' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }

    public function showTableF21()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f21_suket_pengantar_barang,penduduk", "WHERE f21_suket_pengantar_barang.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%' || penduduk.nomorKK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f21_suket_pengantar_barang,penduduk", "WHERE f21_suket_pengantar_barang.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f21_suket_pengantar_barang";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $namaPengirimStr = explode(";", $row->dataPengantar);
            // $senTo = $alamatStr[0].", Desa ".$alamatStr[1].", Kec. ".$alamatStr[2].", Kab. ".$alamatStr[3].", Prov. ".$alamatStr[4];
            $senTo = $namaPengirimStr[1];



            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->namaLengkap,
                strtoupper($senTo),
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f21_suket_pengantar_barang(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f21_suket_pengantar_barang('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\',\''.$row->dataPengantar.'\',\''.$row->dataPengiriman.'\',\''.$row->jumlahBarang.'\',\''.$row->keteranganBarang.'\',\''.$row->namaSupir.'\',\''.$row->jenisKendaraan.'\',\''.$row->nomorPolisi.'\',\''.$row->namaLengkap.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f21_suket_pengantar_barang('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

    //---------------------Biodata Penduduk - Pendaftaran Peristiwa Kependudukan-(F2) -----------------------------


    public function f2_pendaftaran_peristiwa_kependudukan()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f2_pendaftaran_peristiwa_kependudukan";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f2_pendaftaran_peristiwa_kependudukan/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f2_pendaftaran_peristiwa_kependudukan_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");


                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f2_pendaftaran_peristiwa_kependudukan/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f2_pendaftaran_peristiwa_kependudukan()
    {
        
        $noKK = $this->input->post('noKK');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f2",
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f2_pendaftaran_peristiwa_kependudukan' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }

    public function add_f2_pendaftaran_peristiwa_kependudukan_mobile()

    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f2",
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'randomCode' => $randomCode,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f2_pendaftaran_peristiwa_kependudukan' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f2_pendaftaran_peristiwa_kependudukan",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request pendaftaran peristiwa kependudukan",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    }


    public function update_f2_pendaftaran_peristiwa_kependudukan()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f2",
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f2_pendaftaran_peristiwa_kependudukan' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f2_pendaftaran_peristiwa_kependudukan()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f2_pendaftaran_peristiwa_kependudukan' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F2()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F2()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;

        }

        $selectByNomorKK = $this->Home_model->getSelectData("*","penduduk", "WHERE nomorKK='$noKK' AND NIK NOT IN($keyword)");
        foreach ($selectByNomorKK->result() as $row) {
            $hasil['kontenKK'].= '
                <input type="text" class="form-control" value="['.$row->kedudukanDalamKeluarga.'] '.$row->namaLengkap.'" readonly="" required="">
            ';

        }

        
            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        echo json_encode($hasil);

    }



    public function showTable_F2()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f2_pendaftaran_peristiwa_kependudukan,penduduk", "WHERE f2_pendaftaran_peristiwa_kependudukan.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f2_pendaftaran_peristiwa_kependudukan,penduduk", "WHERE f2_pendaftaran_peristiwa_kependudukan.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f2_pendaftaran_peristiwa_kependudukan";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }
            array_push($result,array(
                $number+=1,
                $row->NIK,
                ucfirst(strtolower($row->namaLengkap)),
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f2_pendaftaran_peristiwa_kependudukan(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f2_pendaftaran_peristiwa_kependudukan('.$row->id.',\''.$row->NIK.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f2_pendaftaran_peristiwa_kependudukan('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F2()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f2'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);

                $data['showData'] = $this->Home_model->getSelectData("*","f2_pendaftaran_peristiwa_kependudukan, penduduk", "WHERE f2_pendaftaran_peristiwa_kependudukan.NIK=penduduk.NIK AND f2_pendaftaran_peristiwa_kependudukan.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");

                
                $this->load->view('adminPage/f2_pendaftaran_peristiwa_kependudukan/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }

    //---------------------Biodata Penduduk - Formulir Permohonan KTP - (F4) --------------------------------------


    public function f4_formulir_permohonan_ktp()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            $data['kodeForm'] = "f4_formulir_permohonan_ktp";
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f4_formulir_permohonan_ktp/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f4_formulir_permohonan_ktp_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");

                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f4_formulir_permohonan_ktp/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f4_formulir_permohonan_ktp()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f4",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f4_formulir_permohonan_ktp' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f4_formulir_permohonan_ktp_mobile()

    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f4",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f4_formulir_permohonan_ktp' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f4_formulir_permohonan_ktp",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request permohonan KTP",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    }


    public function update_f4_formulir_permohonan_ktp()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f4",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f4_formulir_permohonan_ktp' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f4_formulir_permohonan_ktp()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f4_formulir_permohonan_ktp' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F4()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F4()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;

        }

        $selectByNomorKK = $this->Home_model->getSelectData("*","penduduk", "WHERE nomorKK='$noKK' AND NIK NOT IN($keyword)");
        foreach ($selectByNomorKK->result() as $row) {
            $hasil['kontenKK'].= '
                <input type="text" class="form-control" value="['.$row->kedudukanDalamKeluarga.'] '.$row->namaLengkap.'" readonly="" required="">
            ';

        }

        
            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        echo json_encode($hasil);

    }



    public function showTable_F4()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f4_formulir_permohonan_ktp,penduduk", "WHERE f4_formulir_permohonan_ktp.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f4_formulir_permohonan_ktp,penduduk", "WHERE f4_formulir_permohonan_ktp.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f4_formulir_permohonan_ktp";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->NIK,
                ucfirst(strtolower($row->namaLengkap)),
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f4_formulir_permohonan_ktp(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f4_formulir_permohonan_ktp('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f4_formulir_permohonan_ktp('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F4()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f4'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);

                $data['showData'] = $this->Home_model->getSelectData("*","f4_formulir_permohonan_ktp, penduduk", "WHERE f4_formulir_permohonan_ktp.NIK=penduduk.NIK AND f4_formulir_permohonan_ktp.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");


                
                $this->load->view('adminPage/f4_formulir_permohonan_ktp/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }

    //---------------------Biodata Penduduk - Surat Keterangan Domisili - (F5) --------------------------------


    public function f5_surat_keterangan_domisili()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataAgama'] = $this->Home_model->getSelectData("*","o_agama", "");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['dataDusun'] = $this->Home_model->getSelectData("*, UPPER(namaDusun) dusX","o_data_dusun", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f5_surat_keterangan_domisili";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f5_surat_keterangan_domisili/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f5_surat_keterangan_domisili_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");

                $data['dataDusun'] = $this->Home_model->getSelectData("*, UPPER(namaDusun) dusX","o_data_dusun", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");

                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f5_surat_keterangan_domisili/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f5_surat_keterangan_domisili()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $dusun = $this->input->post('dusun');
        $statusPerkawinan = $this->input->post('statusPerkawinan');
        $agama = $this->input->post('agama');
        $pekerjaan = $this->input->post('pekerjaan');
        $lamaDomisili = $this->input->post('lamaDomisili');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f5",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'tempatLahir' => $tempatLahir,
                              'tanggalLahir' => $tanggalLahir,
                              'jenisKelamin' => $jenisKelamin,
                              'alamatDusun' => $dusun,
                              'statusPerkawinan' => $statusPerkawinan,
                              'agama' => $agama,
                              'pekerjaan' => $pekerjaan,
                              'lamaDomisili' => $lamaDomisili,
                              'keperluan' => $keperluan,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f5_surat_keterangan_domisili' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f5_surat_keterangan_domisili_mobile()

    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $dusun = $this->input->post('dusun');
        $statusPerkawinan = $this->input->post('statusPerkawinan');
        $agama = $this->input->post('agama');
        $pekerjaan = $this->input->post('pekerjaan');
        $lamaDomisili = $this->input->post('lamaDomisili');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f5",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'tempatLahir' => $tempatLahir,
                              'tanggalLahir' => $tanggalLahir,
                              'jenisKelamin' => $jenisKelamin,
                              'alamatDusun' => $dusun,
                              'statusPerkawinan' => $statusPerkawinan,
                              'agama' => $agama,
                              'pekerjaan' => $pekerjaan,
                              'lamaDomisili' => $lamaDomisili,
                              'keperluan' => $keperluan,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f5_surat_keterangan_domisili' , $dataInput);

                        //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f5_surat_keterangan_domisili",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan domisili",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    }


    public function update_f5_surat_keterangan_domisili()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $dusun = $this->input->post('dusun');
        $statusPerkawinan = $this->input->post('statusPerkawinan');
        $agama = $this->input->post('agama');
        $pekerjaan = $this->input->post('pekerjaan');
        $lamaDomisili = $this->input->post('lamaDomisili');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f5",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'tempatLahir' => $tempatLahir,
                              'tanggalLahir' => $tanggalLahir,
                              'jenisKelamin' => $jenisKelamin,
                              'alamatDusun' => $dusun,
                              'statusPerkawinan' => $statusPerkawinan,
                              'agama' => $agama,
                              'pekerjaan' => $pekerjaan,
                              'lamaDomisili' => $lamaDomisili,
                              'keperluan' => $keperluan,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f5_surat_keterangan_domisili' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f5_surat_keterangan_domisili()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f5_surat_keterangan_domisili' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F5()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F5()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $tempatLahir;
        $tanggalLahir;
        $jenisKelamin;
        $statusPerkawinan;
        $alamatLengkap;
        $agama;
        $pekerjaan;       
        $selectAllShop = $this->Home_model->getSelectData("*,UPPER(pekerjaan) pekT","penduduk", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $tempatLahir = $row->tempatLahir;
            $tanggalLahir = $row->tanggalLahir;
            $jenisKelamin = $row->jenisKelamin;
            $alamatLengkap = $row->alamatLengkap;
            $statusPerkawinan = $row->statusPerkawinan;
            $agama = $row->agama;
            $pekerjaan = $row->pekT;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['tempatLahir'] = $tempatLahir;
        $hasil['tanggalLahir'] = $tanggalLahir;
        $hasil['jenisKelamin'] = $jenisKelamin;
        $hasil['statusPerkawinan'] = $statusPerkawinan;
        $hasil['agama'] = $agama;
        $hasil['pekerjaan'] = $pekerjaan;
        $hasil['alamatLengkap'] = $alamatLengkap;
        echo json_encode($hasil);

    }


    public function showDataUpdate_F5()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $tempatLahir;
        $tanggalLahir;
        $jenisKelamin;
        $statusPerkawinan;
        $alamatLengkap;
        $agama;
        $pekerjaan;  
        $lamaDomisili;
        $keperluan;     
        $selectAllShop = $this->Home_model->getSelectData("*","f5_surat_keterangan_domisili", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $tempatLahir = $row->tempatLahir;
            $tanggalLahir = $row->tanggalLahir;
            $jenisKelamin = $row->jenisKelamin;
            $alamatLengkap = $row->alamatDusun;
            $statusPerkawinan = $row->statusPerkawinan;
            $agama = $row->agama;
            $pekerjaan = $row->pekerjaan;
            $lamaDomisili = $row->lamaDomisili;
            $keperluan = $row->keperluan;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['tempatLahir'] = $tempatLahir;
        $hasil['tanggalLahir'] = $tanggalLahir;
        $hasil['jenisKelamin'] = $jenisKelamin;
        $hasil['statusPerkawinan'] = $statusPerkawinan;
        $hasil['agama'] = $agama;
        $hasil['pekerjaan'] = $pekerjaan;
        $hasil['alamatLengkap'] = $alamatLengkap;
        $hasil['lamaDomisili'] = $lamaDomisili;
        $hasil['keperluan'] = $keperluan;
        echo json_encode($hasil);

    }



    public function showTable_F5()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f5_surat_keterangan_domisili,penduduk", "WHERE f5_surat_keterangan_domisili.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f5_surat_keterangan_domisili,penduduk", "WHERE f5_surat_keterangan_domisili.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f5_surat_keterangan_domisili";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                ucfirst(strtolower($row->namaLengkap)),
                $row->lamaDomisili." Bulan",
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f5_surat_keterangan_domisili(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f5_surat_keterangan_domisili('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f5_surat_keterangan_domisili('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F5()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f5'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*,DATE_FORMAT(f5_surat_keterangan_domisili.tanggalLahir, '%d-%m-%Y') tanggalLahirx,LOWER(jenisKelamin)jenisKelamin,LOWER(statusPerkawinan)statusPerkawinan,LOWER(agama)agama,LOWER(jenisKelamin)jenisKelamin,LOWER(alamatDusun)alamatDusun,LOWER(pekerjaan)pekerjaan","f5_surat_keterangan_domisili", "WHERE f5_surat_keterangan_domisili.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");


                
                $this->load->view('adminPage/f5_surat_keterangan_domisili/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }

    //--------------------Biodata Penduduk - Surat Keterangan Hilang Kartu Keluarga-(F6) -----------------------


    public function f6_surat_ket_hilang_kk()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "WHERE kedudukanDalamKeluarga='KEPALA KELUARGA' ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f6_surat_ket_hilang_kk";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f6_surat_ket_hilang_kartu_keluarga/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f6_surat_ket_hilang_kk_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");

                $data['dataDusun'] = $this->Home_model->getSelectData("*, UPPER(namaDusun) dusX","o_data_dusun", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");

                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f6_surat_ket_hilang_kartu_keluarga/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f6_surat_ket_hilang_kk()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f6",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f6_surat_ket_hilang_kk' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f6_surat_ket_hilang_kk_mobile()

    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f6",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'status' => "aktif;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f6_surat_ket_hilang_kk' , $dataInput);

                        //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f6_surat_ket_hilang_kk",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan hilang KK",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    }


    public function update_f6_surat_ket_hilang_kk()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f6",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f6_surat_ket_hilang_kk' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f6_surat_ket_hilang_kk()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f6_surat_ket_hilang_kk' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F6()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%' || nomorKK LIKE '%$keyword%') AND kedudukanDalamKeluarga='KEPALA KELUARGA' ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F6()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;

        }

        $selectByNomorKK = $this->Home_model->getSelectData("*","penduduk", "WHERE nomorKK='$noKK' AND NIK NOT IN($keyword)");
        foreach ($selectByNomorKK->result() as $row) {
            $hasil['kontenKK'].= '
                <input type="text" class="form-control" value="['.$row->kedudukanDalamKeluarga.'] '.$row->namaLengkap.'" readonly="" required="">
            ';

        }

        
            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        echo json_encode($hasil);

    }



    public function showTable_F6()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f6_surat_ket_hilang_kk,penduduk", "WHERE f6_surat_ket_hilang_kk.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%' || penduduk.nomorKK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f6_surat_ket_hilang_kk,penduduk", "WHERE f6_surat_ket_hilang_kk.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f6_surat_ket_hilang_kk";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nomorKK,
                ucfirst(strtolower($row->namaLengkap)),
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f6_surat_ket_hilang_kk(\''.$row->randomCode.'\',\''.$row->nomorKK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f6_surat_ket_hilang_kk('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f6_surat_ket_hilang_kk('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F6()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "WHERE kedudukanDalamKeluarga='KEPALA KELUARGA' ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f6'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);

                $data['showData'] = $this->Home_model->getSelectData("*,LOWER(jenisKelamin) jenisKelamin,LOWER(agama) agama,LOWER(alamatLengkap) alamatLengkap,LOWER(pekerjaan) pekerjaan","f6_surat_ket_hilang_kk, penduduk", "WHERE f6_surat_ket_hilang_kk.NIK=penduduk.NIK AND f6_surat_ket_hilang_kk.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $idNoKK = $row->nomorKK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk,penduduk_orangtua", "WHERE penduduk.nomorKK=$idNoKK AND penduduk.NIK=penduduk_orangtua.NIK  GROUP BY penduduk.NIK ORDER BY penduduk.kedudukanDalamKeluarga DESC");

                
                $this->load->view('adminPage/f6_surat_ket_hilang_kartu_keluarga/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }




    //----------------Pelayanan Administrasi Kependudukan - SPTJM Kebenaran Data Kelahiran - (F9) --------------


    public function f9_kebenaran_data_kelahiran()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f9_kebenaran_data_kelahiran";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f9_kebenaran_data_kelahiran/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f9_kebenaran_data_kelahiran_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f9_kebenaran_data_kelahiran/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f9_kebenaran_data_kelahiran()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');

        //data anak
        $NIKAnak = $this->input->post('NIKAnak');
        $namaAnak = $this->input->post('namaAnak');
        $tempatLahirAnak = $this->input->post('tempatLahirAnak');
        $tanggalLahirAnak = $this->input->post('tanggalLahirAnak');
        $anakKe = $this->input->post('anakKe');
        $alamatAnak = $this->input->post('alamatAnak');

        //data ibu
        $NIKIbu = $this->input->post('NIKIbu');
        $namaIbu = $this->input->post('namaIbu');
        $tempatLahirIbu = $this->input->post('tempatLahirIbu');
        $tanggalLahirIbu = $this->input->post('tanggalLahirIbu');
        $pekerjaanIbu = $this->input->post('pekerjaanIbu');
        $alamatIbu = $this->input->post('alamatIbu');

        //data penolong
        $NIKPenolong = $this->input->post('NIKPenolong');
        $namaPenolong = $this->input->post('namaPenolong');
        $pekerjaanPenolong = $this->input->post('pekerjaanPenolong');
        $alamatPenolong = $this->input->post('alamatPenolong');

        //data saksi1
        $NIKSaksi1 = $this->input->post('NIKSaksi1');
        $namaSaksi1 = $this->input->post('namaSaksi1');

        //data saksi2
        $NIKSaksi2 = $this->input->post('NIKSaksi2');
        $namaSaksi2 = $this->input->post('namaSaksi2');

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f9",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                              'dataAnak' => $NIKAnak.";".$namaAnak.";".$tempatLahirAnak.";".$tanggalLahirAnak.";".$anakKe.";".$alamatAnak,
                              'dataIbu' => $NIKIbu.";".$namaIbu.";".$tempatLahirIbu.";".$tanggalLahirIbu.";".$pekerjaanIbu.";".$alamatIbu,
                              'dataPenolong' => $NIKPenolong.";".$namaPenolong.";".$pekerjaanPenolong.";".$alamatPenolong,
                              'dataSaksi1' => $NIKSaksi1.";".$namaSaksi1,
                              'dataSaksi2' => $NIKSaksi2.";".$namaSaksi2,
                              
                                
                            );

                        
                        $simpan = $this->Home_model->insertData('f9_kebenaran_data_kelahiran' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f9_kebenaran_data_kelahiran_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');

        //data anak
        $NIKAnak = $this->input->post('NIKAnak');
        $namaAnak = $this->input->post('namaAnak');
        $tempatLahirAnak = $this->input->post('tempatLahirAnak');
        $tanggalLahirAnak = $this->input->post('tanggalLahirAnak');
        $anakKe = $this->input->post('anakKe');
        $alamatAnak = $this->input->post('alamatAnak');

        //data ibu
        $NIKIbu = $this->input->post('NIKIbu');
        $namaIbu = $this->input->post('namaIbu');
        $tempatLahirIbu = $this->input->post('tempatLahirIbu');
        $tanggalLahirIbu = $this->input->post('tanggalLahirIbu');
        $pekerjaanIbu = $this->input->post('pekerjaanIbu');
        $alamatIbu = $this->input->post('alamatIbu');

        //data penolong
        $NIKPenolong = $this->input->post('NIKPenolong');
        $namaPenolong = $this->input->post('namaPenolong');
        $pekerjaanPenolong = $this->input->post('pekerjaanPenolong');
        $alamatPenolong = $this->input->post('alamatPenolong');

        //data saksi1
        $NIKSaksi1 = $this->input->post('NIKSaksi1');
        $namaSaksi1 = $this->input->post('namaSaksi1');

        //data saksi2
        $NIKSaksi2 = $this->input->post('NIKSaksi2');
        $namaSaksi2 = $this->input->post('namaSaksi2');

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f9",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              'dataAnak' => $NIKAnak.";".$namaAnak.";".$tempatLahirAnak.";".$tanggalLahirAnak.";".$anakKe.";".$alamatAnak,
                              'dataIbu' => $NIKIbu.";".$namaIbu.";".$tempatLahirIbu.";".$tanggalLahirIbu.";".$pekerjaanIbu.";".$alamatIbu,
                              'dataPenolong' => $NIKPenolong.";".$namaPenolong.";".$pekerjaanPenolong.";".$alamatPenolong,
                              'dataSaksi1' => $NIKSaksi1.";".$namaSaksi1,
                              'dataSaksi2' => $NIKSaksi2.";".$namaSaksi2,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f9_kebenaran_data_kelahiran' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f9_kebenaran_data_kelahiran",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat kebenaran data kelahiran",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f9_kebenaran_data_kelahiran()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        
        //data anak
        $NIKAnak = $this->input->post('NIKAnak');
        $namaAnak = $this->input->post('namaAnak');
        $tempatLahirAnak = $this->input->post('tempatLahirAnak');
        $tanggalLahirAnak = $this->input->post('tanggalLahirAnak');
        $anakKe = $this->input->post('anakKe');
        $alamatAnak = $this->input->post('alamatAnak');

        //data ibu
        $NIKIbu = $this->input->post('NIKIbu');
        $namaIbu = $this->input->post('namaIbu');
        $tempatLahirIbu = $this->input->post('tempatLahirIbu');
        $tanggalLahirIbu = $this->input->post('tanggalLahirIbu');
        $pekerjaanIbu = $this->input->post('pekerjaanIbu');
        $alamatIbu = $this->input->post('alamatIbu');

        //data penolong
        $NIKPenolong = $this->input->post('NIKPenolong');
        $namaPenolong = $this->input->post('namaPenolong');
        $pekerjaanPenolong = $this->input->post('pekerjaanPenolong');
        $alamatPenolong = $this->input->post('alamatPenolong');

        //data saksi1
        $NIKSaksi1 = $this->input->post('NIKSaksi1');
        $namaSaksi1 = $this->input->post('namaSaksi1');

        //data saksi2
        $NIKSaksi2 = $this->input->post('NIKSaksi2');
        $namaSaksi2 = $this->input->post('namaSaksi2');

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'randomCode' => $randomCode,
                              'dataAnak' => $NIKAnak.";".$namaAnak.";".$tempatLahirAnak.";".$tanggalLahirAnak.";".$anakKe.";".$alamatAnak,
                              'dataIbu' => $NIKIbu.";".$namaIbu.";".$tempatLahirIbu.";".$tanggalLahirIbu.";".$pekerjaanIbu.";".$alamatIbu,
                              'dataPenolong' => $NIKPenolong.";".$namaPenolong.";".$pekerjaanPenolong.";".$alamatPenolong,
                              'dataSaksi1' => $NIKSaksi1.";".$namaSaksi1,
                              'dataSaksi2' => $NIKSaksi2.";".$namaSaksi2,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f9_kebenaran_data_kelahiran' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f9_kebenaran_data_kelahiran()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f9_kebenaran_data_kelahiran' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F9()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F9()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        //tambahan
        $tempatLahir;
        $tanggalLahir;
        $pekerjaan;
        $alamat;
        $anakKe;
        $no=0;
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
            $no=0;
            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $tempatLahir = $row->tempatLahir;
            $tanggalLahir = $row->tanggalLahir;
            $pekerjaan = $row->pekerjaan;
            $alamat = $row->alamatLengkap;
            $anakke = explode(";", $row->kelahiran);
            $anakKe = $anakke[3];

            // $selectnomor = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.nomorKK='$noKK' AND penduduk.kedudukanDalamKeluarga='ANAK' ORDER by penduduk.tanggalLahir ASC");
            // foreach ($selectnomor->result() as $key){
            //    if ($key->NIK == $row->NIK) {
            //        $no = $no+1;
            //    }
            // }

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['tempatLahir'] = $tempatLahir;
        $hasil['tanggalLahir'] = $tanggalLahir;
        $hasil['pekerjaan'] = $pekerjaan;
        $hasil['alamatLengkap'] = ucwords(strtolower($alamat));
        $hasil['urutanDalamKeluarga'] = $no;
        $hasil['anakKe'] = $anakKe;
        echo json_encode($hasil);

    }


    public function showDataUpdate_F9()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $NIKPasanganTerdahulu;
        $namaPasanganTerdahulu;
        $keperluan;
        $aktaPerkawinan;
        $nomorAktaPerkawinan;
        $tanggalPerkawinan;
        $lokasiPerkawinan;
        $statusPerceraian;
        $aktaPerceraian;
        $nomorAktaPerceraian;
        $tanggalPerceraian;
        $lokasiPerceraian;
        $tanggalKematian;
        $tempatKematian;     
        $selectAllShop = $this->Home_model->getSelectData("*","f9_kebenaran_data_kelahiran", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $NIKPasanganTerdahulu = $row->NIKPasanganTerdahulu;
            $namaPasanganTerdahulu = $row->namaPasanganTerdahulu;
            $keperluan = $row->keperluan;
            $aktaPerkawinan = $row->aktaPerkawinan;
            $nomorAktaPerkawinan = $row->nomorAktaPerkawinan;
            $tanggalPerkawinan = $row->tanggalPerkawinan;
            $lokasiPerkawinan = $row->lokasiPerkawinan;
            $statusPerceraian = $row->statusPerceraian;
            $aktaPerceraian = $row->aktaPerceraian;
            $nomorAktaPerceraian = $row->nomorAktaPerceraian;
            $tanggalPerceraian = $row->tanggalPerceraian;
            $lokasiPerceraian = $row->lokasiPerceraian;
            $tanggalKematian = $row->tanggalKematian;
            $tempatKematian = $row->tempatKematian;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['NIKPasanganTerdahulu'] = $NIKPasanganTerdahulu;
        $hasil['namaPasanganTerdahulu'] = $namaPasanganTerdahulu;
        $hasil['keperluan'] = $keperluan;
        $hasil['aktaPerkawinan'] = $aktaPerkawinan;
        $hasil['nomorAktaPerkawinan'] = $nomorAktaPerkawinan;
        $hasil['tanggalPerkawinan'] = $tanggalPerkawinan;
        $hasil['lokasiPerkawinan'] = $lokasiPerkawinan;
        $hasil['statusPerceraian'] = $statusPerceraian;
        $hasil['aktaPerceraian'] = $aktaPerceraian;
        $hasil['nomorAktaPerceraian'] = $nomorAktaPerceraian;
        $hasil['tanggalPerceraian'] = $tanggalPerceraian;
        $hasil['lokasiPerceraian'] = $lokasiPerceraian;
        $hasil['tanggalKematian'] = $tanggalKematian;
        $hasil['tempatKematian'] = $tempatKematian;
        echo json_encode($hasil);

    }



    public function showTable_F9()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f9_kebenaran_data_kelahiran,penduduk", "WHERE f9_kebenaran_data_kelahiran.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f9_kebenaran_data_kelahiran,penduduk", "WHERE f9_kebenaran_data_kelahiran.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f9_kebenaran_data_kelahiran";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $dataIbu = explode(";", $row->dataIbu);
            $dataAnak = explode(";", $row->dataAnak);

            $dataIbuGet = $dataIbu[0];
            $selectAllShopDataIbu = $this->Home_model->getSelectData("*","penduduk", "WHERE  penduduk.NIK=$dataIbuGet");

            $namaibu = "";
            foreach ($selectAllShopDataIbu->result() as $rowx) {
                $namaibu = $rowx->namaLengkap;
            }

            $dataAnakGet = $dataAnak[0];
            $selectAllShopDataAnak = $this->Home_model->getSelectData("*","penduduk", "WHERE  penduduk.NIK=$dataAnakGet");

            $namaanak = "";
            foreach ($selectAllShopDataAnak->result() as $rowxx) {
                $namaanak = $rowxx->namaLengkap;
            }

            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $namaanak,
                $namaibu,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f9_kebenaran_data_kelahiran(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f9_kebenaran_data_kelahiran('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\',\''.$row->nomorKK.'\',\''.$row->nama.'\',\''.$row->dataAnak.'\',\''.$row->dataIbu.'\',\''.$row->dataPenolong.'\',\''.$row->dataSaksi1.'\',\''.$row->dataSaksi2.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f9_kebenaran_data_kelahiran('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F9()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f9'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f9_kebenaran_data_kelahiran", "WHERE f9_kebenaran_data_kelahiran.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");



                
                $this->load->view('adminPage/f9_kebenaran_data_kelahiran/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }




    //--------Pelayanan Administrasi Kependudukan - SPTJM Kebenaran Sebagai Pasangan Suami Istri - (F10) --------


    public function f10_kebenaran_pasangan_suamiistri()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f10_kebenaran_pasangan_suamiistri";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f10_kebenaran_pasangan_suamiistri/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f10_kebenaran_pasangan_suamiistri_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f10_kebenaran_pasangan_suamiistri/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f10_kebenaran_pasangan_suamiistri()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');

        //data suami
        $NIKSuami = $this->input->post('NIKSuami');
        $namaSuami = $this->input->post('namaSuami');
        $tempatLahirSuami = $this->input->post('tempatLahirSuami');
        $tanggalLahirSuami = $this->input->post('tanggalLahirSuami');
        $pekerjaanSuami = $this->input->post('pekerjaanSuami');
        $alamatSuami = $this->input->post('alamatSuami');

        //data istri
        $NIKIstri = $this->input->post('NIKIstri');
        $namaIstri = $this->input->post('namaIstri');
        $tempatLahirIstri = $this->input->post('tempatLahirIstri');
        $tanggalLahirIstri = $this->input->post('tanggalLahirIstri');
        $pekerjaanIstri = $this->input->post('pekerjaanIstri');
        $alamatIstri = $this->input->post('alamatIstri');

        //data saksi1
        $NIKSaksi1 = $this->input->post('NIKSaksi1');
        $namaSaksi1 = $this->input->post('namaSaksi1');

        //data saksi2
        $NIKSaksi2 = $this->input->post('NIKSaksi2');
        $namaSaksi2 = $this->input->post('namaSaksi2');

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f10",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                              'dataSuami' => $NIKSuami.";".$namaSuami.";".$tempatLahirSuami.";".$tanggalLahirSuami.";".$pekerjaanSuami.";".$alamatSuami,
                              'dataIstri' => $NIKIstri.";".$namaIstri.";".$tempatLahirIstri.";".$tanggalLahirIstri.";".$pekerjaanIstri.";".$alamatIstri,
                              'dataSaksi1' => $NIKSaksi1.";".$namaSaksi1,
                              'dataSaksi2' => $NIKSaksi2.";".$namaSaksi2,
                              
                                
                            );

                        
                        $simpan = $this->Home_model->insertData('f10_kebenaran_pasangan_suamiistri' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f10_kebenaran_pasangan_suamiistri_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');

        //data suami
        $NIKSuami = $this->input->post('NIKSuami');
        $namaSuami = $this->input->post('namaSuami');
        $tempatLahirSuami = $this->input->post('tempatLahirSuami');
        $tanggalLahirSuami = $this->input->post('tanggalLahirSuami');
        $pekerjaanSuami = $this->input->post('pekerjaanSuami');
        $alamatSuami = $this->input->post('alamatSuami');

        //data istri
        $NIKIstri = $this->input->post('NIKIstri');
        $namaIstri = $this->input->post('namaIstri');
        $tempatLahirIstri = $this->input->post('tempatLahirIstri');
        $tanggalLahirIstri = $this->input->post('tanggalLahirIstri');
        $pekerjaanIstri = $this->input->post('pekerjaanIstri');
        $alamatIstri = $this->input->post('alamatIstri');

        //data saksi1
        $NIKSaksi1 = $this->input->post('NIKSaksi1');
        $namaSaksi1 = $this->input->post('namaSaksi1');

        //data saksi2
        $NIKSaksi2 = $this->input->post('NIKSaksi2');
        $namaSaksi2 = $this->input->post('namaSaksi2');

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f10",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              'dataSuami' => $NIKSuami.";".$namaSuami.";".$tempatLahirSuami.";".$tanggalLahirSuami.";".$pekerjaanSuami.";".$alamatSuami,
                              'dataIstri' => $NIKIstri.";".$namaIstri.";".$tempatLahirIstri.";".$tanggalLahirIstri.";".$pekerjaanIstri.";".$alamatIstri,
                              'dataSaksi1' => $NIKSaksi1.";".$namaSaksi1,
                              'dataSaksi2' => $NIKSaksi2.";".$namaSaksi2,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f10_kebenaran_pasangan_suamiistri' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f10_kebenaran_pasangan_suamiistri",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat kebenaran pasangan suami istri",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f10_kebenaran_pasangan_suamiistri()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        
         //data suami
        $NIKSuami = $this->input->post('NIKSuami');
        $namaSuami = $this->input->post('namaSuami');
        $tempatLahirSuami = $this->input->post('tempatLahirSuami');
        $tanggalLahirSuami = $this->input->post('tanggalLahirSuami');
        $pekerjaanSuami = $this->input->post('pekerjaanSuami');
        $alamatSuami = $this->input->post('alamatSuami');

        //data istri
        $NIKIstri = $this->input->post('NIKIstri');
        $namaIstri = $this->input->post('namaIstri');
        $tempatLahirIstri = $this->input->post('tempatLahirIstri');
        $tanggalLahirIstri = $this->input->post('tanggalLahirIstri');
        $pekerjaanIstri = $this->input->post('pekerjaanIstri');
        $alamatIstri = $this->input->post('alamatIstri');

        //data saksi1
        $NIKSaksi1 = $this->input->post('NIKSaksi1');
        $namaSaksi1 = $this->input->post('namaSaksi1');

        //data saksi2
        $NIKSaksi2 = $this->input->post('NIKSaksi2');
        $namaSaksi2 = $this->input->post('namaSaksi2');

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'randomCode' => $randomCode,
                              'dataSuami' => $NIKSuami.";".$namaSuami.";".$tempatLahirSuami.";".$tanggalLahirSuami.";".$pekerjaanSuami.";".$alamatSuami,
                              'dataIstri' => $NIKIstri.";".$namaIstri.";".$tempatLahirIstri.";".$tanggalLahirIstri.";".$pekerjaanIstri.";".$alamatIstri,
                              'dataSaksi1' => $NIKSaksi1.";".$namaSaksi1,
                              'dataSaksi2' => $NIKSaksi2.";".$namaSaksi2,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f10_kebenaran_pasangan_suamiistri' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f10_kebenaran_pasangan_suamiistri()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f10_kebenaran_pasangan_suamiistri' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F10()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F10()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        //tambahan
        $tempatLahir;
        $tanggalLahir;
        $pekerjaan;
        $alamat;
        $no=0;
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
            $no=0;
            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $tempatLahir = $row->tempatLahir;
            $tanggalLahir = $row->tanggalLahir;
            $pekerjaan = $row->pekerjaan;
            $alamat = $row->alamatLengkap;

            // $selectnomor = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.nomorKK='$noKK' AND penduduk.kedudukanDalamKeluarga='ANAK' ORDER by penduduk.tanggalLahir ASC");
            // foreach ($selectnomor->result() as $key){
            //    if ($key->NIK == $row->NIK) {
            //        $no = $no+1;
            //    }
            // }

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['tempatLahir'] = $tempatLahir;
        $hasil['tanggalLahir'] = $tanggalLahir;
        $hasil['pekerjaan'] = $pekerjaan;
        $hasil['alamatLengkap'] = ucwords(strtolower($alamat));
        // $hasil['urutanDalamKeluarga'] = $no;
        echo json_encode($hasil);

    }


    public function showDataUpdate_F10()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $NIKPasanganTerdahulu;
        $namaPasanganTerdahulu;
        $keperluan;
        $aktaPerkawinan;
        $nomorAktaPerkawinan;
        $tanggalPerkawinan;
        $lokasiPerkawinan;
        $statusPerceraian;
        $aktaPerceraian;
        $nomorAktaPerceraian;
        $tanggalPerceraian;
        $lokasiPerceraian;
        $tanggalKematian;
        $tempatKematian;     
        $selectAllShop = $this->Home_model->getSelectData("*","f10_kebenaran_pasangan_suamiistri", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $NIKPasanganTerdahulu = $row->NIKPasanganTerdahulu;
            $namaPasanganTerdahulu = $row->namaPasanganTerdahulu;
            $keperluan = $row->keperluan;
            $aktaPerkawinan = $row->aktaPerkawinan;
            $nomorAktaPerkawinan = $row->nomorAktaPerkawinan;
            $tanggalPerkawinan = $row->tanggalPerkawinan;
            $lokasiPerkawinan = $row->lokasiPerkawinan;
            $statusPerceraian = $row->statusPerceraian;
            $aktaPerceraian = $row->aktaPerceraian;
            $nomorAktaPerceraian = $row->nomorAktaPerceraian;
            $tanggalPerceraian = $row->tanggalPerceraian;
            $lokasiPerceraian = $row->lokasiPerceraian;
            $tanggalKematian = $row->tanggalKematian;
            $tempatKematian = $row->tempatKematian;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['NIKPasanganTerdahulu'] = $NIKPasanganTerdahulu;
        $hasil['namaPasanganTerdahulu'] = $namaPasanganTerdahulu;
        $hasil['keperluan'] = $keperluan;
        $hasil['aktaPerkawinan'] = $aktaPerkawinan;
        $hasil['nomorAktaPerkawinan'] = $nomorAktaPerkawinan;
        $hasil['tanggalPerkawinan'] = $tanggalPerkawinan;
        $hasil['lokasiPerkawinan'] = $lokasiPerkawinan;
        $hasil['statusPerceraian'] = $statusPerceraian;
        $hasil['aktaPerceraian'] = $aktaPerceraian;
        $hasil['nomorAktaPerceraian'] = $nomorAktaPerceraian;
        $hasil['tanggalPerceraian'] = $tanggalPerceraian;
        $hasil['lokasiPerceraian'] = $lokasiPerceraian;
        $hasil['tanggalKematian'] = $tanggalKematian;
        $hasil['tempatKematian'] = $tempatKematian;
        echo json_encode($hasil);

    }



    public function showTable_F10()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f10_kebenaran_pasangan_suamiistri,penduduk", "WHERE f10_kebenaran_pasangan_suamiistri.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f10_kebenaran_pasangan_suamiistri,penduduk", "WHERE f10_kebenaran_pasangan_suamiistri.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f10_kebenaran_pasangan_suamiistri";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $dataSuami = explode(";", $row->dataSuami);
            $dataIstri = explode(";", $row->dataIstri);

            $dataSuamiGet = $dataSuami[0];
            $selectAllShopDataSuami = $this->Home_model->getSelectData("*","penduduk", "WHERE  penduduk.NIK=$dataSuamiGet");

            $namasuami = "";
            foreach ($selectAllShopDataSuami->result() as $rowx) {
                $namasuami = $rowx->namaLengkap;
            }

            $dataIstriGet = $dataIstri[0];
            $selectAllShopDataIstri = $this->Home_model->getSelectData("*","penduduk", "WHERE  penduduk.NIK=$dataIstriGet");

            $namaistri = "";
            foreach ($selectAllShopDataIstri->result() as $rowxx) {
                $namaistri = $rowxx->namaLengkap;
            }


            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $namasuami,
                $namaistri,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f10_kebenaran_pasangan_suamiistri(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f10_kebenaran_pasangan_suamiistri('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\',\''.$row->nomorKK.'\',\''.$row->nama.'\',\''.$row->dataSuami.'\',\''.$row->dataIstri.'\',\''.$row->dataSaksi1.'\',\''.$row->dataSaksi2.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f10_kebenaran_pasangan_suamiistri('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F10()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f10'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f10_kebenaran_pasangan_suamiistri", "WHERE f10_kebenaran_pasangan_suamiistri.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");



                
                $this->load->view('adminPage/f10_kebenaran_pasangan_suamiistri/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }




    //-----Pelayanan Administrasi Kependudukan - Surat Pernyataan Belum Memiliki Akta Kelahiran - (F11) --------


    public function f11_pernyataan_belummemiliki_aktalahir()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
            $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f11_pernyataan_belummemiliki_aktalahir";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f11_pernyataan_belummemiliki_aktalahir/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }
    public function f11_pernyataan_belummemiliki_aktalahir_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f11_pernyataan_belummemiliki_aktalahir/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f11_pernyataan_belummemiliki_aktalahir()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $anakKe = $this->input->post('anakKe');

        //data ayah
        $NIKAyah = $this->input->post('NIKAyah');
        $namaAyah = $this->input->post('namaAyah');
        $tempatLahirAyah = $this->input->post('tempatLahirAyah');
        $tanggalLahirAyah = $this->input->post('tanggalLahirAyah');
        $agamaAyah = $this->input->post('agamaAyah');
        $pekerjaanAyah = $this->input->post('pekerjaanAyah');
        $pendidikanAyah = $this->input->post('pendidikanAyah');
        $alamatKTPAyah = $this->input->post('alamatKTPAyah');
        $alamatAyah = $this->input->post('alamatAyah');
        $statusAyah = $this->input->post('statusAyah');

        //data istri
        $NIKIbu = $this->input->post('NIKIbu');
        $namaIbu = $this->input->post('namaIbu');
        $tempatLahirIbu = $this->input->post('tempatLahirIbu');
        $tanggalLahirIbu = $this->input->post('tanggalLahirIbu');
        $agamaIbu = $this->input->post('agamaIbu');
        $pekerjaanIbu = $this->input->post('pekerjaanIbu');
        $pendidikanIbu = $this->input->post('pendidikanIbu');
        $alamatKTPIbu = $this->input->post('alamatKTPIbu');
        $alamatIbu = $this->input->post('alamatIbu');
        $statusIbu = $this->input->post('statusIbu');

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f11",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'anakKe' => $anakKe,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                              'dataAyah' => $NIKAyah.";".$namaAyah.";".$tempatLahirAyah.";".$tanggalLahirAyah.";".$agamaAyah.";".$pekerjaanAyah.";".$pendidikanAyah.";".$alamatKTPAyah.";".$alamatAyah.";".$statusAyah,
                              'dataIbu' => $NIKIbu.";".$namaIbu.";".$tempatLahirIbu.";".$tanggalLahirIbu.";".$agamaIbu.";".$pekerjaanIbu.";".$pendidikanIbu.";".$alamatKTPIbu.";".$alamatIbu.";".$statusIbu,
                              
                                
                            );

                        
                        $simpan = $this->Home_model->insertData('f11_pernyataan_belummemiliki_aktalahir' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f11_pernyataan_belummemiliki_aktalahir_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $anakKe = $this->input->post('anakKe');

        //data ayah
        $NIKAyah = $this->input->post('NIKAyah');
        $namaAyah = $this->input->post('namaAyah');
        $tempatLahirAyah = $this->input->post('tempatLahirAyah');
        $tanggalLahirAyah = $this->input->post('tanggalLahirAyah');
        $agamaAyah = $this->input->post('agamaAyah');
        $pekerjaanAyah = $this->input->post('pekerjaanAyah');
        $pendidikanAyah = $this->input->post('pendidikanAyah');
        $alamatKTPAyah = $this->input->post('alamatKTPAyah');
        $alamatAyah = $this->input->post('alamatAyah');
        $statusAyah = $this->input->post('statusAyah');

        //data istri
        $NIKIbu = $this->input->post('NIKIbu');
        $namaIbu = $this->input->post('namaIbu');
        $tempatLahirIbu = $this->input->post('tempatLahirIbu');
        $tanggalLahirIbu = $this->input->post('tanggalLahirIbu');
        $agamaIbu = $this->input->post('agamaIbu');
        $pekerjaanIbu = $this->input->post('pekerjaanIbu');
        $pendidikanIbu = $this->input->post('pendidikanIbu');
        $alamatKTPIbu = $this->input->post('alamatKTPIbu');
        $alamatIbu = $this->input->post('alamatIbu');
        $statusIbu = $this->input->post('statusIbu');

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f11",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'anakKe' => $anakKe,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              'dataAyah' => $NIKAyah.";".$namaAyah.";".$tempatLahirAyah.";".$tanggalLahirAyah.";".$agamaAyah.";".$pekerjaanAyah.";".$pendidikanAyah.";".$alamatKTPAyah.";".$alamatAyah.";".$statusAyah,
                              'dataIbu' => $NIKIbu.";".$namaIbu.";".$tempatLahirIbu.";".$tanggalLahirIbu.";".$agamaIbu.";".$pekerjaanIbu.";".$pendidikanIbu.";".$alamatKTPIbu.";".$alamatIbu.";".$statusIbu,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f11_pernyataan_belummemiliki_aktalahir' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f11_pernyataan_belummemiliki_aktalahir",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat pernyataan belum punya akta lahir",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f11_pernyataan_belummemiliki_aktalahir()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $anakKe = $this->input->post('anakKe');

        //data ayah
        $NIKAyah = $this->input->post('NIKAyah');
        $namaAyah = $this->input->post('namaAyah');
        $tempatLahirAyah = $this->input->post('tempatLahirAyah');
        $tanggalLahirAyah = $this->input->post('tanggalLahirAyah');
        $agamaAyah = $this->input->post('agamaAyah');
        $pekerjaanAyah = $this->input->post('pekerjaanAyah');
        $pendidikanAyah = $this->input->post('pendidikanAyah');
        $alamatKTPAyah = $this->input->post('alamatKTPAyah');
        $alamatAyah = $this->input->post('alamatAyah');
        $statusAyah = $this->input->post('statusAyah');

        //data istri
        $NIKIbu = $this->input->post('NIKIbu');
        $namaIbu = $this->input->post('namaIbu');
        $tempatLahirIbu = $this->input->post('tempatLahirIbu');
        $tanggalLahirIbu = $this->input->post('tanggalLahirIbu');
        $agamaIbu = $this->input->post('agamaIbu');
        $pekerjaanIbu = $this->input->post('pekerjaanIbu');
        $pendidikanIbu = $this->input->post('pendidikanIbu');
        $alamatKTPIbu = $this->input->post('alamatKTPIbu');
        $alamatIbu = $this->input->post('alamatIbu');
        $statusIbu = $this->input->post('statusIbu');

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'anakKe' => $anakKe,
                              'randomCode' => $randomCode,
                              'dataAyah' => $NIKAyah.";".$namaAyah.";".$tempatLahirAyah.";".$tanggalLahirAyah.";".$agamaAyah.";".$pekerjaanAyah.";".$pendidikanAyah.";".$alamatKTPAyah.";".$alamatAyah.";".$statusAyah,
                              'dataIbu' => $NIKIbu.";".$namaIbu.";".$tempatLahirIbu.";".$tanggalLahirIbu.";".$agamaIbu.";".$pekerjaanIbu.";".$pendidikanIbu.";".$alamatKTPIbu.";".$alamatIbu.";".$statusIbu,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f11_pernyataan_belummemiliki_aktalahir' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f11_pernyataan_belummemiliki_aktalahir()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f11_pernyataan_belummemiliki_aktalahir' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F11()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F11()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        //tambahan
        $tempatLahir;
        $tanggalLahir;
        $pekerjaan;
        $agama;
        $pendidikan;
        $alamat;
        $anakKe;

        $no=0;
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
            $no=0;
            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $tempatLahir = $row->tempatLahir;
            $tanggalLahir = $row->tanggalLahir;
            $pekerjaan = $row->pekerjaan;
            $agama = $row->agama;
            $pendidikan = $row->pendidikanTerakhir;
            $alamat = $row->alamatLengkap;

            $anakke = explode(";", $row->kelahiran);

            $anakKe = $anakke[3];

            // $selectnomor = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.nomorKK='$noKK' AND penduduk.kedudukanDalamKeluarga='ANAK' ORDER by penduduk.tanggalLahir ASC");
            // foreach ($selectnomor->result() as $key){
            //    if ($key->NIK == $row->NIK) {
            //        $no = $no+1;
            //    }
            // }

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['tempatLahir'] = $tempatLahir;
        $hasil['tanggalLahir'] = $tanggalLahir;
        $hasil['agama'] = $agama;
        $hasil['pendidikan'] = $pendidikan;
        $hasil['pekerjaan'] = $pekerjaan;
        $hasil['alamatLengkap'] = ucwords(strtolower($alamat));
        $hasil['anakKe'] = $anakKe ;
        // $hasil['urutanDalamKeluarga'] = $no;
        echo json_encode($hasil);

    }




    public function showTable_F11()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f11_pernyataan_belummemiliki_aktalahir,penduduk", "WHERE f11_pernyataan_belummemiliki_aktalahir.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f11_pernyataan_belummemiliki_aktalahir,penduduk", "WHERE f11_pernyataan_belummemiliki_aktalahir.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f11_pernyataan_belummemiliki_aktalahir";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $dataAyah = explode(";", $row->dataAyah);
            $dataIbu = explode(";", $row->dataIbu);

            $dataAyahGet = $dataAyah[0];
            $selectAllShopDataAyah = $this->Home_model->getSelectData("*","penduduk", "WHERE  penduduk.NIK=$dataAyahGet");

            $namaayah = "";
            foreach ($selectAllShopDataAyah->result() as $rowx) {
                $namaayah = $rowx->namaLengkap;
            }

            $dataIbuGet = $dataIbu[0];
            $selectAllShopDataIbu = $this->Home_model->getSelectData("*","penduduk", "WHERE  penduduk.NIK=$dataIbuGet");

            $namaibu = "";
            foreach ($selectAllShopDataIbu->result() as $rowxx) {
                $namaibu = $rowxx->namaLengkap;
            }

            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                $namaayah,
                $namaibu,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f11_pernyataan_belummemiliki_aktalahir(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f11_pernyataan_belummemiliki_aktalahir('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\',\''.$row->nomorKK.'\',\''.$row->nama.'\',\''.$row->anakKe.'\',\''.$row->dataAyah.'\',\''.$row->dataIbu.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f11_pernyataan_belummemiliki_aktalahir('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F11()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f11'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f11_pernyataan_belummemiliki_aktalahir", "WHERE f11_pernyataan_belummemiliki_aktalahir.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");



                
                $this->load->view('adminPage/f11_pernyataan_belummemiliki_aktalahir/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }




    //-----Pelayanan Administrasi Kependudukan - Surat Keterangan Kematian - (F12) --------


    public function f12_surat_keterangan_kematian()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
            $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f12_surat_keterangan_kematian";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f12_surat_keterangan_kematian/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }
    public function f12_surat_keterangan_kematian_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f12_surat_keterangan_kematian/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f12_surat_keterangan_kematian()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');

        //data orang meninggal
        $jenisKelamin = $this->input->post('jenisKelamin'); 
        $tempatLahir = $this->input->post('tempatLahir'); 
        $tanggalLahir = $this->input->post('tanggalLahir'); 
        $anakKe = $this->input->post('anakKe'); 
        $kewarganegaraan = $this->input->post('kewarganegaraan'); 
        $agama = $this->input->post('agama'); 
        $statusPerkawinan = $this->input->post('statusPerkawinan'); 
        $pekerjaan = $this->input->post('pekerjaan'); 
        $alamat = $this->input->post('alamat'); 
        $desaKelurahan = $this->input->post('desaKelurahan'); 
        $kecamatan = $this->input->post('kecamatan'); 
        $kabupatenKota = $this->input->post('kabupatenKota'); 
        $provinsi = $this->input->post('provinsi'); 
        $namaKepalaSebenarnya = $this->input->post('namaKepalaSebenarnya');

        //data kematian 
        $tempatKematian = $this->input->post('tempatKematian'); 
        $desaKelurahanKematian = $this->input->post('desaKelurahanKematian'); 
        $kecamatanKematian = $this->input->post('kecamatanKematian'); 
        $kabupatenKotaKematian = $this->input->post('kabupatenKotaKematian'); 
        $provinsiKematian = $this->input->post('provinsiKematian'); 
        $tanggalKematian = $this->input->post('tanggalKematian'); 
        $jamKematian = $this->input->post('jamKematian'); 
        $waktuKematian = $this->input->post('waktuKematian'); 
        $sebabKematian = $this->input->post('sebabKematian'); 
        $pengabarKematian = $this->input->post('pengabarKematian'); 
        $aktaKematian = $this->input->post('aktaKematian'); 
        $nomorAktaKematian = $this->input->post('nomorAktaKematian'); 
        $tanggalAktaKematian = $this->input->post('tanggalAktaKematian'); 

        //data ayah
        $NIKAyah = $this->input->post('NIKAyah'); 
        $namaAyah = $this->input->post('namaAyah'); 
        $tanggalLahirAyah = $this->input->post('tanggalLahirAyah'); 
        $pekerjaanAyah = $this->input->post('pekerjaanAyah'); 
        $alamatAyah = $this->input->post('alamatAyah'); 
        $desaKelurahanAyah = $this->input->post('desaKelurahanAyah'); 
        $kecamatanAyah = $this->input->post('kecamatanAyah'); 
        $kabupatenKotaAyah = $this->input->post('kabupatenKotaAyah'); 
        $provinsiAyah = $this->input->post('provinsiAyah'); 

        //data ibu
        $NIKIbu = $this->input->post('NIKIbu');
        $namaIbu = $this->input->post('namaIbu'); 
        $tanggalLahirIbu = $this->input->post('tanggalLahirIbu'); 
        $pekerjaanIbu = $this->input->post('pekerjaanIbu'); 
        $alamatIbu = $this->input->post('alamatIbu'); 
        $desaKelurahanIbu = $this->input->post('desaKelurahanIbu'); 
        $kecamatanIbu = $this->input->post('kecamatanIbu'); 
        $kabupatenKotaIbu = $this->input->post('kabupatenKotaIbu'); 
        $provinsiIbu = $this->input->post('provinsiIbu'); 

        //data pelapor
        $NIKPelapor = $this->input->post('NIKPelapor'); 
        $namaPelapor = $this->input->post('namaPelapor'); 
        $hubunganYangMeninggal = $this->input->post('hubunganYangMeninggal'); 
        $tanggalLahirPelapor = $this->input->post('tanggalLahirPelapor'); 
        $jenisKelaminPelapor = $this->input->post('jenisKelaminPelapor'); 
        $pekerjaanPelapor = $this->input->post('pekerjaanPelapor'); 
        $alamatPelapor = $this->input->post('alamatPelapor'); 
        $desaKelurahanPelapor = $this->input->post('desaKelurahanPelapor'); 
        $kecamatanPelapor = $this->input->post('kecamatanPelapor'); 
        $kabupatenKotaPelapor = $this->input->post('kabupatenKotaPelapor'); 
        $provinsiPelapor = $this->input->post('provinsiPelapor');

        //data saksi1 
        $NIKSaksi1 = $this->input->post('NIKSaksi1'); 
        $namaSaksi1 = $this->input->post('namaSaksi1'); 
        $tanggalLahirSaksi1 = $this->input->post('tanggalLahirSaksi1'); 
        $jenisKelaminSaksi1 = $this->input->post('jenisKelaminSaksi1'); 
        $pekerjaanSaksi1 = $this->input->post('pekerjaanSaksi1'); 
        $alamatSaksi1 = $this->input->post('alamatSaksi1'); 
        $desaKelurahanSaksi1 = $this->input->post('desaKelurahanSaksi1'); 
        $kecamatanSaksi1 = $this->input->post('kecamatanSaksi1'); 
        $kabupatenKotaSaksi1 = $this->input->post('kabupatenKotaSaksi1'); 
        $provinsiSaksi1 = $this->input->post('provinsiSaksi1'); 

        //data saksi2
        $NIKSaksi2 = $this->input->post('NIKSaksi2'); 
        $namaSaksi2 = $this->input->post('namaSaksi2'); 
        $tanggalLahirSaksi2 = $this->input->post('tanggalLahirSaksi2'); 
        $jenisKelaminSaksi2 = $this->input->post('jenisKelaminSaksi2'); 
        $pekerjaanSaksi2 = $this->input->post('pekerjaanSaksi2'); 
        $alamatSaksi2 = $this->input->post('alamatSaksi2'); 
        $desaKelurahanSaksi2 = $this->input->post('desaKelurahanSaksi2'); 
        $kecamatanSaksi2 = $this->input->post('kecamatanSaksi2'); 
        $kabupatenKotaSaksi2 = $this->input->post('kabupatenKotaSaksi2'); 
        $provinsiSaksi2 = $this->input->post('provinsiSaksi2'); 

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f12",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                              'dataOrangMeninggal' => $jenisKelamin.";".$tempatLahir.";".$tanggalLahir.";".$anakKe.";".$kewarganegaraan.";".$agama.";".$statusPerkawinan.";".$pekerjaan.";".$alamat.";".$desaKelurahan.";".$kecamatan.";".$kabupatenKota.";".$provinsi.";".$namaKepalaSebenarnya,
                              'dataKematian' => $tempatKematian.";".$desaKelurahanKematian.";".$kecamatanKematian.";".$kabupatenKotaKematian.";".$provinsiKematian.";".$tanggalKematian.";".$jamKematian.";".$waktuKematian.";".$sebabKematian.";".$pengabarKematian.";".$aktaKematian.";".$nomorAktaKematian.";".$tanggalAktaKematian,
                              'dataAyah' => $NIKAyah.";".$namaAyah.";".$tanggalLahirAyah.";".$pekerjaanAyah.";".$alamatAyah.";".$desaKelurahanAyah.";".$kecamatanAyah.";".$kabupatenKotaAyah.";".$provinsiAyah,
                              'dataIbu' => $NIKIbu.";".$namaIbu.";".$tanggalLahirIbu.";".$pekerjaanIbu.";".$alamatIbu.";".$desaKelurahanIbu.";".$kecamatanIbu.";".$kabupatenKotaIbu.";".$provinsiIbu,
                              'dataPelapor' => $NIKPelapor.";".$namaPelapor.";".$hubunganYangMeninggal.";".$tanggalLahirPelapor.";".$jenisKelaminPelapor.";".$pekerjaanPelapor.";".$alamatPelapor.";".$desaKelurahanPelapor.";".$kecamatanPelapor.";".$kabupatenKotaPelapor.";".$provinsiPelapor,
                              'dataSaksi1' => $NIKSaksi1.";".$namaSaksi1.";".$tanggalLahirSaksi1.";".$jenisKelaminSaksi1.";".$pekerjaanSaksi1.";".$alamatSaksi1.";".$desaKelurahanSaksi1.";".$kecamatanSaksi1.";".$kabupatenKotaSaksi1.";".$provinsiSaksi1,
                              'dataSaksi2' => $NIKSaksi2.";".$namaSaksi2.";".$tanggalLahirSaksi2.";".$jenisKelaminSaksi2.";".$pekerjaanSaksi2.";".$alamatSaksi2.";".$desaKelurahanSaksi2.";".$kecamatanSaksi2.";".$kabupatenKotaSaksi2.";".$provinsiSaksi2,
                              
                            );

                        
                        $simpan = $this->Home_model->insertData('f12_surat_keterangan_kematian' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f12_surat_keterangan_kematian_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');

        //data orang meninggal
        $jenisKelamin = $this->input->post('jenisKelamin'); 
        $tempatLahir = $this->input->post('tempatLahir'); 
        $tanggalLahir = $this->input->post('tanggalLahir'); 
        $anakKe = $this->input->post('anakKe'); 
        $kewarganegaraan = $this->input->post('kewarganegaraan'); 
        $agama = $this->input->post('agama'); 
        $statusPerkawinan = $this->input->post('statusPerkawinan'); 
        $pekerjaan = $this->input->post('pekerjaan'); 
        $alamat = $this->input->post('alamat'); 
        $desaKelurahan = $this->input->post('desaKelurahan'); 
        $kecamatan = $this->input->post('kecamatan'); 
        $kabupatenKota = $this->input->post('kabupatenKota'); 
        $provinsi = $this->input->post('provinsi'); 
        $namaKepalaSebenarnya = $this->input->post('namaKepalaSebenarnya');

        //data kematian 
        $tempatKematian = $this->input->post('tempatKematian'); 
        $desaKelurahanKematian = $this->input->post('desaKelurahanKematian'); 
        $kecamatanKematian = $this->input->post('kecamatanKematian'); 
        $kabupatenKotaKematian = $this->input->post('kabupatenKotaKematian'); 
        $provinsiKematian = $this->input->post('provinsiKematian'); 
        $tanggalKematian = $this->input->post('tanggalKematian'); 
        $jamKematian = $this->input->post('jamKematian'); 
        $waktuKematian = $this->input->post('waktuKematian'); 
        $sebabKematian = $this->input->post('sebabKematian'); 
        $pengabarKematian = $this->input->post('pengabarKematian'); 
        $aktaKematian = $this->input->post('aktaKematian'); 
        $nomorAktaKematian = $this->input->post('nomorAktaKematian'); 
        $tanggalAktaKematian = $this->input->post('tanggalAktaKematian'); 

        //data ayah
        $NIKAyah = $this->input->post('NIKAyah'); 
        $namaAyah = $this->input->post('namaAyah'); 
        $tanggalLahirAyah = $this->input->post('tanggalLahirAyah'); 
        $pekerjaanAyah = $this->input->post('pekerjaanAyah'); 
        $alamatAyah = $this->input->post('alamatAyah'); 
        $desaKelurahanAyah = $this->input->post('desaKelurahanAyah'); 
        $kecamatanAyah = $this->input->post('kecamatanAyah'); 
        $kabupatenKotaAyah = $this->input->post('kabupatenKotaAyah'); 
        $provinsiAyah = $this->input->post('provinsiAyah'); 

        //data ibu
        $NIKIbu = $this->input->post('NIKIbu');
        $namaIbu = $this->input->post('namaIbu'); 
        $tanggalLahirIbu = $this->input->post('tanggalLahirIbu'); 
        $pekerjaanIbu = $this->input->post('pekerjaanIbu'); 
        $alamatIbu = $this->input->post('alamatIbu'); 
        $desaKelurahanIbu = $this->input->post('desaKelurahanIbu'); 
        $kecamatanIbu = $this->input->post('kecamatanIbu'); 
        $kabupatenKotaIbu = $this->input->post('kabupatenKotaIbu'); 
        $provinsiIbu = $this->input->post('provinsiIbu'); 

        //data pelapor
        $NIKPelapor = $this->input->post('NIKPelapor'); 
        $namaPelapor = $this->input->post('namaPelapor'); 
        $hubunganYangMeninggal = $this->input->post('hubunganYangMeninggal'); 
        $tanggalLahirPelapor = $this->input->post('tanggalLahirPelapor'); 
        $jenisKelaminPelapor = $this->input->post('jenisKelaminPelapor'); 
        $pekerjaanPelapor = $this->input->post('pekerjaanPelapor'); 
        $alamatPelapor = $this->input->post('alamatPelapor'); 
        $desaKelurahanPelapor = $this->input->post('desaKelurahanPelapor'); 
        $kecamatanPelapor = $this->input->post('kecamatanPelapor'); 
        $kabupatenKotaPelapor = $this->input->post('kabupatenKotaPelapor'); 
        $provinsiPelapor = $this->input->post('provinsiPelapor');

        //data saksi1 
        $NIKSaksi1 = $this->input->post('NIKSaksi1'); 
        $namaSaksi1 = $this->input->post('namaSaksi1'); 
        $tanggalLahirSaksi1 = $this->input->post('tanggalLahirSaksi1'); 
        $jenisKelaminSaksi1 = $this->input->post('jenisKelaminSaksi1'); 
        $pekerjaanSaksi1 = $this->input->post('pekerjaanSaksi1'); 
        $alamatSaksi1 = $this->input->post('alamatSaksi1'); 
        $desaKelurahanSaksi1 = $this->input->post('desaKelurahanSaksi1'); 
        $kecamatanSaksi1 = $this->input->post('kecamatanSaksi1'); 
        $kabupatenKotaSaksi1 = $this->input->post('kabupatenKotaSaksi1'); 
        $provinsiSaksi1 = $this->input->post('provinsiSaksi1'); 

        //data saksi2
        $NIKSaksi2 = $this->input->post('NIKSaksi2'); 
        $namaSaksi2 = $this->input->post('namaSaksi2'); 
        $tanggalLahirSaksi2 = $this->input->post('tanggalLahirSaksi2'); 
        $jenisKelaminSaksi2 = $this->input->post('jenisKelaminSaksi2'); 
        $pekerjaanSaksi2 = $this->input->post('pekerjaanSaksi2'); 
        $alamatSaksi2 = $this->input->post('alamatSaksi2'); 
        $desaKelurahanSaksi2 = $this->input->post('desaKelurahanSaksi2'); 
        $kecamatanSaksi2 = $this->input->post('kecamatanSaksi2'); 
        $kabupatenKotaSaksi2 = $this->input->post('kabupatenKotaSaksi2'); 
        $provinsiSaksi2 = $this->input->post('provinsiSaksi2'); 

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f12",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              'dataOrangMeninggal' => $jenisKelamin.";".$tempatLahir.";".$tanggalLahir.";".$anakKe.";".$kewarganegaraan.";".$agama.";".$statusPerkawinan.";".$pekerjaan.";".$alamat.";".$desaKelurahan.";".$kecamatan.";".$kabupatenKota.";".$provinsi.";".$namaKepalaSebenarnya,
                              'dataKematian' => $tempatKematian.";".$desaKelurahanKematian.";".$kecamatanKematian.";".$kabupatenKotaKematian.";".$provinsiKematian.";".$tanggalKematian.";".$jamKematian.";".$waktuKematian.";".$sebabKematian.";".$pengabarKematian.";".$aktaKematian.";".$nomorAktaKematian.";".$tanggalAktaKematian,
                              'dataAyah' => $NIKAyah.";".$namaAyah.";".$tanggalLahirAyah.";".$pekerjaanAyah.";".$alamatAyah.";".$desaKelurahanAyah.";".$kecamatanAyah.";".$kabupatenKotaAyah.";".$provinsiAyah,
                              'dataIbu' => $NIKIbu.";".$namaIbu.";".$tanggalLahirIbu.";".$pekerjaanIbu.";".$alamatIbu.";".$desaKelurahanIbu.";".$kecamatanIbu.";".$kabupatenKotaIbu.";".$provinsiIbu,
                              'dataPelapor' => $NIKPelapor.";".$namaPelapor.";".$hubunganYangMeninggal.";".$tanggalLahirPelapor.";".$jenisKelaminPelapor.";".$pekerjaanPelapor.";".$alamatPelapor.";".$desaKelurahanPelapor.";".$kecamatanPelapor.";".$kabupatenKotaPelapor.";".$provinsiPelapor,
                              'dataSaksi1' => $NIKSaksi1.";".$namaSaksi1.";".$tanggalLahirSaksi1.";".$jenisKelaminSaksi1.";".$pekerjaanSaksi1.";".$alamatSaksi1.";".$desaKelurahanSaksi1.";".$kecamatanSaksi1.";".$kabupatenKotaSaksi1.";".$provinsiSaksi1,
                              'dataSaksi2' => $NIKSaksi2.";".$namaSaksi2.";".$tanggalLahirSaksi2.";".$jenisKelaminSaksi2.";".$pekerjaanSaksi2.";".$alamatSaksi2.";".$desaKelurahanSaksi2.";".$kecamatanSaksi2.";".$kabupatenKotaSaksi2.";".$provinsiSaksi2,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f12_surat_keterangan_kematian' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f12_surat_keterangan_kematian",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan kematian",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f12_surat_keterangan_kematian()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');

        //data orang meninggal
        $jenisKelamin = $this->input->post('jenisKelamin'); 
        $tempatLahir = $this->input->post('tempatLahir'); 
        $tanggalLahir = $this->input->post('tanggalLahir'); 
        $anakKe = $this->input->post('anakKe'); 
        $kewarganegaraan = $this->input->post('kewarganegaraan'); 
        $agama = $this->input->post('agama'); 
        $statusPerkawinan = $this->input->post('statusPerkawinan'); 
        $pekerjaan = $this->input->post('pekerjaan'); 
        $alamat = $this->input->post('alamat'); 
        $desaKelurahan = $this->input->post('desaKelurahan'); 
        $kecamatan = $this->input->post('kecamatan'); 
        $kabupatenKota = $this->input->post('kabupatenKota'); 
        $provinsi = $this->input->post('provinsi'); 
        $namaKepalaSebenarnya = $this->input->post('namaKepalaSebenarnya');

        //data kematian 
        $tempatKematian = $this->input->post('tempatKematian'); 
        $desaKelurahanKematian = $this->input->post('desaKelurahanKematian'); 
        $kecamatanKematian = $this->input->post('kecamatanKematian'); 
        $kabupatenKotaKematian = $this->input->post('kabupatenKotaKematian'); 
        $provinsiKematian = $this->input->post('provinsiKematian'); 
        $tanggalKematian = $this->input->post('tanggalKematian'); 
        $jamKematian = $this->input->post('jamKematian'); 
        $waktuKematian = $this->input->post('waktuKematian'); 
        $sebabKematian = $this->input->post('sebabKematian'); 
        $pengabarKematian = $this->input->post('pengabarKematian'); 
        $aktaKematian = $this->input->post('aktaKematian'); 
        $nomorAktaKematian = $this->input->post('nomorAktaKematian'); 
        $tanggalAktaKematian = $this->input->post('tanggalAktaKematian'); 

        //data ayah
        $NIKAyah = $this->input->post('NIKAyah'); 
        $namaAyah = $this->input->post('namaAyah'); 
        $tanggalLahirAyah = $this->input->post('tanggalLahirAyah'); 
        $pekerjaanAyah = $this->input->post('pekerjaanAyah'); 
        $alamatAyah = $this->input->post('alamatAyah'); 
        $desaKelurahanAyah = $this->input->post('desaKelurahanAyah'); 
        $kecamatanAyah = $this->input->post('kecamatanAyah'); 
        $kabupatenKotaAyah = $this->input->post('kabupatenKotaAyah'); 
        $provinsiAyah = $this->input->post('provinsiAyah'); 

        //data ibu
        $NIKIbu = $this->input->post('NIKIbu');
        $namaIbu = $this->input->post('namaIbu'); 
        $tanggalLahirIbu = $this->input->post('tanggalLahirIbu'); 
        $pekerjaanIbu = $this->input->post('pekerjaanIbu'); 
        $alamatIbu = $this->input->post('alamatIbu'); 
        $desaKelurahanIbu = $this->input->post('desaKelurahanIbu'); 
        $kecamatanIbu = $this->input->post('kecamatanIbu'); 
        $kabupatenKotaIbu = $this->input->post('kabupatenKotaIbu'); 
        $provinsiIbu = $this->input->post('provinsiIbu'); 

        //data pelapor
        $NIKPelapor = $this->input->post('NIKPelapor'); 
        $namaPelapor = $this->input->post('namaPelapor'); 
        $hubunganYangMeninggal = $this->input->post('hubunganYangMeninggal'); 
        $tanggalLahirPelapor = $this->input->post('tanggalLahirPelapor'); 
        $jenisKelaminPelapor = $this->input->post('jenisKelaminPelapor'); 
        $pekerjaanPelapor = $this->input->post('pekerjaanPelapor'); 
        $alamatPelapor = $this->input->post('alamatPelapor'); 
        $desaKelurahanPelapor = $this->input->post('desaKelurahanPelapor'); 
        $kecamatanPelapor = $this->input->post('kecamatanPelapor'); 
        $kabupatenKotaPelapor = $this->input->post('kabupatenKotaPelapor'); 
        $provinsiPelapor = $this->input->post('provinsiPelapor');

        //data saksi1 
        $NIKSaksi1 = $this->input->post('NIKSaksi1'); 
        $namaSaksi1 = $this->input->post('namaSaksi1'); 
        $tanggalLahirSaksi1 = $this->input->post('tanggalLahirSaksi1'); 
        $jenisKelaminSaksi1 = $this->input->post('jenisKelaminSaksi1'); 
        $pekerjaanSaksi1 = $this->input->post('pekerjaanSaksi1'); 
        $alamatSaksi1 = $this->input->post('alamatSaksi1'); 
        $desaKelurahanSaksi1 = $this->input->post('desaKelurahanSaksi1'); 
        $kecamatanSaksi1 = $this->input->post('kecamatanSaksi1'); 
        $kabupatenKotaSaksi1 = $this->input->post('kabupatenKotaSaksi1'); 
        $provinsiSaksi1 = $this->input->post('provinsiSaksi1'); 

        //data saksi2
        $NIKSaksi2 = $this->input->post('NIKSaksi2'); 
        $namaSaksi2 = $this->input->post('namaSaksi2'); 
        $tanggalLahirSaksi2 = $this->input->post('tanggalLahirSaksi2'); 
        $jenisKelaminSaksi2 = $this->input->post('jenisKelaminSaksi2'); 
        $pekerjaanSaksi2 = $this->input->post('pekerjaanSaksi2'); 
        $alamatSaksi2 = $this->input->post('alamatSaksi2'); 
        $desaKelurahanSaksi2 = $this->input->post('desaKelurahanSaksi2'); 
        $kecamatanSaksi2 = $this->input->post('kecamatanSaksi2'); 
        $kabupatenKotaSaksi2 = $this->input->post('kabupatenKotaSaksi2'); 
        $provinsiSaksi2 = $this->input->post('provinsiSaksi2'); 

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'randomCode' => $randomCode,
                              'dataOrangMeninggal' => $jenisKelamin.";".$tempatLahir.";".$tanggalLahir.";".$anakKe.";".$kewarganegaraan.";".$agama.";".$statusPerkawinan.";".$pekerjaan.";".$alamat.";".$desaKelurahan.";".$kecamatan.";".$kabupatenKota.";".$provinsi.";".$namaKepalaSebenarnya,
                              'dataKematian' => $tempatKematian.";".$desaKelurahanKematian.";".$kecamatanKematian.";".$kabupatenKotaKematian.";".$provinsiKematian.";".$tanggalKematian.";".$jamKematian.";".$waktuKematian.";".$sebabKematian.";".$pengabarKematian.";".$aktaKematian.";".$nomorAktaKematian.";".$tanggalAktaKematian,
                              'dataAyah' => $NIKAyah.";".$namaAyah.";".$tanggalLahirAyah.";".$pekerjaanAyah.";".$alamatAyah.";".$desaKelurahanAyah.";".$kecamatanAyah.";".$kabupatenKotaAyah.";".$provinsiAyah,
                              'dataIbu' => $NIKIbu.";".$namaIbu.";".$tanggalLahirIbu.";".$pekerjaanIbu.";".$alamatIbu.";".$desaKelurahanIbu.";".$kecamatanIbu.";".$kabupatenKotaIbu.";".$provinsiIbu,
                              'dataPelapor' => $NIKPelapor.";".$namaPelapor.";".$hubunganYangMeninggal.";".$tanggalLahirPelapor.";".$jenisKelaminPelapor.";".$pekerjaanPelapor.";".$alamatPelapor.";".$desaKelurahanPelapor.";".$kecamatanPelapor.";".$kabupatenKotaPelapor.";".$provinsiPelapor,
                              'dataSaksi1' => $NIKSaksi1.";".$namaSaksi1.";".$tanggalLahirSaksi1.";".$jenisKelaminSaksi1.";".$pekerjaanSaksi1.";".$alamatSaksi1.";".$desaKelurahanSaksi1.";".$kecamatanSaksi1.";".$kabupatenKotaSaksi1.";".$provinsiSaksi1,
                              'dataSaksi2' => $NIKSaksi2.";".$namaSaksi2.";".$tanggalLahirSaksi2.";".$jenisKelaminSaksi2.";".$pekerjaanSaksi2.";".$alamatSaksi2.";".$desaKelurahanSaksi2.";".$kecamatanSaksi2.";".$kabupatenKotaSaksi2.";".$provinsiSaksi2,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f12_surat_keterangan_kematian' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f12_surat_keterangan_kematian()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f12_surat_keterangan_kematian' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F12()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F12()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        //tambahan
        $tempatLahir;
        $tanggalLahir;
        $jenisKelamin;
        $pekerjaan;
        $agama;
        $pendidikan;
        $alamat;
        $kewarganegaraan;
        $statusPerkawinan;
        $kepalaKeluarga;
        $anakKe;
        $no=0;
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
            $no=0;
            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $tempatLahir = $row->tempatLahir;
            $tanggalLahir = $row->tanggalLahir;
            $jenisKelamin = $row->jenisKelamin;
            $pekerjaan = $row->pekerjaan;
            $agama = $row->agama;
            $pendidikan = $row->pendidikanTerakhir;
            $alamat = $row->alamatLengkap;
            $kewarganegaraan = $row->kewarganegaraan;
            $statusPerkawinan = $row->statusPerkawinan;
            $anakke = explode(";", $row->kelahiran);
            $anakKe = $anakke[3];

            $selectkepala = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.nomorKK='$noKK' AND penduduk.kedudukanDalamKeluarga='KEPALA KELUARGA'");
            foreach ($selectkepala->result() as $key) {
                
                $kepalaKeluarga = $key->namaLengkap;
            }

            // $selectnomor = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.nomorKK='$noKK' AND penduduk.kedudukanDalamKeluarga='ANAK' ORDER by penduduk.tanggalLahir ASC");
            // foreach ($selectnomor->result() as $key){
            //    if ($key->NIK == $row->NIK) {
            //        $no = $no+1;
            //    }
            // }

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['tempatLahir'] = $tempatLahir;
        $hasil['tanggalLahir'] = $tanggalLahir;
        $hasil['jenisKelamin'] = $jenisKelamin;
        $hasil['agama'] = $agama;
        $hasil['pendidikan'] = $pendidikan;
        $hasil['pekerjaan'] = $pekerjaan;
        $hasil['alamatLengkap'] = ucwords(strtolower($alamat));
        $hasil['kewarganegaraan'] = $kewarganegaraan;
        $hasil['statusPerkawinan'] = $statusPerkawinan;
        $hasil['kepalaKeluarga'] = $kepalaKeluarga;
        $hasil['anakKe'] = $anakKe;
        // $hasil['urutanDalamKeluarga'] = $no;
        echo json_encode($hasil);

    }




    public function showTable_F12()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f12_surat_keterangan_kematian,penduduk", "WHERE f12_surat_keterangan_kematian.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f12_surat_keterangan_kematian,penduduk", "WHERE f12_surat_keterangan_kematian.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f12_surat_keterangan_kematian";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $dataKematian = explode(";", $row->dataKematian);

                        $tgl = $dataKematian[5]; 
                        setlocale(LC_ALL, 'IND');

                        $bulan = date('m', strtotime($tgl));
                        if($bulan=='01'){
                            $bulan='Januari';
                        }else if($bulan=='02'){
                            $bulan='Februari';
                        }else if($bulan=='03'){
                            $bulan='Maret';
                        }else if($bulan=='04'){
                            $bulan='April';
                        }else if($bulan=='05'){
                            $bulan='Mei';
                        }else if($bulan=='06'){
                            $bulan='Juni';
                        }else if($bulan=='07'){
                            $bulan='Juli';
                        }else if($bulan=='08'){
                            $bulan='Agustus';
                        }else if($bulan=='09'){
                            $bulan='September';
                        }else if($bulan=='10'){
                            $bulan='Oktober';
                        }else if($bulan=='11'){
                            $bulan='November';
                        }else if($bulan=='12'){
                            $bulan='Desember';
                        }
            // $selectAllShopDataAyah = $this->Home_model->getSelectData("*","penduduk", "WHERE  penduduk.NIK=$dataAyahGet");

            // $namaayah = "";
            // foreach ($selectAllShopDataAyah->result() as $rowx) {
            //     $namaayah = $rowx->namaLengkap;
            // }

            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                strftime('%d'." $bulan ".'%Y', strtotime($tgl)).' '.$dataKematian[6].' '.$dataKematian[7],
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f12_surat_keterangan_kematian(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f12_surat_keterangan_kematian('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\',\''.$row->nomorKK.'\',\''.$row->nama.'\',\''.$row->dataOrangMeninggal.'\',\''.$row->dataKematian.'\',\''.$row->dataAyah.'\',\''.$row->dataIbu.'\',\''.$row->dataPelapor.'\',\''.$row->dataSaksi1.'\',\''.$row->dataSaksi2.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f12_surat_keterangan_kematian('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F12()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f12'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f12_surat_keterangan_kematian", "WHERE f12_surat_keterangan_kematian.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['showDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif' LIMIT 1");



                
                $this->load->view('adminPage/f12_surat_keterangan_kematian/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }



    //-----Pelayanan Administrasi Kependudukan - Surat Kematian - (F13) --------


    public function f13_surat_kematian()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
            $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f13_surat_kematian";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f13_surat_kematian/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }
    public function f13_surat_kematian_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f13_surat_kematian/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f13_surat_kematian()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');

        //data orang meninggal
        $jenisKelamin = $this->input->post('jenisKelamin'); 
        $tempatLahir = $this->input->post('tempatLahir'); 
        $tanggalLahir = $this->input->post('tanggalLahir'); 
        $anakKe = $this->input->post('anakKe'); 
        $kewarganegaraan = $this->input->post('kewarganegaraan'); 
        $agama = $this->input->post('agama'); 
        $statusPerkawinan = $this->input->post('statusPerkawinan'); 
        $pekerjaan = $this->input->post('pekerjaan'); 
        $alamat = $this->input->post('alamat'); 
        $desaKelurahan = $this->input->post('desaKelurahan'); 
        $kecamatan = $this->input->post('kecamatan'); 
        $kabupatenKota = $this->input->post('kabupatenKota'); 
        $provinsi = $this->input->post('provinsi'); 
        $namaKepalaSebenarnya = $this->input->post('namaKepalaSebenarnya');

        //data kematian 
        $tempatKematian = $this->input->post('tempatKematian'); 
        $desaKelurahanKematian = $this->input->post('desaKelurahanKematian'); 
        $kecamatanKematian = $this->input->post('kecamatanKematian'); 
        $kabupatenKotaKematian = $this->input->post('kabupatenKotaKematian'); 
        $provinsiKematian = $this->input->post('provinsiKematian'); 
        $tanggalKematian = $this->input->post('tanggalKematian'); 
        $jamKematian = $this->input->post('jamKematian'); 
        $waktuKematian = $this->input->post('waktuKematian'); 
        $sebabKematian = $this->input->post('sebabKematian'); 
        $pengabarKematian = $this->input->post('pengabarKematian'); 
        $aktaKematian = $this->input->post('aktaKematian'); 
        $nomorAktaKematian = $this->input->post('nomorAktaKematian'); 
        $tanggalAktaKematian = $this->input->post('tanggalAktaKematian'); 

        //data pelapor
        $NIKPelapor = $this->input->post('NIKPelapor'); 
        $namaPelapor = $this->input->post('namaPelapor'); 
        $hubunganYangMeninggal = $this->input->post('hubunganYangMeninggal'); 
        $tanggalLahirPelapor = $this->input->post('tanggalLahirPelapor'); 
        $jenisKelaminPelapor = $this->input->post('jenisKelaminPelapor'); 
        $pekerjaanPelapor = $this->input->post('pekerjaanPelapor'); 
        $alamatPelapor = $this->input->post('alamatPelapor'); 
        $desaKelurahanPelapor = $this->input->post('desaKelurahanPelapor'); 
        $kecamatanPelapor = $this->input->post('kecamatanPelapor'); 
        $kabupatenKotaPelapor = $this->input->post('kabupatenKotaPelapor'); 
        $provinsiPelapor = $this->input->post('provinsiPelapor'); 

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f13",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                              'dataOrangMeninggal' => $jenisKelamin.";".$tempatLahir.";".$tanggalLahir.";".$anakKe.";".$kewarganegaraan.";".$agama.";".$statusPerkawinan.";".$pekerjaan.";".$alamat.";".$desaKelurahan.";".$kecamatan.";".$kabupatenKota.";".$provinsi.";".$namaKepalaSebenarnya,
                              'dataKematian' => $tempatKematian.";".$desaKelurahanKematian.";".$kecamatanKematian.";".$kabupatenKotaKematian.";".$provinsiKematian.";".$tanggalKematian.";".$jamKematian.";".$waktuKematian.";".$sebabKematian.";".$pengabarKematian.";".$aktaKematian.";".$nomorAktaKematian.";".$tanggalAktaKematian,
                              'dataPelapor' => $NIKPelapor.";".$namaPelapor.";".$hubunganYangMeninggal.";".$tanggalLahirPelapor.";".$jenisKelaminPelapor.";".$pekerjaanPelapor.";".$alamatPelapor.";".$desaKelurahanPelapor.";".$kecamatanPelapor.";".$kabupatenKotaPelapor.";".$provinsiPelapor,
                              
                            );

                        
                        $simpan = $this->Home_model->insertData('f13_surat_kematian' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f13_surat_kematian_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');

        //data orang meninggal
        $jenisKelamin = $this->input->post('jenisKelamin'); 
        $tempatLahir = $this->input->post('tempatLahir'); 
        $tanggalLahir = $this->input->post('tanggalLahir'); 
        $anakKe = $this->input->post('anakKe'); 
        $kewarganegaraan = $this->input->post('kewarganegaraan'); 
        $agama = $this->input->post('agama'); 
        $statusPerkawinan = $this->input->post('statusPerkawinan'); 
        $pekerjaan = $this->input->post('pekerjaan'); 
        $alamat = $this->input->post('alamat'); 
        $desaKelurahan = $this->input->post('desaKelurahan'); 
        $kecamatan = $this->input->post('kecamatan'); 
        $kabupatenKota = $this->input->post('kabupatenKota'); 
        $provinsi = $this->input->post('provinsi'); 
        $namaKepalaSebenarnya = $this->input->post('namaKepalaSebenarnya');

        //data kematian 
        $tempatKematian = $this->input->post('tempatKematian'); 
        $desaKelurahanKematian = $this->input->post('desaKelurahanKematian'); 
        $kecamatanKematian = $this->input->post('kecamatanKematian'); 
        $kabupatenKotaKematian = $this->input->post('kabupatenKotaKematian'); 
        $provinsiKematian = $this->input->post('provinsiKematian'); 
        $tanggalKematian = $this->input->post('tanggalKematian'); 
        $jamKematian = $this->input->post('jamKematian'); 
        $waktuKematian = $this->input->post('waktuKematian'); 
        $sebabKematian = $this->input->post('sebabKematian'); 
        $pengabarKematian = $this->input->post('pengabarKematian'); 
        $aktaKematian = $this->input->post('aktaKematian'); 
        $nomorAktaKematian = $this->input->post('nomorAktaKematian'); 
        $tanggalAktaKematian = $this->input->post('tanggalAktaKematian'); 

        //data pelapor
        $NIKPelapor = $this->input->post('NIKPelapor'); 
        $namaPelapor = $this->input->post('namaPelapor'); 
        $hubunganYangMeninggal = $this->input->post('hubunganYangMeninggal'); 
        $tanggalLahirPelapor = $this->input->post('tanggalLahirPelapor'); 
        $jenisKelaminPelapor = $this->input->post('jenisKelaminPelapor'); 
        $pekerjaanPelapor = $this->input->post('pekerjaanPelapor'); 
        $alamatPelapor = $this->input->post('alamatPelapor'); 
        $desaKelurahanPelapor = $this->input->post('desaKelurahanPelapor'); 
        $kecamatanPelapor = $this->input->post('kecamatanPelapor'); 
        $kabupatenKotaPelapor = $this->input->post('kabupatenKotaPelapor'); 
        $provinsiPelapor = $this->input->post('provinsiPelapor'); 

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f13",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                              'dataOrangMeninggal' => $jenisKelamin.";".$tempatLahir.";".$tanggalLahir.";".$anakKe.";".$kewarganegaraan.";".$agama.";".$statusPerkawinan.";".$pekerjaan.";".$alamat.";".$desaKelurahan.";".$kecamatan.";".$kabupatenKota.";".$provinsi.";".$namaKepalaSebenarnya,
                              'dataKematian' => $tempatKematian.";".$desaKelurahanKematian.";".$kecamatanKematian.";".$kabupatenKotaKematian.";".$provinsiKematian.";".$tanggalKematian.";".$jamKematian.";".$waktuKematian.";".$sebabKematian.";".$pengabarKematian.";".$aktaKematian.";".$nomorAktaKematian.";".$tanggalAktaKematian,
                              'dataPelapor' => $NIKPelapor.";".$namaPelapor.";".$hubunganYangMeninggal.";".$tanggalLahirPelapor.";".$jenisKelaminPelapor.";".$pekerjaanPelapor.";".$alamatPelapor.";".$desaKelurahanPelapor.";".$kecamatanPelapor.";".$kabupatenKotaPelapor.";".$provinsiPelapor,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f13_surat_kematian' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f13_surat_kematian",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan kematian (A-5)",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f13_surat_kematian()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');

        //data orang meninggal
        $jenisKelamin = $this->input->post('jenisKelamin'); 
        $tempatLahir = $this->input->post('tempatLahir'); 
        $tanggalLahir = $this->input->post('tanggalLahir'); 
        $anakKe = $this->input->post('anakKe'); 
        $kewarganegaraan = $this->input->post('kewarganegaraan'); 
        $agama = $this->input->post('agama'); 
        $statusPerkawinan = $this->input->post('statusPerkawinan'); 
        $pekerjaan = $this->input->post('pekerjaan'); 
        $alamat = $this->input->post('alamat'); 
        $desaKelurahan = $this->input->post('desaKelurahan'); 
        $kecamatan = $this->input->post('kecamatan'); 
        $kabupatenKota = $this->input->post('kabupatenKota'); 
        $provinsi = $this->input->post('provinsi'); 
        $namaKepalaSebenarnya = $this->input->post('namaKepalaSebenarnya');

        //data kematian 
        $tempatKematian = $this->input->post('tempatKematian'); 
        $desaKelurahanKematian = $this->input->post('desaKelurahanKematian'); 
        $kecamatanKematian = $this->input->post('kecamatanKematian'); 
        $kabupatenKotaKematian = $this->input->post('kabupatenKotaKematian'); 
        $provinsiKematian = $this->input->post('provinsiKematian'); 
        $tanggalKematian = $this->input->post('tanggalKematian'); 
        $jamKematian = $this->input->post('jamKematian'); 
        $waktuKematian = $this->input->post('waktuKematian'); 
        $sebabKematian = $this->input->post('sebabKematian'); 
        $pengabarKematian = $this->input->post('pengabarKematian'); 
        $aktaKematian = $this->input->post('aktaKematian'); 
        $nomorAktaKematian = $this->input->post('nomorAktaKematian'); 
        $tanggalAktaKematian = $this->input->post('tanggalAktaKematian');  

        //data pelapor
        $NIKPelapor = $this->input->post('NIKPelapor'); 
        $namaPelapor = $this->input->post('namaPelapor'); 
        $hubunganYangMeninggal = $this->input->post('hubunganYangMeninggal'); 
        $tanggalLahirPelapor = $this->input->post('tanggalLahirPelapor'); 
        $jenisKelaminPelapor = $this->input->post('jenisKelaminPelapor'); 
        $pekerjaanPelapor = $this->input->post('pekerjaanPelapor'); 
        $alamatPelapor = $this->input->post('alamatPelapor'); 
        $desaKelurahanPelapor = $this->input->post('desaKelurahanPelapor'); 
        $kecamatanPelapor = $this->input->post('kecamatanPelapor'); 
        $kabupatenKotaPelapor = $this->input->post('kabupatenKotaPelapor'); 
        $provinsiPelapor = $this->input->post('provinsiPelapor');

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'randomCode' => $randomCode,
                              'dataOrangMeninggal' => $jenisKelamin.";".$tempatLahir.";".$tanggalLahir.";".$anakKe.";".$kewarganegaraan.";".$agama.";".$statusPerkawinan.";".$pekerjaan.";".$alamat.";".$desaKelurahan.";".$kecamatan.";".$kabupatenKota.";".$provinsi.";".$namaKepalaSebenarnya,
                              'dataKematian' => $tempatKematian.";".$desaKelurahanKematian.";".$kecamatanKematian.";".$kabupatenKotaKematian.";".$provinsiKematian.";".$tanggalKematian.";".$jamKematian.";".$waktuKematian.";".$sebabKematian.";".$pengabarKematian.";".$aktaKematian.";".$nomorAktaKematian.";".$tanggalAktaKematian,
                              'dataPelapor' => $NIKPelapor.";".$namaPelapor.";".$hubunganYangMeninggal.";".$tanggalLahirPelapor.";".$jenisKelaminPelapor.";".$pekerjaanPelapor.";".$alamatPelapor.";".$desaKelurahanPelapor.";".$kecamatanPelapor.";".$kabupatenKotaPelapor.";".$provinsiPelapor,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f13_surat_kematian' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f13_surat_kematian()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f13_surat_kematian' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F13()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F13()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        //tambahan
        $tempatLahir;
        $tanggalLahir;
        $jenisKelamin;
        $pekerjaan;
        $agama;
        $pendidikan;
        $alamat;
        $kewarganegaraan;
        $statusPerkawinan;
        $kepalaKeluarga;
        $anakKe;
        $no=0;
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
            $no=0;
            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $tempatLahir = $row->tempatLahir;
            $tanggalLahir = $row->tanggalLahir;
            $jenisKelamin = $row->jenisKelamin;
            $pekerjaan = $row->pekerjaan;
            $agama = $row->agama;
            $pendidikan = $row->pendidikanTerakhir;
            $alamat = $row->alamatLengkap;
            $kewarganegaraan = $row->kewarganegaraan;
            $statusPerkawinan = $row->statusPerkawinan;
            $anakke = explode(";", $row->kelahiran);
            $anakKe = $anakke[3];

            $selectkepala = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.nomorKK='$noKK' AND penduduk.kedudukanDalamKeluarga='KEPALA KELUARGA'");
            foreach ($selectkepala->result() as $key) {
                
                $kepalaKeluarga = $key->namaLengkap;
            }

            // $selectnomor = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.nomorKK='$noKK' AND penduduk.kedudukanDalamKeluarga='ANAK' ORDER by penduduk.tanggalLahir ASC");
            // foreach ($selectnomor->result() as $key){
            //    if ($key->NIK == $row->NIK) {
            //        $no = $no+1;
            //    }
            // }

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['tempatLahir'] = $tempatLahir;
        $hasil['tanggalLahir'] = $tanggalLahir;
        $hasil['jenisKelamin'] = $jenisKelamin;
        $hasil['agama'] = $agama;
        $hasil['pendidikan'] = $pendidikan;
        $hasil['pekerjaan'] = $pekerjaan;
        $hasil['alamatLengkap'] = ucwords(strtolower($alamat));
        $hasil['kewarganegaraan'] = $kewarganegaraan;
        $hasil['statusPerkawinan'] = $statusPerkawinan;
        $hasil['kepalaKeluarga'] = $kepalaKeluarga;
        $hasil['anakKe'] = $anakKe;
        // $hasil['urutanDalamKeluarga'] = $no;
        echo json_encode($hasil);

    }




    public function showTable_F13()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f13_surat_kematian,penduduk", "WHERE f13_surat_kematian.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f13_surat_kematian,penduduk", "WHERE f13_surat_kematian.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f13_surat_kematian";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $dataKematian = explode(";", $row->dataKematian);

                        $tgl = $dataKematian[5]; 
                        setlocale(LC_ALL, 'IND');

                        $bulan = date('m', strtotime($tgl));
                        if($bulan=='01'){
                            $bulan='Januari';
                        }else if($bulan=='02'){
                            $bulan='Februari';
                        }else if($bulan=='03'){
                            $bulan='Maret';
                        }else if($bulan=='04'){
                            $bulan='April';
                        }else if($bulan=='05'){
                            $bulan='Mei';
                        }else if($bulan=='06'){
                            $bulan='Juni';
                        }else if($bulan=='07'){
                            $bulan='Juli';
                        }else if($bulan=='08'){
                            $bulan='Agustus';
                        }else if($bulan=='09'){
                            $bulan='September';
                        }else if($bulan=='10'){
                            $bulan='Oktober';
                        }else if($bulan=='11'){
                            $bulan='November';
                        }else if($bulan=='12'){
                            $bulan='Desember';
                        }
            // $selectAllShopDataAyah = $this->Home_model->getSelectData("*","penduduk", "WHERE  penduduk.NIK=$dataAyahGet");

            // $namaayah = "";
            // foreach ($selectAllShopDataAyah->result() as $rowx) {
            //     $namaayah = $rowx->namaLengkap;
            // }

            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                strftime('%d'." $bulan ".'%Y', strtotime($tgl)).' '.$dataKematian[6].' '.$dataKematian[7],
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <i class="icofont icofont-printer"></i> Cetak
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light" onclick="cetak_f13_surat_kematian_utama(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Utama</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light" onclick="cetak_f13_surat_kematian_sk(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> SK</button>
                                        </div>
                                      </div>

                                      <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f13_surat_kematian('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\',\''.$row->nomorKK.'\',\''.$row->nama.'\',\''.$row->dataOrangMeninggal.'\',\''.$row->dataKematian.'\',\''.$row->dataPelapor.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f13_surat_kematian('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>
                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F13()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f13'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f13_surat_kematian", "WHERE f13_surat_kematian.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['showDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif' LIMIT 1");


                $this->load->view('adminPage/f13_surat_kematian/print/print_page_utama' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }


    public function printForm_F13_SK()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f13'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f13_surat_kematian", "WHERE f13_surat_kematian.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['showDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif' LIMIT 1");

                $data['showKetKematian'] = $this->Home_model->getSelectData("*","f12_surat_keterangan_kematian", "WHERE f12_surat_keterangan_kematian.NIK=$NIK");



                
                $this->load->view('adminPage/f13_surat_kematian/print/print_page_sk' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }




    //---------------------Kematian - Surat Keterangan Penguburan - (F14) --------------------------------


    public function f14_surat_keterangan_penguburan()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f14_surat_keterangan_penguburan";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f14_surat_keterangan_penguburan/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }
    public function f14_surat_keterangan_penguburan_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f14_surat_keterangan_penguburan/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f14_surat_keterangan_penguburan()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $pekerjaan = $this->input->post('pekerjaan');
        $alamat = $this->input->post('alamat');
        $tanggalMati = $this->input->post('tanggalMati');
        $tanggalDikuburkan = $this->input->post('tanggalDikuburkan');
        $alamatDikuburkan = $this->input->post('alamatDikuburkan');
        $namaPengubur = $this->input->post('namaPengubur');
        $pekerjaanPengubur = $this->input->post('pekerjaanPengubur');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f14",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'tempatLahir' => $tempatLahir,
                              'tanggalLahir' => $tanggalLahir,
                              'jenisKelamin' => $jenisKelamin,
                              'pekerjaan' => $pekerjaan,
                              'alamat' => $alamat,
                              'tanggalKematian' => $tanggalMati,
                              'tanggalDikuburkan' => $tanggalDikuburkan,
                              'alamatDikuburkan' => $alamatDikuburkan,
                              'namaPengubur' => $namaPengubur,
                              'pekerjaanPengubur' => $pekerjaanPengubur,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f14_surat_keterangan_penguburan' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f14_surat_keterangan_penguburan_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $pekerjaan = $this->input->post('pekerjaan');
        $alamat = $this->input->post('alamat');
        $tanggalMati = $this->input->post('tanggalMati');
        $tanggalDikuburkan = $this->input->post('tanggalDikuburkan');
        $alamatDikuburkan = $this->input->post('alamatDikuburkan');
        $namaPengubur = $this->input->post('namaPengubur');
        $pekerjaanPengubur = $this->input->post('pekerjaanPengubur');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f14",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'tempatLahir' => $tempatLahir,
                              'tanggalLahir' => $tanggalLahir,
                              'jenisKelamin' => $jenisKelamin,
                              'pekerjaan' => $pekerjaan,
                              'alamat' => $alamat,
                              'tanggalKematian' => $tanggalMati,
                              'tanggalDikuburkan' => $tanggalDikuburkan,
                              'alamatDikuburkan' => $alamatDikuburkan,
                              'namaPengubur' => $namaPengubur,
                              'pekerjaanPengubur' => $pekerjaanPengubur,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f14_surat_keterangan_penguburan' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f14_surat_keterangan_penguburan",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan penguburan",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }



    public function update_f14_surat_keterangan_penguburan()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $pekerjaan = $this->input->post('pekerjaan');
        $alamat = $this->input->post('alamat');
        $tanggalMati = $this->input->post('tanggalMati');
        $tanggalDikuburkan = $this->input->post('tanggalDikuburkan');
        $alamatDikuburkan = $this->input->post('alamatDikuburkan');
        $namaPengubur = $this->input->post('namaPengubur');
        $pekerjaanPengubur = $this->input->post('pekerjaanPengubur');
        $randomCode = $this->input->post('randomCode');
       
       
                        $dataInput = array(
                              'kode_formulir' => "f14",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'tempatLahir' => $tempatLahir,
                              'tanggalLahir' => $tanggalLahir,
                              'jenisKelamin' => $jenisKelamin,
                              'pekerjaan' => $pekerjaan,
                              'alamat' => $alamat,
                              'tanggalKematian' => $tanggalMati,
                              'tanggalDikuburkan' => $tanggalDikuburkan,
                              'alamatDikuburkan' => $alamatDikuburkan,
                              'namaPengubur' => $namaPengubur,
                              'pekerjaanPengubur' => $pekerjaanPengubur,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f14_surat_keterangan_penguburan' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f14_surat_keterangan_penguburan()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f14_surat_keterangan_penguburan' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F14()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F14()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $tempatLahir;
        $tanggalLahir;
        $jenisKelamin;
        $pekerjaan;
        $alamatLengkap;       
        $selectAllShop = $this->Home_model->getSelectData("*,UPPER(pekerjaan) pekT, LOWER(alamatLengkap)alamatL","penduduk", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $tempatLahir = $row->tempatLahir;
            $tanggalLahir = $row->tanggalLahir;
            $jenisKelamin = $row->jenisKelamin;
            $alamatLengkap = $row->alamatL;
            $pekerjaan = $row->pekT;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['tempatLahir'] = $tempatLahir;
        $hasil['tanggalLahir'] = $tanggalLahir;
        $hasil['jenisKelamin'] = $jenisKelamin;
        $hasil['pekerjaan'] = $pekerjaan;
        $hasil['alamatLengkap'] = $alamatLengkap;
        echo json_encode($hasil);

    }



    public function showDataUpdate_F14()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $tempatLahir;
        $tanggalLahir;
        $jenisKelamin;
        $pekerjaan;
        $alamat;
        $tanggalKematian;
        $tanggalDikuburkan;
        $alamatDikuburkan;
        $namaPengubur;
        $pekerjaanPengubur;
        $selectAllShop = $this->Home_model->getSelectData("*","f14_surat_keterangan_penguburan", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $tempatLahir = $row->tempatLahir;
            $tanggalLahir = $row->tanggalLahir;
            $jenisKelamin = $row->jenisKelamin;
            $alamat = $row->alamat;
            $pekerjaan = $row->pekerjaan;
            $tanggalKematian = $row->tanggalKematian;
            $tanggalDikuburkan = $row->tanggalDikuburkan;
            $alamatDikuburkan = $row->alamatDikuburkan;
            $namaPengubur = $row->namaPengubur;
            $pekerjaanPengubur = $row->pekerjaanPengubur;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['tempatLahir'] = $tempatLahir;
        $hasil['tanggalLahir'] = $tanggalLahir;
        $hasil['jenisKelamin'] = $jenisKelamin;
        $hasil['pekerjaan'] = $pekerjaan;
        $hasil['alamat'] = $alamat;
        $hasil['tanggalKematian'] = $tanggalKematian;
        $hasil['tanggalDikuburkan'] = $tanggalDikuburkan;
        $hasil['alamatDikuburkan'] = $alamatDikuburkan;
        $hasil['namaPengubur'] = $namaPengubur;
        $hasil['pekerjaanPengubur'] = $pekerjaanPengubur;
        echo json_encode($hasil);

    }



    public function showTable_F14()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f14_surat_keterangan_penguburan,penduduk", "WHERE f14_surat_keterangan_penguburan.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f14_surat_keterangan_penguburan,penduduk", "WHERE f14_surat_keterangan_penguburan.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f14_surat_keterangan_penguburan";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                $row->namaPengubur,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f14_surat_keterangan_penguburan(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f14_surat_keterangan_penguburan('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f14_surat_keterangan_penguburan('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F14()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f14'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*,DATE_FORMAT(f14_surat_keterangan_penguburan.tanggalLahir, '%d-%m-%Y'),LOWER(pekerjaan)pekerjaan","f14_surat_keterangan_penguburan", "WHERE f14_surat_keterangan_penguburan.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");


                
                $this->load->view('adminPage/f14_surat_keterangan_penguburan/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }

    //----------------Pelayanan Administrasi Nikah - Surat Pengantar Nikah - (F1 - F6) --------------
    public function f15_surat_keterangan_pengantar_nikah()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
            $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f15_surat_keterangan_pengantar_nikah";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f15_surat_keterangan_pengantar_nikah/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f15_surat_keterangan_pengantar_nikah_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f15_surat_keterangan_pengantar_nikah/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }

    public function add_f15_surat_keterangan_pengantar_nikah()
    {
        
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('nama');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $agama = $this->input->post('agama');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $pekerjaan = $this->input->post('pekerjaan');
        $kewarganegaraan = $this->input->post('kewarganegaraan');
        $statusPerkawinan = $this->input->post('statusPerkawinan');
        $binbinti = $this->input->post('binbinti');
        $dusunSekarang = $this->input->post('dusunSekarang');
        
        $NIKAyah = $this->input->post('NIKAyah');
        $namaAyah = $this->input->post('namaAyah');
        $tanggalLahirAyah = $this->input->post('tanggalLahirAyah');
        $pekerjaanAyah = $this->input->post('pekerjaanAyah');
        $tempatLahirAyah = $this->input->post('tempatLahirAyah');
        $kewarganegaraanAyah = $this->input->post('kewarganegaraanAyah');
        $agamaAyah = $this->input->post('agamaAyah');
        $alamatAyah = $this->input->post('alamatAyah');

        $NIKIbu = $this->input->post('NIKIbu');
        $namaIbu = $this->input->post('namaIbu');
        $tanggalLahirIbu = $this->input->post('tanggalLahirIbu');
        $pekerjaanIbu = $this->input->post('pekerjaanIbu');
        $tempatLahirIbu = $this->input->post('tempatLahirIbu');
        $kewarganegaraanIbu = $this->input->post('kewarganegaraanIbu');
        $agamaIbu = $this->input->post('agamaIbu');
        $alamatIbu = $this->input->post('alamatIbu');

        $NIKCalon = $this->input->post('NIKCalon');
        $namaCalon = $this->input->post('namaCalon');
        $tanggalLahirCalon = $this->input->post('tanggalLahirCalon');
        $pekerjaanCalon = $this->input->post('pekerjaanCalon');
        $tempatLahirCalon = $this->input->post('tempatLahirCalon');
        $kewarganegaraanCalon = $this->input->post('kewarganegaraanCalon');
        $agamaCalon = $this->input->post('agamaCalon');
        $binbintiCalon = $this->input->post('binbintiCalon');
        $alamatCalon = $this->input->post('alamatCalon');
        
        $tanggalAkad = $this->input->post('tanggalAkad');
        $tanggalResepsi = $this->input->post('tanggalResepsi');

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f15",
                              'nomorSurat' => $noSurat,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'dataPelamar' => $tempatLahir.";".$tanggalLahir.";".$jenisKelamin.";".$pekerjaan.";".$kewarganegaraan.";".$statusPerkawinan.";".$binbinti.";".$dusunSekarang.";".$agama,
                              'dataAyah' => $NIKAyah.";".$namaAyah.";".$tanggalLahirAyah.";".$pekerjaanAyah.";".$tempatLahirAyah.";".$kewarganegaraanAyah.";".$agamaAyah.";".$alamatAyah,
                              'dataIbu' => $NIKIbu.";".$namaIbu.";".$tanggalLahirIbu.";".$pekerjaanIbu.";".$tempatLahirIbu.";".$kewarganegaraanIbu.";".$agamaIbu.";".$alamatIbu,
                              'dataCalon' => $NIKCalon.";".$namaCalon.";".$tanggalLahirCalon.";".$pekerjaanCalon.";".$tempatLahirCalon.";".$kewarganegaraanCalon.";".$agamaCalon.";".$binbintiCalon.";".$alamatCalon,
                              'dataLainnya' => $tanggalAkad.";".$tanggalResepsi,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f15_surat_keterangan_pengantar_nikah' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f15_surat_keterangan_pengantar_nikah_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('nama');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $agama = $this->input->post('agama');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $pekerjaan = $this->input->post('pekerjaan');
        $kewarganegaraan = $this->input->post('kewarganegaraan');
        $statusPerkawinan = $this->input->post('statusPerkawinan');
        $binbinti = $this->input->post('binbinti');
        $dusunSekarang = $this->input->post('dusunSekarang');
        
        $NIKAyah = $this->input->post('NIKAyah');
        $namaAyah = $this->input->post('namaAyah');
        $tanggalLahirAyah = $this->input->post('tanggalLahirAyah');
        $pekerjaanAyah = $this->input->post('pekerjaanAyah');
        $tempatLahirAyah = $this->input->post('tempatLahirAyah');
        $kewarganegaraanAyah = $this->input->post('kewarganegaraanAyah');
        $agamaAyah = $this->input->post('agamaAyah');
        $alamatAyah = $this->input->post('alamatAyah');

        $NIKIbu = $this->input->post('NIKIbu');
        $namaIbu = $this->input->post('namaIbu');
        $tanggalLahirIbu = $this->input->post('tanggalLahirIbu');
        $pekerjaanIbu = $this->input->post('pekerjaanIbu');
        $tempatLahirIbu = $this->input->post('tempatLahirIbu');
        $kewarganegaraanIbu = $this->input->post('kewarganegaraanIbu');
        $agamaIbu = $this->input->post('agamaIbu');
        $alamatIbu = $this->input->post('alamatIbu');

        $NIKCalon = $this->input->post('NIKCalon');
        $namaCalon = $this->input->post('namaCalon');
        $tanggalLahirCalon = $this->input->post('tanggalLahirCalon');
        $pekerjaanCalon = $this->input->post('pekerjaanCalon');
        $tempatLahirCalon = $this->input->post('tempatLahirCalon');
        $kewarganegaraanCalon = $this->input->post('kewarganegaraanCalon');
        $agamaCalon = $this->input->post('agamaCalon');
        $binbintiCalon = $this->input->post('binbintiCalon');
        $alamatCalon = $this->input->post('alamatCalon');
        
        $tanggalAkad = $this->input->post('tanggalAkad');
        $tanggalResepsi = $this->input->post('tanggalResepsi');

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f15",
                              'nomorSurat' => $noSurat,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'dataPelamar' => $tempatLahir.";".$tanggalLahir.";".$jenisKelamin.";".$pekerjaan.";".$kewarganegaraan.";".$statusPerkawinan.";".$binbinti.";".$dusunSekarang.";".$agama,
                              'dataAyah' => $NIKAyah.";".$namaAyah.";".$tanggalLahirAyah.";".$pekerjaanAyah.";".$tempatLahirAyah.";".$kewarganegaraanAyah.";".$agamaAyah.";".$alamatAyah,
                              'dataIbu' => $NIKIbu.";".$namaIbu.";".$tanggalLahirIbu.";".$pekerjaanIbu.";".$tempatLahirIbu.";".$kewarganegaraanIbu.";".$agamaIbu.";".$alamatIbu,
                              'dataCalon' => $NIKCalon.";".$namaCalon.";".$tanggalLahirCalon.";".$pekerjaanCalon.";".$tempatLahirCalon.";".$kewarganegaraanCalon.";".$agamaCalon.";".$binbintiCalon.";".$alamatCalon,
                              'dataLainnya' => $tanggalAkad.";".$tanggalResepsi,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f15_surat_keterangan_pengantar_nikah' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f15_surat_keterangan_pengantar_nikah",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan pengantar nikah",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }

    public function showTable_F15()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f15_surat_keterangan_pengantar_nikah,penduduk", "WHERE f15_surat_keterangan_pengantar_nikah.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f15_surat_keterangan_pengantar_nikah,penduduk", "WHERE f15_surat_keterangan_pengantar_nikah.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f15_surat_keterangan_pengantar_nikah";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
            
            $var = $row->dataCalon;
            $varParsed = explode(";", $var);

            $var2 = $row->dataLainnya;
            $var2Parsed = explode(";", $var2);
            
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                $varParsed[1],
                $var2Parsed[0],
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-mat btn-sm" style="margin-top:5px;" onclick="cetak_f15_surat_keterangan_pengantar_nikah(\''.$row->randomCode.'\',\''.$row->NIK.'\')"> N1</button>
                                        <button type="button" class="btn btn-info btn-mat btn-sm"  style="margin-top:5px;" onclick="cetak_f15_surat_keterangan_pengantar_nikah_2(\''.$row->randomCode.'\',\''.$row->NIK.'\')"> N2</button><br/>
                                        <button type="button" class="btn btn-danger btn-mat btn-sm"  style="margin-top:5px;" onclick="cetak_f15_surat_keterangan_pengantar_nikah_3(\''.$row->randomCode.'\',\''.$row->NIK.'\')"> N3</button>
                                        <button type="button" class="btn btn-warning btn-mat btn-sm"  style="margin-top:5px;" onclick="cetak_f15_surat_keterangan_pengantar_nikah_4(\''.$row->randomCode.'\',\''.$row->NIK.'\')"> N4</button><br/>
                                        <button type="button" class="btn btn-inverse btn-mat btn-sm"  style="margin-top:5px;" onclick="cetak_f15_surat_keterangan_pengantar_nikah_5(\''.$row->randomCode.'\',\''.$row->NIK.'\')"> N5</button>
                                        
                                        <button type="button" class="btn btn-secondary btn-mat dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true"  style="margin-top:5px;" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f15_surat_keterangan_pengantar_nikah('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\',\''.$row->dataPelamar.'\',\''.$row->dataAyah.'\',\''.$row->dataIbu.'\',\''.$row->dataCalon.'\',\''.$row->nama.'\',\''.$row->dataLainnya.'\',\''.$row->randomCode.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f15_surat_keterangan_pengantar_nikah('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

    public function delete_f15_surat_keterangan_pengantar_nikah()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f15_surat_keterangan_pengantar_nikah' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }

    public function update_f15_surat_keterangan_pengantar_nikah()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('nama');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $agama = $this->input->post('agama');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $pekerjaan = $this->input->post('pekerjaan');
        $kewarganegaraan = $this->input->post('kewarganegaraan');
        $statusPerkawinan = $this->input->post('statusPerkawinan');
        $binbinti = $this->input->post('binbinti');
        $dusunSekarang = $this->input->post('dusunSekarang');
        
        $NIKAyah = $this->input->post('NIKAyah');
        $namaAyah = $this->input->post('namaAyah');
        $tanggalLahirAyah = $this->input->post('tanggalLahirAyah');
        $pekerjaanAyah = $this->input->post('pekerjaanAyah');
        $tempatLahirAyah = $this->input->post('tempatLahirAyah');
        $kewarganegaraanAyah = $this->input->post('kewarganegaraanAyah');
        $agamaAyah = $this->input->post('agamaAyah');
        $alamatAyah = $this->input->post('alamatAyah');

        $NIKIbu = $this->input->post('NIKIbu');
        $namaIbu = $this->input->post('namaIbu');
        $tanggalLahirIbu = $this->input->post('tanggalLahirIbu');
        $pekerjaanIbu = $this->input->post('pekerjaanIbu');
        $tempatLahirIbu = $this->input->post('tempatLahirIbu');
        $kewarganegaraanIbu = $this->input->post('kewarganegaraanIbu');
        $agamaIbu = $this->input->post('agamaIbu');
        $alamatIbu = $this->input->post('alamatIbu');

        $NIKCalon = $this->input->post('NIKCalon');
        $namaCalon = $this->input->post('namaCalon');
        $tanggalLahirCalon = $this->input->post('tanggalLahirCalon');
        $pekerjaanCalon = $this->input->post('pekerjaanCalon');
        $tempatLahirCalon = $this->input->post('tempatLahirCalon');
        $kewarganegaraanCalon = $this->input->post('kewarganegaraanCalon');
        $agamaCalon = $this->input->post('agamaCalon');
        $binbintiCalon = $this->input->post('binbintiCalon');
        $alamatCalon = $this->input->post('alamatCalon');
        
        $tanggalAkad = $this->input->post('tanggalAkad');
        $tanggalResepsi = $this->input->post('tanggalResepsi');

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f15",
                              'nomorSurat' => $noSurat,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'dataPelamar' => $tempatLahir.";".$tanggalLahir.";".$jenisKelamin.";".$pekerjaan.";".$kewarganegaraan.";".$statusPerkawinan.";".$binbinti.";".$dusunSekarang.";".$agama,
                              'dataAyah' => $NIKAyah.";".$namaAyah.";".$tanggalLahirAyah.";".$pekerjaanAyah.";".$tempatLahirAyah.";".$kewarganegaraanAyah.";".$agamaAyah.";".$alamatAyah,
                              'dataIbu' => $NIKIbu.";".$namaIbu.";".$tanggalLahirIbu.";".$pekerjaanIbu.";".$tempatLahirIbu.";".$kewarganegaraanIbu.";".$agamaIbu.";".$alamatIbu,
                              'dataCalon' => $NIKCalon.";".$namaCalon.";".$tanggalLahirCalon.";".$pekerjaanCalon.";".$tempatLahirCalon.";".$kewarganegaraanCalon.";".$agamaCalon.";".$binbintiCalon.";".$alamatCalon,
                              'dataLainnya' => $tanggalAkad.";".$tanggalResepsi,
                              'status' => "aktif",
                              
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f15_surat_keterangan_pengantar_nikah' , $dataInput,"id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }




    //----------------Pelayanan Administrasi Nikah - Surat Keterangan Pernah Nikah - (F16) --------------


    public function f16_surat_keterangan_pernah_nikah()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f16_surat_keterangan_pernah_nikah";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f16_surat_keterangan_pernah_nikah/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f16_surat_keterangan_pernah_nikah_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f16_surat_keterangan_pernah_nikah/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f16_surat_keterangan_pernah_nikah()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $NIKIstri = $this->input->post('NIKIstri');
        $namaIstri = $this->input->post('namaIstri');
        $aktaPerkawinan = $this->input->post('aktaPerkawinan');
        $nomorAktaPerkawinan = $this->input->post('nomorAktaPerkawinan');
        $tanggalPerkawinan = $this->input->post('tanggalPerkawinan');
        $lokasiPerkawinan = $this->input->post('lokasiPerkawinan');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f16",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'NIKIstri' => $NIKIstri,
                              'namaIstri' => $namaIstri,
                              'aktaPerkawinan' => $aktaPerkawinan,
                              'nomorAktaPerkawinan' => $nomorAktaPerkawinan,
                              'tanggalPerkawinan' => $tanggalPerkawinan,
                              'lokasiPerkawinan' => $lokasiPerkawinan,
                              'keperluan' => $keperluan,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f16_surat_keterangan_pernah_nikah' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f16_surat_keterangan_pernah_nikah_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $NIKIstri = $this->input->post('NIKIstri');
        $namaIstri = $this->input->post('namaIstri');
        $aktaPerkawinan = $this->input->post('aktaPerkawinan');
        $nomorAktaPerkawinan = $this->input->post('nomorAktaPerkawinan');
        $tanggalPerkawinan = $this->input->post('tanggalPerkawinan');
        $lokasiPerkawinan = $this->input->post('lokasiPerkawinan');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f16",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'NIKIstri' => $NIKIstri,
                              'namaIstri' => $namaIstri,
                              'aktaPerkawinan' => $aktaPerkawinan,
                              'nomorAktaPerkawinan' => $nomorAktaPerkawinan,
                              'tanggalPerkawinan' => $tanggalPerkawinan,
                              'lokasiPerkawinan' => $lokasiPerkawinan,
                              'keperluan' => $keperluan,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f16_surat_keterangan_pernah_nikah' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f16_surat_keterangan_pernah_nikah",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan pernah nikah",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f16_surat_keterangan_pernah_nikah()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $NIKIstri = $this->input->post('NIKIstri');
        $namaIstri = $this->input->post('namaIstri');
        $aktaPerkawinan = $this->input->post('aktaPerkawinan');
        $nomorAktaPerkawinan = $this->input->post('nomorAktaPerkawinan');
        $tanggalPerkawinan = $this->input->post('tanggalPerkawinan');
        $lokasiPerkawinan = $this->input->post('lokasiPerkawinan');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f16",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'NIKIstri' => $NIKIstri,
                              'namaIstri' => $namaIstri,
                              'aktaPerkawinan' => $aktaPerkawinan,
                              'nomorAktaPerkawinan' => $nomorAktaPerkawinan,
                              'tanggalPerkawinan' => $tanggalPerkawinan,
                              'lokasiPerkawinan' => $lokasiPerkawinan,
                              'keperluan' => $keperluan,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f16_surat_keterangan_pernah_nikah' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f16_surat_keterangan_pernah_nikah()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f16_surat_keterangan_pernah_nikah' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F16()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F16()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $NIKIstri;
        $namaIstri;
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;
            $namaIstri = $row->namaLengkap;
            $NIKIstri = $row->NIK;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        $hasil['NIKIstri'] = $NIKIstri;
        $hasil['namaIstri'] = $namaIstri;
        echo json_encode($hasil);

    }


    public function showDataUpdate_F16()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $NIKIstri;
        $namaIstri;
        $aktaPerkawinan;
        $nomorAktaPerkawinan;
        $tanggalPerkawinan;
        $lokasiPerkawinan;
        $keperluan;     
        $selectAllShop = $this->Home_model->getSelectData("*","f16_surat_keterangan_pernah_nikah", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $NIKIstri = $row->NIKIstri;
            $namaIstri = $row->namaIstri;
            $aktaPerkawinan = $row->aktaPerkawinan;
            $nomorAktaPerkawinan = $row->nomorAktaPerkawinan;
            $tanggalPerkawinan = $row->tanggalPerkawinan;
            $lokasiPerkawinan = $row->lokasiPerkawinan;
            $keperluan = $row->keperluan;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['NIKIstri'] = $NIKIstri;
        $hasil['namaIstri'] = $namaIstri;
        $hasil['aktaPerkawinan'] = $aktaPerkawinan;
        $hasil['nomorAktaPerkawinan'] = $nomorAktaPerkawinan;
        $hasil['tanggalPerkawinan'] = $tanggalPerkawinan;
        $hasil['lokasiPerkawinan'] = $lokasiPerkawinan;
        $hasil['keperluan'] = $keperluan;
        echo json_encode($hasil);

    }



    public function showTable_F16()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f16_surat_keterangan_pernah_nikah,penduduk", "WHERE f16_surat_keterangan_pernah_nikah.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f16_surat_keterangan_pernah_nikah,penduduk", "WHERE f16_surat_keterangan_pernah_nikah.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f16_surat_keterangan_pernah_nikah";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }


            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                $row->namaIstri,
                $row->tanggalPerkawinan,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f16_surat_keterangan_pernah_nikah(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f16_surat_keterangan_pernah_nikah('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f16_surat_keterangan_pernah_nikah('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F16()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f16'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f16_surat_keterangan_pernah_nikah", "WHERE f16_surat_keterangan_pernah_nikah.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                    $NIKO = $row->NIKIstri;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['showDataIstri'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIKO");


                
                $this->load->view('adminPage/f16_surat_keterangan_pernah_nikah/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }




    //----------------Pelayanan Administrasi Nikah - Surat Keterangan Belum Pernah Nikah - (F17) --------------


    public function f17_surat_keterangan_belumpernahnikah()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f17_surat_keterangan_belumpernahnikah";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f17_surat_keterangan_belumpernahnikah/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }
    public function f17_surat_keterangan_belumpernahnikah_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f17_surat_keterangan_belumpernahnikah/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }



    public function add_f17_surat_keterangan_belumpernahnikah()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $namaOrangTua = $this->input->post('namaOrangTua');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f17",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'namaOrangTua' => $namaOrangTua,
                              'keperluan' => $keperluan,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f17_surat_keterangan_belumpernahnikah' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f17_surat_keterangan_belumpernahnikah_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $namaOrangTua = $this->input->post('namaOrangTua');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f17",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'namaOrangTua' => $namaOrangTua,
                              'keperluan' => $keperluan,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f17_surat_keterangan_belumpernahnikah' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f17_surat_keterangan_belumpernahnikah",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan belum pernah nikah",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f17_surat_keterangan_belumpernahnikah()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $namaOrangTua = $this->input->post('namaOrangTua');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f17",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'namaOrangTua' => $namaOrangTua,
                              'keperluan' => $keperluan,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f17_surat_keterangan_belumpernahnikah' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f17_surat_keterangan_belumpernahnikah()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f17_surat_keterangan_belumpernahnikah' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F17()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F17()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $namaOrangTua;
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk,penduduk_orangtua", "WHERE penduduk.NIK='$keyword' AND penduduk.NIK=penduduk_orangtua.NIK");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;
            $namaOrangTua = $row->namaAyah;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        $hasil['namaOrangTua'] = $namaOrangTua;
        echo json_encode($hasil);

    }


    public function showDataUpdate_F17()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $namaOrangTua;
        $keperluan;     
        $selectAllShop = $this->Home_model->getSelectData("*","f17_surat_keterangan_belumpernahnikah", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $namaOrangTua = $row->namaOrangTua;
            $keperluan = $row->keperluan;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['namaOrangTua'] = $namaOrangTua;
        $hasil['keperluan'] = $keperluan;
        echo json_encode($hasil);

    }



    public function showTable_F17()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f17_surat_keterangan_belumpernahnikah,penduduk", "WHERE f17_surat_keterangan_belumpernahnikah.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f17_surat_keterangan_belumpernahnikah,penduduk", "WHERE f17_surat_keterangan_belumpernahnikah.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f17_surat_keterangan_belumpernahnikah";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                $row->namaOrangTua,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f17_surat_keterangan_belumpernahnikah(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f17_surat_keterangan_belumpernahnikah('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f17_surat_keterangan_belumpernahnikah('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F17()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f17'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f17_surat_keterangan_belumpernahnikah", "WHERE f17_surat_keterangan_belumpernahnikah.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");


                
                $this->load->view('adminPage/f17_surat_keterangan_belumpernahnikah/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }




    //----------------Pelayanan Administrasi Nikah - Surat Keterangan Duda / Janda - (F18) --------------


    public function f18_surat_keterangan_dudajanda()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f18_surat_keterangan_dudajanda";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f18_surat_keterangan_dudajanda/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f18_surat_keterangan_dudajanda_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f18_surat_keterangan_dudajanda/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f18_surat_keterangan_dudajanda()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $NIKPasanganTerdahulu = $this->input->post('NIKPasanganTerdahulu');
        $namaPasanganTerdahulu = $this->input->post('namaPasanganTerdahulu');
        $keperluan = $this->input->post('keperluan');
        $aktaPerkawinan = $this->input->post('aktaPerkawinan');
        $nomorAktaPerkawinan = $this->input->post('nomorAktaPerkawinan');
        $tanggalPerkawinan = $this->input->post('tanggalPerkawinan');
        $lokasiPerkawinan = $this->input->post('lokasiPerkawinan');
        $statusPerceraian = $this->input->post('statusPerceraian');
        $aktaPerceraian = $this->input->post('aktaPerceraian');
        $nomorAktaPerceraian = $this->input->post('nomorAktaPerceraian');
        $tanggalPerceraian = $this->input->post('tanggalPerceraian');
        $lokasiPerceraian = $this->input->post('lokasiPerceraian');
        $tanggalKematian = $this->input->post('tanggalKematian');
        $tempatKematian = $this->input->post('tempatKematian');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f18",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'NIKPasanganTerdahulu' => $NIKPasanganTerdahulu,
                              'namaPasanganTerdahulu' => $namaPasanganTerdahulu,
                              'keperluan' => $keperluan,
                              'aktaPerkawinan' => $aktaPerkawinan,
                              'nomorAktaPerkawinan' => $nomorAktaPerkawinan,
                              'tanggalPerkawinan' => $tanggalPerkawinan,
                              'lokasiPerkawinan' => $lokasiPerkawinan,
                              'statusPerceraian' => $statusPerceraian,
                              'aktaPerceraian' => $aktaPerceraian,
                              'nomorAktaPerceraian' => $nomorAktaPerceraian,
                              'tanggalPerceraian' => $tanggalPerceraian,
                              'lokasiPerceraian' => $lokasiPerceraian,
                              'tanggalKematian' => $tanggalKematian,
                              'tempatKematian' => $tempatKematian,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f18_surat_keterangan_dudajanda' , $dataInput);

                        $dataUpdate = array(
                            'statusPerkawinan' => $statusPerceraian,
                                
                            );
                        
                        $update = $this->Home_model->updateData('penduduk' , $dataUpdate," NIK=$NIKKepalaKeluarga");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f18_surat_keterangan_dudajanda_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $NIKPasanganTerdahulu = $this->input->post('NIKPasanganTerdahulu');
        $namaPasanganTerdahulu = $this->input->post('namaPasanganTerdahulu');
        $keperluan = $this->input->post('keperluan');
        $aktaPerkawinan = $this->input->post('aktaPerkawinan');
        $nomorAktaPerkawinan = $this->input->post('nomorAktaPerkawinan');
        $tanggalPerkawinan = $this->input->post('tanggalPerkawinan');
        $lokasiPerkawinan = $this->input->post('lokasiPerkawinan');
        $statusPerceraian = $this->input->post('statusPerceraian');
        $aktaPerceraian = $this->input->post('aktaPerceraian');
        $nomorAktaPerceraian = $this->input->post('nomorAktaPerceraian');
        $tanggalPerceraian = $this->input->post('tanggalPerceraian');
        $lokasiPerceraian = $this->input->post('lokasiPerceraian');
        $tanggalKematian = $this->input->post('tanggalKematian');
        $tempatKematian = $this->input->post('tempatKematian');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f18",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'NIKPasanganTerdahulu' => $NIKPasanganTerdahulu,
                              'namaPasanganTerdahulu' => $namaPasanganTerdahulu,
                              'keperluan' => $keperluan,
                              'aktaPerkawinan' => $aktaPerkawinan,
                              'nomorAktaPerkawinan' => $nomorAktaPerkawinan,
                              'tanggalPerkawinan' => $tanggalPerkawinan,
                              'lokasiPerkawinan' => $lokasiPerkawinan,
                              'statusPerceraian' => $statusPerceraian,
                              'aktaPerceraian' => $aktaPerceraian,
                              'nomorAktaPerceraian' => $nomorAktaPerceraian,
                              'tanggalPerceraian' => $tanggalPerceraian,
                              'lokasiPerceraian' => $lokasiPerceraian,
                              'tanggalKematian' => $tanggalKematian,
                              'tempatKematian' => $tempatKematian,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f18_surat_keterangan_dudajanda' , $dataInput);

                        $dataUpdate = array(
                            'statusPerkawinan' => $statusPerceraian,
                                
                            );
                        
                        $update = $this->Home_model->updateData('penduduk' , $dataUpdate," NIK=$NIKKepalaKeluarga");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f18_surat_keterangan_dudajanda",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan duda / janda",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f18_surat_keterangan_dudajanda()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $NIKPasanganTerdahulu = $this->input->post('NIKPasanganTerdahulu');
        $namaPasanganTerdahulu = $this->input->post('namaPasanganTerdahulu');
        $keperluan = $this->input->post('keperluan');
        $aktaPerkawinan = $this->input->post('aktaPerkawinan');
        $nomorAktaPerkawinan = $this->input->post('nomorAktaPerkawinan');
        $tanggalPerkawinan = $this->input->post('tanggalPerkawinan');
        $lokasiPerkawinan = $this->input->post('lokasiPerkawinan');
        $statusPerceraian = $this->input->post('statusPerceraian');
        $aktaPerceraian = $this->input->post('aktaPerceraian');
        $nomorAktaPerceraian = $this->input->post('nomorAktaPerceraian');
        $tanggalPerceraian = $this->input->post('tanggalPerceraian');
        $lokasiPerceraian = $this->input->post('lokasiPerceraian');
        $tanggalKematian = $this->input->post('tanggalKematian');
        $tempatKematian = $this->input->post('tempatKematian');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f18",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'NIKPasanganTerdahulu' => $NIKPasanganTerdahulu,
                              'namaPasanganTerdahulu' => $namaPasanganTerdahulu,
                              'keperluan' => $keperluan,
                              'aktaPerkawinan' => $aktaPerkawinan,
                              'nomorAktaPerkawinan' => $nomorAktaPerkawinan,
                              'tanggalPerkawinan' => $tanggalPerkawinan,
                              'lokasiPerkawinan' => $lokasiPerkawinan,
                              'statusPerceraian' => $statusPerceraian,
                              'aktaPerceraian' => $aktaPerceraian,
                              'nomorAktaPerceraian' => $nomorAktaPerceraian,
                              'tanggalPerceraian' => $tanggalPerceraian,
                              'lokasiPerceraian' => $lokasiPerceraian,
                              'tanggalKematian' => $tanggalKematian,
                              'tempatKematian' => $tempatKematian,
                              'keperluan' => $keperluan,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f18_surat_keterangan_dudajanda' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f18_surat_keterangan_dudajanda()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f18_surat_keterangan_dudajanda' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F18()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F18()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $NIKPasanganTerdahulu;
        $namaPasanganTerdahulu;
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;
            $namaPasanganTerdahulu = $row->namaLengkap;
            $NIKPasanganTerdahulu = $row->NIK;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        $hasil['NIKPasanganTerdahulu'] = $NIKPasanganTerdahulu;
        $hasil['namaPasanganTerdahulu'] = $namaPasanganTerdahulu;
        echo json_encode($hasil);

    }


    public function showDataUpdate_F18()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $NIKPasanganTerdahulu;
        $namaPasanganTerdahulu;
        $keperluan;
        $aktaPerkawinan;
        $nomorAktaPerkawinan;
        $tanggalPerkawinan;
        $lokasiPerkawinan;
        $statusPerceraian;
        $aktaPerceraian;
        $nomorAktaPerceraian;
        $tanggalPerceraian;
        $lokasiPerceraian;
        $tanggalKematian;
        $tempatKematian;     
        $selectAllShop = $this->Home_model->getSelectData("*","f18_surat_keterangan_dudajanda", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $NIKPasanganTerdahulu = $row->NIKPasanganTerdahulu;
            $namaPasanganTerdahulu = $row->namaPasanganTerdahulu;
            $keperluan = $row->keperluan;
            $aktaPerkawinan = $row->aktaPerkawinan;
            $nomorAktaPerkawinan = $row->nomorAktaPerkawinan;
            $tanggalPerkawinan = $row->tanggalPerkawinan;
            $lokasiPerkawinan = $row->lokasiPerkawinan;
            $statusPerceraian = $row->statusPerceraian;
            $aktaPerceraian = $row->aktaPerceraian;
            $nomorAktaPerceraian = $row->nomorAktaPerceraian;
            $tanggalPerceraian = $row->tanggalPerceraian;
            $lokasiPerceraian = $row->lokasiPerceraian;
            $tanggalKematian = $row->tanggalKematian;
            $tempatKematian = $row->tempatKematian;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['NIKPasanganTerdahulu'] = $NIKPasanganTerdahulu;
        $hasil['namaPasanganTerdahulu'] = $namaPasanganTerdahulu;
        $hasil['keperluan'] = $keperluan;
        $hasil['aktaPerkawinan'] = $aktaPerkawinan;
        $hasil['nomorAktaPerkawinan'] = $nomorAktaPerkawinan;
        $hasil['tanggalPerkawinan'] = $tanggalPerkawinan;
        $hasil['lokasiPerkawinan'] = $lokasiPerkawinan;
        $hasil['statusPerceraian'] = $statusPerceraian;
        $hasil['aktaPerceraian'] = $aktaPerceraian;
        $hasil['nomorAktaPerceraian'] = $nomorAktaPerceraian;
        $hasil['tanggalPerceraian'] = $tanggalPerceraian;
        $hasil['lokasiPerceraian'] = $lokasiPerceraian;
        $hasil['tanggalKematian'] = $tanggalKematian;
        $hasil['tempatKematian'] = $tempatKematian;
        echo json_encode($hasil);

    }



    public function showTable_F18()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f18_surat_keterangan_dudajanda,penduduk", "WHERE f18_surat_keterangan_dudajanda.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f18_surat_keterangan_dudajanda,penduduk", "WHERE f18_surat_keterangan_dudajanda.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f18_surat_keterangan_dudajanda";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                $row->statusPerceraian,
                $row->namaPasanganTerdahulu,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f18_surat_keterangan_dudajanda(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f18_surat_keterangan_dudajanda('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f18_surat_keterangan_dudajanda('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F18()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f18'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f18_surat_keterangan_dudajanda", "WHERE f18_surat_keterangan_dudajanda.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                    $NIKO = $row->NIKPasanganTerdahulu;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['showDataPasangan'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIKO");


                
                $this->load->view('adminPage/f18_surat_keterangan_dudajanda/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }




    //---------------------Pelayanan Administrasi Umum - Surat Keterangan Usaha - (F19) ------------------------


    public function f19_surat_keterangan_usaha()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f19_surat_keterangan_usaha";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f19_surat_keterangan_usaha/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f19_surat_keterangan_usaha_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f19_surat_keterangan_usaha/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f19_surat_keterangan_usaha()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $namaUsaha = $this->input->post('namaUsaha');
        $alamatUsaha = $this->input->post('alamatUsaha');
        $lamaUsaha = $this->input->post('lamaUsaha');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f19",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'namaUsaha' => $namaUsaha,
                              'alamatUsaha' => $alamatUsaha,
                              'lamaUsaha' => $lamaUsaha,
                              'keperluan' => $keperluan,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f19_surat_keterangan_usaha' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f19_surat_keterangan_usaha_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $namaUsaha = $this->input->post('namaUsaha');
        $alamatUsaha = $this->input->post('alamatUsaha');
        $lamaUsaha = $this->input->post('lamaUsaha');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f19",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'namaUsaha' => $namaUsaha,
                              'alamatUsaha' => $alamatUsaha,
                              'lamaUsaha' => $lamaUsaha,
                              'keperluan' => $keperluan,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f19_surat_keterangan_usaha' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f19_surat_keterangan_usaha",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan usaha",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f19_surat_keterangan_usaha()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $namaUsaha = $this->input->post('namaUsaha');
        $alamatUsaha = $this->input->post('alamatUsaha');
        $lamaUsaha = $this->input->post('lamaUsaha');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f19",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'namaUsaha' => $namaUsaha,
                              'alamatUsaha' => $alamatUsaha,
                              'lamaUsaha' => $lamaUsaha,
                              'keperluan' => $keperluan,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f19_surat_keterangan_usaha' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f19_surat_keterangan_usaha()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f19_surat_keterangan_usaha' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F19()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F19()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;    
        $selectAllShop = $this->Home_model->getSelectData("*,UPPER(pekerjaan) pekT","penduduk", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        echo json_encode($hasil);

    }


    public function showDataUpdate_F19()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $namaUsaha;
        $alamatUsaha;
        $lamaUsaha;
        $keperluan;     
        $selectAllShop = $this->Home_model->getSelectData("*","f19_surat_keterangan_usaha", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $namaUsaha = $row->namaUsaha;
            $alamatUsaha = $row->alamatUsaha;
            $lamaUsaha = $row->lamaUsaha;
            $keperluan = $row->keperluan;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['namaUsaha'] = $namaUsaha;
        $hasil['alamatUsaha'] = $alamatUsaha;
        $hasil['lamaUsaha'] = $lamaUsaha;
        $hasil['keperluan'] = $keperluan;
        echo json_encode($hasil);

    }



    public function showTable_F19()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f19_surat_keterangan_usaha,penduduk", "WHERE f19_surat_keterangan_usaha.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f19_surat_keterangan_usaha,penduduk", "WHERE f19_surat_keterangan_usaha.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f19_surat_keterangan_usaha";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->NIK,
                ucfirst(strtolower($row->namaLengkap)),
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f19_surat_keterangan_usaha(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f19_surat_keterangan_usaha('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f19_surat_keterangan_usaha('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F19()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f19'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f19_surat_keterangan_usaha", "WHERE f19_surat_keterangan_usaha.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");


                
                $this->load->view('adminPage/f19_surat_keterangan_usaha/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }




    //----------------Pelayanan Administrasi Umum - Surat Keterangan Tempat Usaha - (F20) ----------------------


    public function f20_surat_keterangan_tempat_usaha()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f20_surat_keterangan_tempat_usaha";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f20_surat_keterangan_tempat_usaha/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }
    public function f20_surat_keterangan_tempat_usaha_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f20_surat_keterangan_tempat_usaha/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }

    public function add_f20_surat_keterangan_tempat_usaha()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $pekerjaan = $this->input->post('pekerjaan');
        $alamat = $this->input->post('alamat');
        $namaUsaha = $this->input->post('namaUsaha');
        $alamatUsaha = $this->input->post('alamatUsaha');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f20",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'jenisKelamin' => $jenisKelamin,
                              'tempatLahir' => $tempatLahir,
                              'tanggalLahir' => $tanggalLahir,
                              'pekerjaan' => $pekerjaan,
                              'alamat' => $alamat,
                              'namaUsaha' => $namaUsaha,
                              'alamatUsaha' => $alamatUsaha,
                              'keperluan' => $keperluan,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f20_surat_keterangan_tempat_usaha' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f20_surat_keterangan_tempat_usaha_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $pekerjaan = $this->input->post('pekerjaan');
        $alamat = $this->input->post('alamat');
        $namaUsaha = $this->input->post('namaUsaha');
        $alamatUsaha = $this->input->post('alamatUsaha');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f20",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'jenisKelamin' => $jenisKelamin,
                              'tempatLahir' => $tempatLahir,
                              'tanggalLahir' => $tanggalLahir,
                              'pekerjaan' => $pekerjaan,
                              'alamat' => $alamat,
                              'namaUsaha' => $namaUsaha,
                              'alamatUsaha' => $alamatUsaha,
                              'keperluan' => $keperluan,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f20_surat_keterangan_tempat_usaha' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f20_surat_keterangan_tempat_usaha",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan tempat usaha",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f20_surat_keterangan_tempat_usaha()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $pekerjaan = $this->input->post('pekerjaan');
        $alamat = $this->input->post('alamat');
        $namaUsaha = $this->input->post('namaUsaha');
        $alamatUsaha = $this->input->post('alamatUsaha');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f20",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'jenisKelamin' => $jenisKelamin,
                              'tempatLahir' => $tempatLahir,
                              'tanggalLahir' => $tanggalLahir,
                              'pekerjaan' => $pekerjaan,
                              'alamat' => $alamat,
                              'namaUsaha' => $namaUsaha,
                              'alamatUsaha' => $alamatUsaha,
                              'keperluan' => $keperluan,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f20_surat_keterangan_tempat_usaha' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f20_surat_keterangan_tempat_usaha()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f20_surat_keterangan_tempat_usaha' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F20()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F20()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $jenisKelamin;
        $tempatLahir;
        $tanggalLahir;
        $pekerjaan;
        $alamat;
        $selectAllShop = $this->Home_model->getSelectData("*,UPPER(pekerjaan) pekT","penduduk", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;
            // tambahan
            $jenisKelamin = $row->jenisKelamin;
            $tempatLahir = $row->tempatLahir;
            $tanggalLahir = $row->tanggalLahir;
            $pekerjaan = $row->pekT;
            $alamat = $row->alamatLengkap;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        // tambahan
        $hasil['jenisKelamin'] = $jenisKelamin;
        $hasil['tempatLahir'] = $tempatLahir;
        $hasil['tanggalLahir'] = $tanggalLahir;
        $hasil['pekerjaan'] = $pekerjaan;
        $hasil['alamat'] = $alamat;
        echo json_encode($hasil);

    }


    public function showDataUpdate_F20()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $jenisKelamin;
        $tempatLahir;
        $tanggalLahir;
        $pekerjaan;     
        $alamat;
        $namaUsaha;
        $alamatUsaha;
        $keperluan;
        $selectAllShop = $this->Home_model->getSelectData("*","f20_surat_keterangan_tempat_usaha", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            // tambahan
            $jenisKelamin = $row->jenisKelamin;
            $tempatLahir = $row->tempatLahir;
            $tanggalLahir = $row->tanggalLahir;
            $pekerjaan = $row->pekerjaan;
            $alamat = $row->alamat;
            $namaUsaha = $row->namaUsaha;
            $alamatUsaha = $row->alamatUsaha;
            $keperluan = $row->keperluan;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        // tambahan
        $hasil['jenisKelamin'] = $jenisKelamin;
        $hasil['tempatLahir'] = $tempatLahir;
        $hasil['tanggalLahir'] = $tanggalLahir;
        $hasil['pekerjaan'] = $pekerjaan;
        $hasil['alamat'] = $alamat;
        $hasil['namaUsaha'] = $namaUsaha;
        $hasil['alamatUsaha'] = $alamatUsaha;
        $hasil['keperluan'] = $keperluan;
        echo json_encode($hasil);

    }



    public function showTable_F20()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f20_surat_keterangan_tempat_usaha,penduduk", "WHERE f20_surat_keterangan_tempat_usaha.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f20_surat_keterangan_tempat_usaha,penduduk", "WHERE f20_surat_keterangan_tempat_usaha.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f20_surat_keterangan_tempat_usaha";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->NIK,
                ucfirst(strtolower($row->namaLengkap)),
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f20_surat_keterangan_tempat_usaha(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f20_surat_keterangan_tempat_usaha('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f20_surat_keterangan_tempat_usaha('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F20()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f20'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*, LOWER(pekerjaan)pekerjaan","f20_surat_keterangan_tempat_usaha", "WHERE f20_surat_keterangan_tempat_usaha.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat","penduduk", "WHERE penduduk.NIK=$NIK");


                
                $this->load->view('adminPage/f20_surat_keterangan_tempat_usaha/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }

    //----------------Pelayanan Administrasi Umum - Surat Keterangan Pengantar Ternak - (F22) --------------

    public function f22_suket_pengantar_ternak()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "WHERE kedudukanDalamKeluarga='KEPALA KELUARGA' ORDER BY namaLengkap ASC");
            $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
            $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
            $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
            $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");

            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f22_suket_pengantar_ternak";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f22_suket_pengantar_ternak/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }
    public function f22_suket_pengantar_ternak_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f22_suket_pengantar_ternak/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }



    public function add_f22_suket_pengantar_ternak()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $randomCode = $this->input->post('randomCode');
        $nama = $this->input->post('nama');
        
        //data umum
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $pekerjaan = $this->input->post('pekerjaan');
        $alamat = $this->input->post('alamat');

        //data pengantar
        $nikPengantar = $this->input->post('nikPengantar');
        $namaPengantar = $this->input->post('namaPengantar');
        $umurPengantar = $this->input->post('umurPengantar');
        $jenisKelaminPengantar = $this->input->post('jenisKelaminPengantar');
        $pekerjaanPengantar = $this->input->post('pekerjaanPengantar');
        $alamatPengantar = $this->input->post('alamatPengantar');
        $jenisTernak = $this->input->post('jenisTernak');
        $alamatTujuanAntar = $this->input->post('alamatTujuanAntar');

        //data ternak
        $jumlahTernak = $this->input->post('jumlahTernak');
        $jenisKelaminTernak = $this->input->post('jenisKelaminTernak');
        $umurTernak = $this->input->post('umurTernak');
        $warnaTernak = $this->input->post('warnaTernak');
        $tandukTernak = $this->input->post('tandukTernak');
        $nomorKartuHewan = $this->input->post('nomorKartuHewan');


        $jmlTernakParsed = "";
        $jenKelaminTernakParsed = "";
        $umurTernakParsed = "";
        $warnaTernakParsed = "";
        $tandukTernakParsed = "";
        $noKartuHewanParsed = "";
        
        for ($i=0; $i < count($jumlahTernak); $i++) { 
            $jmlTernakParsed.= $jumlahTernak[$i].";";
        }

        for ($i=0; $i < count($jenisKelaminTernak); $i++) { 
            $jenKelaminTernakParsed.= $jenisKelaminTernak[$i].";";
        }

        for ($i=0; $i < count($umurTernak); $i++) { 
            $umurTernakParsed.= $umurTernak[$i].";";
        }

        for ($i=0; $i < count($warnaTernak); $i++) { 
            $warnaTernakParsed.= $warnaTernak[$i].";";
        }

        for ($i=0; $i < count($tandukTernak); $i++) { 
            $tandukTernakParsed.= $tandukTernak[$i].";";
        }

        for ($i=0; $i < count($nomorKartuHewan); $i++) { 
            $noKartuHewanParsed.= $nomorKartuHewan[$i].";";
        }
        
       
                        $dataInput = array(
                              'kode_formulir' => "f22",
                              'nomorSurat' => $noSurat,
                              'NIK' => $noKK,
                              'nama' => $nama,
                              'dataUmum' => $tempatLahir.";".$tanggalLahir.";".$jenisKelamin.";".$pekerjaan.";".$alamat,
                              'dataPengantar' => $nikPengantar.";".$namaPengantar.";".$umurPengantar.";".$jenisKelaminPengantar.";".$pekerjaanPengantar.";".$alamatPengantar.";".$jenisTernak.";".$alamatTujuanAntar,
                              'jumlahTernak' => $jmlTernakParsed,
                              'jenisKelaminTernak' => $jenKelaminTernakParsed,
                              'umurTernak' => $umurTernakParsed,
                              'warnaTernak' => $warnaTernakParsed,
                              'tandukTernak' => $tandukTernakParsed,
                              'nomorKartuHewan' => $noKartuHewanParsed,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                            );
                        
                        $simpan = $this->Home_model->insertData('f22_suket_pengantar_ternak' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f22_suket_pengantar_ternak_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $randomCode = $this->input->post('randomCode');
        $nama = $this->input->post('nama');
        
        //data umum
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $pekerjaan = $this->input->post('pekerjaan');
        $alamat = $this->input->post('alamat');

        //data pengantar
        $nikPengantar = $this->input->post('nikPengantar');
        $namaPengantar = $this->input->post('namaPengantar');
        $umurPengantar = $this->input->post('umurPengantar');
        $jenisKelaminPengantar = $this->input->post('jenisKelaminPengantar');
        $pekerjaanPengantar = $this->input->post('pekerjaanPengantar');
        $alamatPengantar = $this->input->post('alamatPengantar');
        $jenisTernak = $this->input->post('jenisTernak');
        $alamatTujuanAntar = $this->input->post('alamatTujuanAntar');

        //data ternak
        $jumlahTernak = $this->input->post('jumlahTernak');
        $jenisKelaminTernak = $this->input->post('jenisKelaminTernak');
        $umurTernak = $this->input->post('umurTernak');
        $warnaTernak = $this->input->post('warnaTernak');
        $tandukTernak = $this->input->post('tandukTernak');
        $nomorKartuHewan = $this->input->post('nomorKartuHewan');


        $jmlTernakParsed = "";
        $jenKelaminTernakParsed = "";
        $umurTernakParsed = "";
        $warnaTernakParsed = "";
        $tandukTernakParsed = "";
        $noKartuHewanParsed = "";
        
        for ($i=0; $i < count($jumlahTernak); $i++) { 
            $jmlTernakParsed.= $jumlahTernak[$i].";";
        }

        for ($i=0; $i < count($jenisKelaminTernak); $i++) { 
            $jenKelaminTernakParsed.= $jenisKelaminTernak[$i].";";
        }

        for ($i=0; $i < count($umurTernak); $i++) { 
            $umurTernakParsed.= $umurTernak[$i].";";
        }

        for ($i=0; $i < count($warnaTernak); $i++) { 
            $warnaTernakParsed.= $warnaTernak[$i].";";
        }

        for ($i=0; $i < count($tandukTernak); $i++) { 
            $tandukTernakParsed.= $tandukTernak[$i].";";
        }

        for ($i=0; $i < count($nomorKartuHewan); $i++) { 
            $noKartuHewanParsed.= $nomorKartuHewan[$i].";";
        }
       
                        $dataInput = array(
                              'kode_formulir' => "f22",
                              'nomorSurat' => $noSurat,
                              'NIK' => $noKK,
                              'nama' => $nama,
                              'dataUmum' => $tempatLahir.";".$tanggalLahir.";".$jenisKelamin.";".$pekerjaan.";".$alamat,
                              'dataPengantar' => $nikPengantar.";".$namaPengantar.";".$umurPengantar.";".$jenisKelaminPengantar.";".$pekerjaanPengantar.";".$alamatPengantar.";".$jenisTernak.";".$alamatTujuanAntar,
                              'jumlahTernak' => $jmlTernakParsed,
                              'jenisKelaminTernak' => $jenKelaminTernakParsed,
                              'umurTernak' => $umurTernakParsed,
                              'warnaTernak' => $warnaTernakParsed,
                              'tandukTernak' => $tandukTernakParsed,
                              'nomorKartuHewan' => $noKartuHewanParsed,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f22_suket_pengantar_ternak' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f22_suket_pengantar_ternak",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan pengantar ternak",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }



    public function update_f22_suket_pengantar_ternak()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $randomCode = $this->input->post('randomCode');
        $nama = $this->input->post('nama');
        
        //data umum
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $pekerjaan = $this->input->post('pekerjaan');
        $alamat = $this->input->post('alamat');

        //data pengantar
        $nikPengantar = $this->input->post('nikPengantar');
        $namaPengantar = $this->input->post('namaPengantar');
        $umurPengantar = $this->input->post('umurPengantar');
        $jenisKelaminPengantar = $this->input->post('jenisKelaminPengantar');
        $pekerjaanPengantar = $this->input->post('pekerjaanPengantar');
        $alamatPengantar = $this->input->post('alamatPengantar');
        $jenisTernak = $this->input->post('jenisTernak');
        $alamatTujuanAntar = $this->input->post('alamatTujuanAntar');

        //data ternak
        $jumlahTernak = $this->input->post('jumlahTernak');
        $jenisKelaminTernak = $this->input->post('jenisKelaminTernak');
        $umurTernak = $this->input->post('umurTernak');
        $warnaTernak = $this->input->post('warnaTernak');
        $tandukTernak = $this->input->post('tandukTernak');
        $nomorKartuHewan = $this->input->post('nomorKartuHewan');


        $jmlTernakParsed = "";
        $jenKelaminTernakParsed = "";
        $umurTernakParsed = "";
        $warnaTernakParsed = "";
        $tandukTernakParsed = "";
        $noKartuHewanParsed = "";
        
        for ($i=0; $i < count($jumlahTernak); $i++) { 
            $jmlTernakParsed.= $jumlahTernak[$i].";";
        }

        for ($i=0; $i < count($jenisKelaminTernak); $i++) { 
            $jenKelaminTernakParsed.= $jenisKelaminTernak[$i].";";
        }

        for ($i=0; $i < count($umurTernak); $i++) { 
            $umurTernakParsed.= $umurTernak[$i].";";
        }

        for ($i=0; $i < count($warnaTernak); $i++) { 
            $warnaTernakParsed.= $warnaTernak[$i].";";
        }

        for ($i=0; $i < count($tandukTernak); $i++) { 
            $tandukTernakParsed.= $tandukTernak[$i].";";
        }

        for ($i=0; $i < count($nomorKartuHewan); $i++) { 
            $noKartuHewanParsed.= $nomorKartuHewan[$i].";";
        }
       
                        $dataInput = array(
                              'kode_formulir' => "f22",
                              'nomorSurat' => $noSurat,
                              'NIK' => $noKK,
                              'nama' => $nama,
                              'dataUmum' => $tempatLahir.";".$tanggalLahir.";".$jenisKelamin.";".$pekerjaan.";".$alamat,
                              'dataPengantar' => $nikPengantar.";".$namaPengantar.";".$umurPengantar.";".$jenisKelaminPengantar.";".$pekerjaanPengantar.";".$alamatPengantar.";".$jenisTernak.";".$alamatTujuanAntar,
                              'jumlahTernak' => $jmlTernakParsed,
                              'jenisKelaminTernak' => $jenKelaminTernakParsed,
                              'umurTernak' => $umurTernakParsed,
                              'warnaTernak' => $warnaTernakParsed,
                              'tandukTernak' => $tandukTernakParsed,
                              'nomorKartuHewan' => $noKartuHewanParsed,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                            );
                        
                        
                        $simpan = $this->Home_model->updateData('f22_suket_pengantar_ternak' , $dataInput,"id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function delete_f22_suket_pengantar_ternak()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f22_suket_pengantar_ternak' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }



    public function showPendudukData_f22()
    {

        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];
            $kodeDesa = $namaadmin['kodeDesa'];

            $result = array();
            $hasil['kontenKK'] = "";

            $data['dataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE kodeDesa='$kodeDesa'");
            $alamatTambahan ="";
            foreach ($data['dataDesa']->result() as $row) {
                $alamatTambahan = "Kecamatan ".$row->namaKecamatan." Kabupaten ".$row->namaKabupaten;
            }

            // $keyword = $this->uri->segment(3);
            $keyword = $this->input->post('NIK');

            $noKK;
            $namaKepalaKK;       $kelengkapanPenduduk;
            $NIKKepalaKeluarga;
            $pendidikanTerakhir;
            $pekerjaan;
            $agama;
            $tglLahir;
            $tanggalLahir;
            $umur;
            $pekerjaan;
            $kewarganegaraan;
            $tempatLahir;
            $namaKepalaKeluarga;
            $anakKe = 0;
            $jenisKelamin ;
            $alamatSekarang ;
            $selectAllShop = $this->Home_model->getSelectData("*,TIMESTAMPDIFF(YEAR,tanggalLahir,CURDATE()) as umur","penduduk", "WHERE NIK='$keyword'");
            foreach ($selectAllShop->result() as $row) {
                    //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

                $noKK = $row->nomorKK;
                $namaKepalaKK = $row->namaLengkap;
                $NIKKepalaKeluarga = $row->NIK;
                $pendidikanTerakhir = $row->pendidikanTerakhir;
                $pekerjaan = $row->pekerjaan;
                $agama = $row->agama;
                $tglLahir = $row->tanggalLahir;
                $tanggalLahir = $row->tanggalLahir;
                $umur = $row->umur;
                $pekerjaan = $row->pekerjaan;
                $kewarganegaraan = $row->kewarganegaraan;
                $tempatLahir = $row->tempatLahir;
                $jenisKelamin = $row->jenisKelamin;
                $alamatSekarang = $row->alamatLengkap;

            }

            $selectKKDataKepalaKeluarga = $this->Home_model->getSelectData("*","penduduk", "WHERE nomorKK='$noKK' AND kedudukanDalamKeluarga='KEPALA KELUARGA'");
            foreach ($selectKKDataKepalaKeluarga->result() as $row) {
                $namaKepalaKeluargaReal = $row->namaLengkap;
            }

            $selectKKDataAnakKe = $this->Home_model->getSelectData("*, penduduk.NIK nikAnak","penduduk", "WHERE nomorKK='$noKK' AND kedudukanDalamKeluarga='KEPALA KELUARGA'");

            $tglLahir = explode("-", $tglLahir);
            $tglLahir = $tglLahir[2]."/".$tglLahir[1]."/".$tglLahir[0];

            // $alamatSekarang = explode(",", $alamatSekarang);
            // $alamatSekarang = $alamatSekarang[0]." ".strtoupper($alamatTambahan);

            
                //Menampilkan Array dalam Format JSON
            $hasil['noKK'] = $noKK;
            $hasil['kewarganegaraan'] = $kewarganegaraan;
            $hasil['tempatLahir'] = $tempatLahir;
            $hasil['namaKepalaKK'] = $namaKepalaKK;
            $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
            $hasil['pendidikanTerakhir'] = $pendidikanTerakhir;
            $hasil['agama'] = $agama;
            $hasil['tglLahir'] = $tglLahir;
            $hasil['tanggalLahir'] = $tanggalLahir;
            $hasil['umur'] = $umur;
            $hasil['alamatSekarang'] = ucwords(strtolower($alamatSekarang));
            $hasil['jenisKelamin'] = $jenisKelamin;
            $hasil['pekerjaan'] = strtoupper($pekerjaan);
            $hasil['namaKepalaKeluargaReal'] = strtoupper($namaKepalaKeluargaReal);
            $hasil['anakKe'] = $anakKe;
            echo json_encode($hasil);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

    }



    public function showTableF22()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f22_suket_pengantar_ternak,penduduk", "WHERE f22_suket_pengantar_ternak.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%' || penduduk.nomorKK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f22_suket_pengantar_ternak,penduduk", "WHERE f22_suket_pengantar_ternak.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f22_suket_pengantar_ternak";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $namaPengirimStr = explode(";", $row->dataPengantar);
            // $senTo = $alamatStr[0].", Desa ".$alamatStr[1].", Kec. ".$alamatStr[2].", Kab. ".$alamatStr[3].", Prov. ".$alamatStr[4];
            $senTo = $namaPengirimStr[1];


            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->namaLengkap,
                strtoupper($senTo),
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f22_suket_pengantar_ternak(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f22_suket_pengantar_ternak('.$row->id.',\''.$row->nomorSurat.'\',\''.$row->NIK.'\',\''.$row->nama.'\',\''.$row->dataUmum.'\',\''.$row->dataPengantar.'\',\''.$row->jumlahTernak.'\',\''.$row->jenisKelaminTernak.'\',\''.$row->umurTernak.'\',\''.$row->warnaTernak.'\',\''.$row->tandukTernak.'\',\''.$row->nomorKartuHewan.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f22_suket_pengantar_ternak('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }



    //-----------Pelayanan Administrasi Umum - Surat Keterangan Tidak Mampu (Sekolah) - (F23) --------------


    public function f23_surat_keterangan_tidakmampusekolah()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f23_surat_keterangan_tidakmampusekolah";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f23_surat_keterangan_tidakmampusekolah/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }
    public function f23_surat_keterangan_tidakmampusekolah_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f23_surat_keterangan_tidakmampusekolah/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f23_surat_keterangan_tidakmampusekolah()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $idBDT = $this->input->post('idBDT');
        $NIKAyah = $this->input->post('NIKAyah');
        $namaAyah = $this->input->post('namaAyah');
        $pekerjaanAyah = $this->input->post('pekerjaanAyah');
        $NIKIbu = $this->input->post('NIKIbu');
        $namaIbu = $this->input->post('namaIbu');
        $pekerjaanIbu = $this->input->post('pekerjaanIbu');
        $tanggungan = $this->input->post('tanggungan');
        $alamat = $this->input->post('alamat');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f23",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'idBDT' => $idBDT,
                              'NIKAyah' => $NIKAyah,
                              'namaAyah' => $namaAyah,
                              'pekerjaanAyah' => $pekerjaanAyah,
                              'NIKIbu' => $NIKIbu,
                              'namaIbu' => $namaIbu,
                              'pekerjaanIbu' => $pekerjaanIbu,
                              'tanggungan' => $tanggungan,
                              'alamat' => $alamat,
                              'keperluan' => $keperluan,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f23_surat_keterangan_tidakmampusekolah' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f23_surat_keterangan_tidakmampusekolah_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $idBDT = $this->input->post('idBDT');
        $NIKAyah = $this->input->post('NIKAyah');
        $namaAyah = $this->input->post('namaAyah');
        $pekerjaanAyah = $this->input->post('pekerjaanAyah');
        $NIKIbu = $this->input->post('NIKIbu');
        $namaIbu = $this->input->post('namaIbu');
        $pekerjaanIbu = $this->input->post('pekerjaanIbu');
        $tanggungan = $this->input->post('tanggungan');
        $alamat = $this->input->post('alamat');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');


                        $dataInput = array(
                              'kode_formulir' => "f23",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'idBDT' => $idBDT,
                              'NIKAyah' => $NIKAyah,
                              'namaAyah' => $namaAyah,
                              'pekerjaanAyah' => $pekerjaanAyah,
                              'NIKIbu' => $NIKIbu,
                              'namaIbu' => $namaIbu,
                              'pekerjaanIbu' => $pekerjaanIbu,
                              'tanggungan' => $tanggungan,
                              'alamat' => $alamat,
                              'keperluan' => $keperluan,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                                
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f23_surat_keterangan_tidakmampusekolah' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f23_surat_keterangan_tidakmampusekolah",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat tidak mampu sekolah",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f23_surat_keterangan_tidakmampusekolah()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $idBDT = $this->input->post('idBDT');
        $NIKAyah = $this->input->post('NIKAyah');
        $namaAyah = $this->input->post('namaAyah');
        $pekerjaanAyah = $this->input->post('pekerjaanAyah');
        $NIKIbu = $this->input->post('NIKIbu');
        $namaIbu = $this->input->post('namaIbu');
        $pekerjaanIbu = $this->input->post('pekerjaanIbu');
        $tanggungan = $this->input->post('tanggungan');
        $alamat = $this->input->post('alamat');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'idBDT' => $idBDT,
                              'NIKAyah' => $NIKAyah,
                              'namaAyah' => $namaAyah,
                              'pekerjaanAyah' => $pekerjaanAyah,
                              'NIKIbu' => $NIKIbu,
                              'namaIbu' => $namaIbu,
                              'pekerjaanIbu' => $pekerjaanIbu,
                              'tanggungan' => $tanggungan,
                              'alamat' => $alamat,
                              'keperluan' => $keperluan,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f23_surat_keterangan_tidakmampusekolah' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f23_surat_keterangan_tidakmampusekolah()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f23_surat_keterangan_tidakmampusekolah' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F23()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F23()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $pekerjaan;
        $alamat;
        $selectAllShop = $this->Home_model->getSelectData("*,LOWER(alamatLengkap)alamatL","penduduk", "WHERE penduduk.NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;
            // tambahan
            $pekerjaan = $row->pekerjaan;
            $alamat = $row->alamatL;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        $hasil['pekerjaan'] = $pekerjaan;
        $hasil['alamat'] = ucwords($alamat);
        echo json_encode($hasil);

    }


    public function showDataUpdate_F23()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $idBDT;
        $NIKAyah;
        $namaAyah;
        $pekerjaanAyah;
        $NIKIbu;
        $namaIbu;
        $pekerjaanIbu;
        $tanggungan;
        $alamat;
        $keperluan;     
        $selectAllShop = $this->Home_model->getSelectData("*","f23_surat_keterangan_tidakmampusekolah", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $idBDT = $row->idBDT;
            $NIKAyah = $row->NIKAyah;
            $namaAyah = $row->namaAyah;
            $pekerjaanAyah = $row->pekerjaanAyah;
            $NIKIbu = $row->NIKIbu;
            $namaIbu = $row->namaIbu;
            $pekerjaanIbu = $row->pekerjaanIbu;
            $tanggungan = $row->tanggungan;
            $alamat = $row->alamat;
            $keperluan = $row->keperluan;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['idBDT'] = $idBDT;
        $hasil['NIKAyah'] = $NIKAyah;
        $hasil['namaAyah'] = $namaAyah;
        $hasil['pekerjaanAyah'] = $pekerjaanAyah;
        $hasil['NIKIbu'] = $NIKIbu;
        $hasil['namaIbu'] = $namaIbu;
        $hasil['pekerjaanIbu'] = $pekerjaanIbu;
        $hasil['tanggungan'] = $tanggungan;
        $hasil['alamat'] = $alamat;
        $hasil['keperluan'] = $keperluan;
        echo json_encode($hasil);

    }



    public function showTable_F23()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f23_surat_keterangan_tidakmampusekolah,penduduk", "WHERE f23_surat_keterangan_tidakmampusekolah.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f23_surat_keterangan_tidakmampusekolah,penduduk", "WHERE f23_surat_keterangan_tidakmampusekolah.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f23_surat_keterangan_tidakmampusekolah";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                $row->keperluan,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f23_surat_keterangan_tidakmampusekolah(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f23_surat_keterangan_tidakmampusekolah('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f23_surat_keterangan_tidakmampusekolah('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F23()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f23'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*, LOWER(pekerjaanAyah)pekerjaanAy, LOWER(pekerjaanIbu)pekerjaanIb","f23_surat_keterangan_tidakmampusekolah", "WHERE f23_surat_keterangan_tidakmampusekolah.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                    $NIKA = $row->NIKAyah;
                    $NIKI = $row->NIKIbu;

                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['showDataAyah'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIKA");

                
                $this->load->view('adminPage/f23_surat_keterangan_tidakmampusekolah/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }




    //-----------Pelayanan Administrasi Umum - Surat Keterangan Tidak Mampu (Umum) - (F24) --------------


    public function f24_suket_tidakmampuumum()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f24_suket_tidakmampuumum";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f24_suket_tidakmampuumum/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }


    public function f24_suket_tidakmampuumum_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f24_suket_tidakmampuumum/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f24_suket_tidakmampuumum()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');

        //tambahan
        $jenisKelamin = $this->input->post('jenisKelamin');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $pekerjaan = $this->input->post('pekerjaan');
        $statusDalamKeluarga = $this->input->post('statusDalamKeluarga');
        $dusun = $this->input->post('dusun');
        $idBDT = $this->input->post('idBDT');
        $keperluan = $this->input->post('keperluan');
        $tampilKeluarga = $this->input->post('tampilKeluarga');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f24",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'jenisKelamin' => $jenisKelamin,
                              'tempatLahir' => $tempatLahir,
                              'tanggalLahir' => $tanggalLahir,
                              'pekerjaan' => $pekerjaan,
                              'statusDalamKeluarga' => $statusDalamKeluarga,
                              'dusun' => $dusun,
                              'idBDT' => $idBDT,
                              'keperluan' => $keperluan,
                              'tampilKeluarga' => $tampilKeluarga,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f24_suket_tidakmampuumum' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }
    public function add_f24_suket_tidakmampuumum_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');

        //tambahan
        $jenisKelamin = $this->input->post('jenisKelamin');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $pekerjaan = $this->input->post('pekerjaan');
        $statusDalamKeluarga = $this->input->post('statusDalamKeluarga');
        $dusun = $this->input->post('dusun');
        $idBDT = $this->input->post('idBDT');
        $keperluan = $this->input->post('keperluan');
        $tampilKeluarga = $this->input->post('tampilKeluarga');
        $randomCode = $this->input->post('randomCode');


                        $dataInput = array(
                              'kode_formulir' => "f24",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'jenisKelamin' => $jenisKelamin,
                              'tempatLahir' => $tempatLahir,
                              'tanggalLahir' => $tanggalLahir,
                              'pekerjaan' => $pekerjaan,
                              'statusDalamKeluarga' => $statusDalamKeluarga,
                              'dusun' => $dusun,
                              'idBDT' => $idBDT,
                              'keperluan' => $keperluan,
                              'tampilKeluarga' => $tampilKeluarga,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                                
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f24_suket_tidakmampuumum' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f24_suket_tidakmampuumum",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat tidak mampu (umum)",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f24_suket_tidakmampuumum()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        
        //tambahan
        $jenisKelamin = $this->input->post('jenisKelamin');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $pekerjaan = $this->input->post('pekerjaan');
        $statusDalamKeluarga = $this->input->post('statusDalamKeluarga');
        $dusun = $this->input->post('dusun');
        $idBDT = $this->input->post('idBDT');
        $keperluan = $this->input->post('keperluan');
        $tampilKeluarga = $this->input->post('tampilKeluarga');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'jenisKelamin' => $jenisKelamin,
                              'tempatLahir' => $tempatLahir,
                              'tanggalLahir' => $tanggalLahir,
                              'pekerjaan' => $pekerjaan,
                              'statusDalamKeluarga' => $statusDalamKeluarga,
                              'dusun' => $dusun,
                              'idBDT' => $idBDT,
                              'keperluan' => $keperluan,
                              'tampilKeluarga' => $tampilKeluarga,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f24_suket_tidakmampuumum' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f24_suket_tidakmampuumum()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f24_suket_tidakmampuumum' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F24()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F24()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $jenisKelamin;
        $tempatLahir;
        $tanggalLahir;
        $pekerjaan;
        $kedudukanDalamKeluarga;
        $alamatLengkap;
        $selectAllShop = $this->Home_model->getSelectData("*,LOWER(alamatLengkap)alamatL","penduduk", "WHERE penduduk.NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;
            // tambahan
            $jenisKelamin = $row->jenisKelamin;
            $tempatLahir = $row->tempatLahir;
            $tanggalLahir = $row->tanggalLahir;
            $pekerjaan = $row->pekerjaan;
            $kedudukanDalamKeluarga = $row->kedudukanDalamKeluarga;
            $alamatLengkap = $row->alamatL;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        $hasil['jenisKelamin'] = $jenisKelamin;
        $hasil['tempatLahir'] = $tempatLahir;
        $hasil['tanggalLahir'] = $tanggalLahir;
        $hasil['pekerjaan'] = $pekerjaan;
        $hasil['kedudukanDalamKeluarga'] = ucwords(strtolower($kedudukanDalamKeluarga));
        $hasil['alamatLengkap'] = ucwords($alamatLengkap);
        echo json_encode($hasil);

    }


    public function showDataUpdate_F24()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $jenisKelamin;
        $tempatLahir;
        $tanggalLahir;
        $pekerjaan;
        $statusDalamKeluarga;
        $dusun;
        $idBDT;
        $keperluan;
        $tampilKeluarga;     
        $selectAllShop = $this->Home_model->getSelectData("*","f24_suket_tidakmampuumum", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $jenisKelamin = $row->jenisKelamin;
            $tempatLahir = $row->tempatLahir;
            $tanggalLahir = $row->tanggalLahir;
            $pekerjaan = $row->pekerjaan;
            $statusDalamKeluarga = $row->statusDalamKeluarga;
            $dusun = $row->dusun;
            $idBDT = $row->idBDT;
            $keperluan = $row->keperluan;
            $tampilKeluarga = $row->tampilKeluarga;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['jenisKelamin'] = $jenisKelamin;
        $hasil['tempatLahir'] = $tempatLahir;
        $hasil['tanggalLahir'] = $tanggalLahir;
        $hasil['pekerjaan'] = $pekerjaan;
        $hasil['statusDalamKeluarga'] = $statusDalamKeluarga;
        $hasil['dusun'] = $dusun;
        $hasil['idBDT'] = $idBDT;
        $hasil['keperluan'] = $keperluan;
        $hasil['tampilKeluarga'] = $tampilKeluarga;
        echo json_encode($hasil);

    }



    public function showTable_F24()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f24_suket_tidakmampuumum,penduduk", "WHERE f24_suket_tidakmampuumum.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f24_suket_tidakmampuumum,penduduk", "WHERE f24_suket_tidakmampuumum.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f24_suket_tidakmampuumum";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                $row->keperluan,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f24_suket_tidakmampuumum(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f24_suket_tidakmampuumum('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f24_suket_tidakmampuumum('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F24()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f24'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f24_suket_tidakmampuumum", "WHERE f24_suket_tidakmampuumum.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                    $noKK = $row->nomorKK;

                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.nomorKK=$noKK AND penduduk.NIK NOT IN ($NIK)");

                // $data['showKetKematian'] = $this->Home_model->getSelectData("*","f12_surat_keterangan_kematian", "WHERE f12_surat_keterangan_kematian.NIK=$NIK");

                
                $this->load->view('adminPage/f24_suket_tidakmampuumum/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }



    //------------Pelayanan Administrasi Umum - Surat Keterangan Rumah Tangga Miskin Sekali - (F25) -------------


    public function f25_surat_keterangan_rumahtangga_miskinsekali()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f25_surat_keterangan_rumahtangga_miskinsekali";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f25_surat_keterangan_rumahtangga_miskinsekali/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f25_surat_keterangan_rumahtangga_miskinsekali_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f25_surat_keterangan_rumahtangga_miskinsekali/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f25_surat_keterangan_rumahtangga_miskinsekali()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f25",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f25_surat_keterangan_rumahtangga_miskinsekali' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f25_surat_keterangan_rumahtangga_miskinsekali_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $randomCode = $this->input->post('randomCode');

        //tambahan
        $jenisKelamin = $this->input->post('jenisKelamin');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $pekerjaan = $this->input->post('pekerjaan');
        $statusDalamKeluarga = $this->input->post('statusDalamKeluarga');
        $dusun = $this->input->post('dusun');
        $idBDT = $this->input->post('idBDT');
        $keperluan = $this->input->post('keperluan');
        $tampilKeluarga = $this->input->post('tampilKeluarga');
        $randomCode = $this->input->post('randomCode');


                        $dataInput = array(
                              'kode_formulir' => "f25",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                                
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f25_surat_keterangan_rumahtangga_miskinsekali' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f25_surat_keterangan_rumahtangga_miskinsekali",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request suket rumah tangga miskin sekali",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f25_surat_keterangan_rumahtangga_miskinsekali()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f25",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f25_surat_keterangan_rumahtangga_miskinsekali' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f25_surat_keterangan_rumahtangga_miskinsekali()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f25_surat_keterangan_rumahtangga_miskinsekali' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F25()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F25()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;

        }

        $selectByNomorKK = $this->Home_model->getSelectData("*","penduduk", "WHERE nomorKK='$noKK' AND NIK NOT IN($keyword)");
        foreach ($selectByNomorKK->result() as $row) {
            $hasil['kontenKK'].= '
                <input type="text" class="form-control" value="['.$row->kedudukanDalamKeluarga.'] '.$row->namaLengkap.'" readonly="" required="">
            ';

        }

        
            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        echo json_encode($hasil);

    }



    public function showTable_F25()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f25_surat_keterangan_rumahtangga_miskinsekali,penduduk", "WHERE f25_surat_keterangan_rumahtangga_miskinsekali.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f25_surat_keterangan_rumahtangga_miskinsekali,penduduk", "WHERE f25_surat_keterangan_rumahtangga_miskinsekali.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f25_surat_keterangan_rumahtangga_miskinsekali";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }
            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                ucfirst(strtolower($row->namaLengkap)),
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f25_surat_keterangan_rumahtangga_miskinsekali(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f25_surat_keterangan_rumahtangga_miskinsekali('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f25_surat_keterangan_rumahtangga_miskinsekali('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F25()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f25'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);

                $data['showData'] = $this->Home_model->getSelectData("*","f25_surat_keterangan_rumahtangga_miskinsekali, penduduk", "WHERE f25_surat_keterangan_rumahtangga_miskinsekali.NIK=penduduk.NIK AND f25_surat_keterangan_rumahtangga_miskinsekali.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");


                
                $this->load->view('adminPage/f25_surat_keterangan_rumahtangga_miskinsekali/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }




    //----------------Pelayanan Administrasi Umum - Surat Keterangan Penghasilan Orang Tua - (F26) --------------


    public function f26_surat_keterangan_penghasilan_orangtua()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f26_surat_keterangan_penghasilan_orangtua";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f26_surat_keterangan_penghasilan_orangtua/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f26_surat_keterangan_penghasilan_orangtua_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f26_surat_keterangan_penghasilan_orangtua/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f26_surat_keterangan_penghasilan_orangtua()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $NIKOrangTua = $this->input->post('NIKOrangTua');
        $namaOrangTua = $this->input->post('namaOrangTua');
        $penghasilanOrangTua = $this->input->post('penghasilanOrangTua');
        $statusPenghasilanOrangTua = $this->input->post('statusPenghasilanOrangTua');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f26",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'NIKOrangTua' => $NIKOrangTua,
                              'namaOrangTua' => $namaOrangTua,
                              'penghasilanOrangTua' => $penghasilanOrangTua,
                              'statusPenghasilanOrangTua' => $statusPenghasilanOrangTua,
                              'keperluan' => $keperluan,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f26_surat_keterangan_penghasilan_orangtua' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f26_surat_keterangan_penghasilan_orangtua_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $NIKOrangTua = $this->input->post('NIKOrangTua');
        $namaOrangTua = $this->input->post('namaOrangTua');
        $penghasilanOrangTua = $this->input->post('penghasilanOrangTua');
        $statusPenghasilanOrangTua = $this->input->post('statusPenghasilanOrangTua');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');


                        $dataInput = array(
                              'kode_formulir' => "f26",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'NIKOrangTua' => $NIKOrangTua,
                              'namaOrangTua' => $namaOrangTua,
                              'penghasilanOrangTua' => $penghasilanOrangTua,
                              'statusPenghasilanOrangTua' => $statusPenghasilanOrangTua,
                              'keperluan' => $keperluan,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                                
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f26_surat_keterangan_penghasilan_orangtua' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f26_surat_keterangan_penghasilan_orangtua",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request suket penghasilan orangtua",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f26_surat_keterangan_penghasilan_orangtua()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $NIKOrangTua = $this->input->post('NIKOrangTua');
        $namaOrangTua = $this->input->post('namaOrangTua');
        $penghasilanOrangTua = $this->input->post('penghasilanOrangTua');
        $statusPenghasilanOrangTua = $this->input->post('statusPenghasilanOrangTua');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f26",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'NIKOrangTua' => $NIKOrangTua,
                              'namaOrangTua' => $namaOrangTua,
                              'penghasilanOrangTua' => $penghasilanOrangTua,
                              'statusPenghasilanOrangTua' => $statusPenghasilanOrangTua,
                              'keperluan' => $keperluan,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f26_surat_keterangan_penghasilan_orangtua' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f26_surat_keterangan_penghasilan_orangtua()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f26_surat_keterangan_penghasilan_orangtua' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F26()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F26()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $NIKOrangTua;
        $namaOrangTua;
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;
            $namaOrangTua = $row->namaLengkap;
            $NIKOrangTua = $row->NIK;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        $hasil['NIKOrangTua'] = $NIKOrangTua;
        $hasil['namaOrangTua'] = $namaOrangTua;
        echo json_encode($hasil);

    }


    public function showDataUpdate_F26()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $NIKOrangTua;
        $namaOrangTua;
        $penghasilanOrangTua;
        $statusPenghasilanOrangTua;
        $keperluan;     
        $selectAllShop = $this->Home_model->getSelectData("*","f26_surat_keterangan_penghasilan_orangtua", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $NIKOrangTua = $row->NIKOrangTua;
            $namaOrangTua = $row->namaOrangTua;
            $penghasilanOrangTua = $row->penghasilanOrangTua;
            $statusPenghasilanOrangTua = $row->statusPenghasilanOrangTua;
            $keperluan = $row->keperluan;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['NIKOrangTua'] = $NIKOrangTua;
        $hasil['namaOrangTua'] = $namaOrangTua;
        $hasil['penghasilanOrangTua'] = $penghasilanOrangTua;
        $hasil['statusPenghasilanOrangTua'] = $statusPenghasilanOrangTua;
        $hasil['keperluan'] = $keperluan;
        echo json_encode($hasil);

    }



    public function showTable_F26()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f26_surat_keterangan_penghasilan_orangtua,penduduk", "WHERE f26_surat_keterangan_penghasilan_orangtua.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f26_surat_keterangan_penghasilan_orangtua,penduduk", "WHERE f26_surat_keterangan_penghasilan_orangtua.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f26_surat_keterangan_penghasilan_orangtua";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                $row->namaOrangTua,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f26_surat_keterangan_penghasilan_orangtua(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f26_surat_keterangan_penghasilan_orangtua('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f26_surat_keterangan_penghasilan_orangtua('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F26()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f26'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f26_surat_keterangan_penghasilan_orangtua", "WHERE f26_surat_keterangan_penghasilan_orangtua.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                    $NIKO = $row->NIKOrangTua;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['showDataOrtu'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIKO");


                
                $this->load->view('adminPage/f26_surat_keterangan_penghasilan_orangtua/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }




    //----------------Pelayanan Administrasi Umum - Permohonan Izin Keramaian Pesta - (F27) ----------------------


    public function f27_permohonan_izin_keramaian_pesta()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f27_permohonan_izin_keramaian_pesta";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f27_permohonan_izin_keramaian_pesta/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f27_permohonan_izin_keramaian_pesta_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f27_permohonan_izin_keramaian_pesta/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f27_permohonan_izin_keramaian_pesta()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $kepada = $this->input->post('kepada');
        $di = $this->input->post('di');
        $noTelepon = $this->input->post('noTelepon');
        $namaPesta = $this->input->post('namaPesta');
        $tanggalPesta = $this->input->post('tanggalPesta');
        $alamatPesta = $this->input->post('alamatPesta');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f27",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'kepada' => $kepada,
                              'di' => $di,
                              'noTelepon' => $noTelepon,
                              'namaPesta' => $namaPesta,
                              'tanggalPesta' => $tanggalPesta,
                              'alamatPesta' => $alamatPesta,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f27_permohonan_izin_keramaian_pesta' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f27_permohonan_izin_keramaian_pesta_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $kepada = $this->input->post('kepada');
        $di = $this->input->post('di');
        $noTelepon = $this->input->post('noTelepon');
        $namaPesta = $this->input->post('namaPesta');
        $tanggalPesta = $this->input->post('tanggalPesta');
        $alamatPesta = $this->input->post('alamatPesta');
        $randomCode = $this->input->post('randomCode');


                        $dataInput = array(
                              'kode_formulir' => "f27",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'kepada' => $kepada,
                              'di' => $di,
                              'noTelepon' => $noTelepon,
                              'namaPesta' => $namaPesta,
                              'tanggalPesta' => $tanggalPesta,
                              'alamatPesta' => $alamatPesta,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                                
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f27_permohonan_izin_keramaian_pesta' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f27_permohonan_izin_keramaian_pesta",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request permohonan izin keramaian pesta",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f27_permohonan_izin_keramaian_pesta()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $kepada = $this->input->post('kepada');
        $di = $this->input->post('di');
        $noTelepon = $this->input->post('noTelepon');
        $namaPesta = $this->input->post('namaPesta');
        $tanggalPesta = $this->input->post('tanggalPesta');
        $alamatPesta = $this->input->post('alamatPesta');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f27",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'kepada' => $kepada,
                              'di' => $di,
                              'noTelepon' => $noTelepon,
                              'namaPesta' => $namaPesta,
                              'tanggalPesta' => $tanggalPesta,
                              'alamatPesta' => $alamatPesta,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f27_permohonan_izin_keramaian_pesta' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f27_permohonan_izin_keramaian_pesta()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f27_permohonan_izin_keramaian_pesta' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F27()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F27()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $selectAllShop = $this->Home_model->getSelectData("*,UPPER(pekerjaan) pekT","penduduk", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        echo json_encode($hasil);

    }


    public function showDataUpdate_F27()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $kepada;
        $di;
        $noTelepon;
        $namaPesta;     
        $tanggalPesta;
        $alamatPesta;
        $selectAllShop = $this->Home_model->getSelectData("*","f27_permohonan_izin_keramaian_pesta", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            // tambahan
            $kepada = $row->kepada;
            $di = $row->di;
            $noTelepon = $row->noTelepon;
            $namaPesta = $row->namaPesta;
            $tanggalPesta = $row->tanggalPesta;
            $alamatPesta = $row->alamatPesta;
        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        // tambahan
        $hasil['kepada'] = $kepada;
        $hasil['di'] = $di;
        $hasil['noTelepon'] = $noTelepon;
        $hasil['namaPesta'] = $namaPesta;
        $hasil['tanggalPesta'] = $tanggalPesta;
        $hasil['alamatPesta'] = $alamatPesta;
        echo json_encode($hasil);

    }



    public function showTable_F27()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f27_permohonan_izin_keramaian_pesta,penduduk", "WHERE f27_permohonan_izin_keramaian_pesta.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f27_permohonan_izin_keramaian_pesta,penduduk", "WHERE f27_permohonan_izin_keramaian_pesta.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f27_permohonan_izin_keramaian_pesta";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }
            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                $row->namaPesta,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f27_permohonan_izin_keramaian_pesta(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f27_permohonan_izin_keramaian_pesta('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f27_permohonan_izin_keramaian_pesta('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F27()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f27'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f27_permohonan_izin_keramaian_pesta", "WHERE f27_permohonan_izin_keramaian_pesta.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");


                
                $this->load->view('adminPage/f27_permohonan_izin_keramaian_pesta/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }




    //---------------------Pelayanan Administrasi Umum - Surat Pengantar SKCK - (F28) ------------------------


    public function f28_surat_pengantar_SKCK()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f28_surat_pengantar_skck";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f28_surat_pengantar_SKCK/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f28_surat_pengantar_SKCK_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f28_surat_pengantar_SKCK/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f28_surat_pengantar_SKCK()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $suku = $this->input->post('suku');
        $kebangsaan = $this->input->post('kebangsaan');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f28",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'suku' => $suku,
                              'kebangsaan' => $kebangsaan,
                              'keperluan' => $keperluan,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f28_surat_pengantar_skck' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f28_surat_pengantar_SKCK_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $suku = $this->input->post('suku');
        $kebangsaan = $this->input->post('kebangsaan');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');


                        $dataInput = array(
                              'kode_formulir' => "f28",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'suku' => $suku,
                              'kebangsaan' => $kebangsaan,
                              'keperluan' => $keperluan,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                                
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f28_surat_pengantar_skck' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f28_surat_pengantar_SKCK",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat pengantar SKCK",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f28_surat_pengantar_SKCK()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $suku = $this->input->post('suku');
        $kebangsaan = $this->input->post('kebangsaan');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f28",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'suku' => $suku,
                              'kebangsaan' => $kebangsaan,
                              'keperluan' => $keperluan,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f28_surat_pengantar_skck' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f28_surat_pengantar_SKCK()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f28_surat_pengantar_skck' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F28()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F28()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;    
        $suku;
        $kebangsaan;
        $selectAllShop = $this->Home_model->getSelectData("*,UPPER(pekerjaan) pekT","penduduk", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;
            $umum = explode(";", $row->umum);
            $suku = $umum[4];
            $kebangsaan = $umum[3];

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        $hasil['suku'] = $suku;
        $hasil['kebangsaan'] = $kebangsaan;

        echo json_encode($hasil);

    }


    public function showDataUpdate_F28()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $suku;
        $kebangsaan;
        $keperluan;     
        $selectAllShop = $this->Home_model->getSelectData("*","f28_surat_pengantar_skck", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $suku = $row->suku;
            $kebangsaan = $row->kebangsaan;
            $keperluan = $row->keperluan;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['suku'] = $suku;
        $hasil['kebangsaan'] = $kebangsaan;
        $hasil['keperluan'] = $keperluan;
        echo json_encode($hasil);

    }



    public function showTable_F28()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f28_surat_pengantar_skck,penduduk", "WHERE f28_surat_pengantar_skck.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f28_surat_pengantar_skck,penduduk", "WHERE f28_surat_pengantar_skck.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f28_surat_pengantar_SKCK";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                $row->keperluan,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f28_surat_pengantar_SKCK(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f28_surat_pengantar_SKCK('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f28_surat_pengantar_SKCK('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F28()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f28'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f28_surat_pengantar_skck", "WHERE f28_surat_pengantar_SKCK.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");


                
                $this->load->view('adminPage/f28_surat_pengantar_SKCK/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }




    //-----------Pelayanan Administrasi Umum - Surat Keterangan Ahli Waris - (F29) --------------


    public function f29_surat_keterangan_ahli_waris()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f29_surat_keterangan_ahli_waris";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f29_surat_keterangan_ahli_waris/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f29_surat_keterangan_ahli_waris_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f29_surat_keterangan_ahli_waris/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f29_surat_keterangan_ahli_waris()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $NIKPewaris = $this->input->post('NIKPewaris');
        $namaPewaris = $this->input->post('namaPewaris');
        $tempatLahirPewaris = $this->input->post('tempatLahirPewaris');
        $tanggalLahirPewaris = $this->input->post('tanggalLahirPewaris');
        $jenisKelaminPewaris = $this->input->post('jenisKelaminPewaris');
        $statusPerkawinanPewaris = $this->input->post('statusPerkawinanPewaris');
        $hubunganAhliWaris = $this->input->post('hubunganAhliWaris');
        $alamatPewaris = $this->input->post('alamatPewaris');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f29",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'NIKPewaris' => $NIKPewaris,
                              'namaPewaris' => $namaPewaris,
                              'tempatLahirPewaris' => $tempatLahirPewaris,
                              'tanggalLahirPewaris' => $tanggalLahirPewaris,
                              'jenisKelaminPewaris' => $jenisKelaminPewaris,
                              'statusPerkawinanPewaris' => $statusPerkawinanPewaris,
                              'hubunganAhliWaris' => $hubunganAhliWaris,
                              'alamatPewaris' => $alamatPewaris,
                              'keperluan' => $keperluan,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f29_surat_keterangan_ahli_waris' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f29_surat_keterangan_ahli_waris_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $NIKPewaris = $this->input->post('NIKPewaris');
        $namaPewaris = $this->input->post('namaPewaris');
        $tempatLahirPewaris = $this->input->post('tempatLahirPewaris');
        $tanggalLahirPewaris = $this->input->post('tanggalLahirPewaris');
        $jenisKelaminPewaris = $this->input->post('jenisKelaminPewaris');
        $statusPerkawinanPewaris = $this->input->post('statusPerkawinanPewaris');
        $hubunganAhliWaris = $this->input->post('hubunganAhliWaris');
        $alamatPewaris = $this->input->post('alamatPewaris');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');


                        $dataInput = array(
                              'kode_formulir' => "f29",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'NIKPewaris' => $NIKPewaris,
                              'namaPewaris' => $namaPewaris,
                              'tempatLahirPewaris' => $tempatLahirPewaris,
                              'tanggalLahirPewaris' => $tanggalLahirPewaris,
                              'jenisKelaminPewaris' => $jenisKelaminPewaris,
                              'statusPerkawinanPewaris' => $statusPerkawinanPewaris,
                              'hubunganAhliWaris' => $hubunganAhliWaris,
                              'alamatPewaris' => $alamatPewaris,
                              'keperluan' => $keperluan,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                                
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f29_surat_keterangan_ahli_waris' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f29_surat_keterangan_ahli_waris",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan ahli waris",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f29_surat_keterangan_ahli_waris()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $NIKPewaris = $this->input->post('NIKPewaris');
        $namaPewaris = $this->input->post('namaPewaris');
        $tempatLahirPewaris = $this->input->post('tempatLahirPewaris');
        $tanggalLahirPewaris = $this->input->post('tanggalLahirPewaris');
        $jenisKelaminPewaris = $this->input->post('jenisKelaminPewaris');
        $statusPerkawinanPewaris = $this->input->post('statusPerkawinanPewaris');
        $hubunganAhliWaris = $this->input->post('hubunganAhliWaris');
        $alamatPewaris = $this->input->post('alamatPewaris');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'NIKPewaris' => $NIKPewaris,
                              'namaPewaris' => $namaPewaris,
                              'tempatLahirPewaris' => $tempatLahirPewaris,
                              'tanggalLahirPewaris' => $tanggalLahirPewaris,
                              'jenisKelaminPewaris' => $jenisKelaminPewaris,
                              'statusPerkawinanPewaris' => $statusPerkawinanPewaris,
                              'hubunganAhliWaris' => $hubunganAhliWaris,
                              'alamatPewaris' => $alamatPewaris,
                              'keperluan' => $keperluan,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f29_surat_keterangan_ahli_waris' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f29_surat_keterangan_ahli_waris()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f29_surat_keterangan_ahli_waris' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F29()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F29()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $tempatLahir;
        $tanggalLahir;
        $jenisKelamin;
        $statusPerkawinan;
        $alamatLengkap;
        $selectAllShop = $this->Home_model->getSelectData("*,LOWER(alamatLengkap)alamatL","penduduk", "WHERE penduduk.NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;
            // tambahan
            $tempatLahir = $row->tempatLahir;
            $tanggalLahir = $row->tanggalLahir;
            $jenisKelamin = $row->jenisKelamin;
            $statusPerkawinan = $row->statusPerkawinan;
            $alamatLengkap = $row->alamatL;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        $hasil['tempatLahirPewaris'] = $tempatLahir;
        $hasil['tanggalLahirPewaris'] = $tanggalLahir;
        $hasil['jenisKelaminPewaris'] = $jenisKelamin;
        $hasil['statusPerkawinanPewaris'] = $statusPerkawinan;
        $hasil['alamatPewaris'] = ucwords($alamatLengkap);
        echo json_encode($hasil);

    }


    public function showDataUpdate_F29()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $NIKPewaris;
        $namaPewaris;
        $tempatLahirPewaris;
        $tanggalLahirPewaris;
        $jenisKelaminPewaris;
        $statusPerkawinanPewaris;
        $hubunganAhliWaris;
        $alamatPewaris;
        $keperluan;     
        $selectAllShop = $this->Home_model->getSelectData("*","f29_surat_keterangan_ahli_waris", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $NIKPewaris = $row->NIKPewaris;
            $namaPewaris = $row->namaPewaris;
            $tempatLahirPewaris = $row->tempatLahirPewaris;
            $tanggalLahirPewaris = $row->tanggalLahirPewaris;
            $jenisKelaminPewaris = $row->jenisKelaminPewaris;
            $statusPerkawinanPewaris = $row->statusPerkawinanPewaris;
            $hubunganAhliWaris = $row->hubunganAhliWaris;
            $alamatPewaris = $row->alamatPewaris;
            $keperluan = $row->keperluan;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['NIKPewaris'] = $NIKPewaris;
        $hasil['namaPewaris'] = $namaPewaris;
        $hasil['tempatLahirPewaris'] = $tempatLahirPewaris;
        $hasil['tanggalLahirPewaris'] = $tanggalLahirPewaris;
        $hasil['jenisKelaminPewaris'] = $jenisKelaminPewaris;
        $hasil['statusPerkawinanPewaris'] = $statusPerkawinanPewaris;
        $hasil['hubunganAhliWaris'] = $hubunganAhliWaris;
        $hasil['alamatPewaris'] = $alamatPewaris;
        $hasil['keperluan'] = $keperluan;
        echo json_encode($hasil);

    }



    public function showTable_F29()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f29_surat_keterangan_ahli_waris,penduduk", "WHERE f29_surat_keterangan_ahli_waris.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f29_surat_keterangan_ahli_waris,penduduk", "WHERE f29_surat_keterangan_ahli_waris.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f29_surat_keterangan_ahli_waris";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                $row->namaPewaris,
                $row->hubunganAhliWaris,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f29_surat_keterangan_ahli_waris(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f29_surat_keterangan_ahli_waris('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f29_surat_keterangan_ahli_waris('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F29()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f29'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f29_surat_keterangan_ahli_waris", "WHERE f29_surat_keterangan_ahli_waris.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                    $NIKO = $row->NIKPewaris;

                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");

                $data['showDataPewaris'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIKO");


                
                $this->load->view('adminPage/f29_surat_keterangan_ahli_waris/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }




    //-------------------Pelayanan Administrasi Umum - Surat Keterangan Bepergian - (F30) ----------------------


    public function f30_surat_keterangan_bepergian()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f30_surat_keterangan_bepergian";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f30_surat_keterangan_bepergian/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f30_surat_keterangan_bepergian_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f30_surat_keterangan_bepergian/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f30_surat_keterangan_bepergian()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $alamatTujuan = $this->input->post('alamatTujuan');
        $desaKelurahan = $this->input->post('desaKelurahan');
        $kecamatan = $this->input->post('kecamatan');
        $kabupatenKota = $this->input->post('kabupatenKota');
        $provinsi = $this->input->post('provinsi');
        $tanggalPergi = $this->input->post('tanggalPergi');
        $tanggalPulang = $this->input->post('tanggalPulang');
        $alasanBepergian = $this->input->post('alasanBepergian');
        $keperluanSurat = $this->input->post('keperluanSurat');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f30",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'alamatTujuan' => $alamatTujuan,
                              'desaKelurahan' => $desaKelurahan,
                              'kecamatan' => $kecamatan,
                              'kabupatenKota' => $kabupatenKota,
                              'provinsi' => $provinsi,
                              'tanggalPergi' => $tanggalPergi,
                              'tanggalPulang' => $tanggalPulang,
                              'alasanBepergian' => $alasanBepergian,
                              'keperluanSurat' => $keperluanSurat,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f30_surat_keterangan_bepergian' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f30_surat_keterangan_bepergian_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $alamatTujuan = $this->input->post('alamatTujuan');
        $desaKelurahan = $this->input->post('desaKelurahan');
        $kecamatan = $this->input->post('kecamatan');
        $kabupatenKota = $this->input->post('kabupatenKota');
        $provinsi = $this->input->post('provinsi');
        $tanggalPergi = $this->input->post('tanggalPergi');
        $tanggalPulang = $this->input->post('tanggalPulang');
        $alasanBepergian = $this->input->post('alasanBepergian');
        $keperluanSurat = $this->input->post('keperluanSurat');
        $randomCode = $this->input->post('randomCode');
       


                        $dataInput = array(
                              'kode_formulir' => "f30",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'alamatTujuan' => $alamatTujuan,
                              'desaKelurahan' => $desaKelurahan,
                              'kecamatan' => $kecamatan,
                              'kabupatenKota' => $kabupatenKota,
                              'provinsi' => $provinsi,
                              'tanggalPergi' => $tanggalPergi,
                              'tanggalPulang' => $tanggalPulang,
                              'alasanBepergian' => $alasanBepergian,
                              'keperluanSurat' => $keperluanSurat,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                                
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f30_surat_keterangan_bepergian' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f30_surat_keterangan_bepergian",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan bepergian",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f30_surat_keterangan_bepergian()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $alamatTujuan = $this->input->post('alamatTujuan');
        $desaKelurahan = $this->input->post('desaKelurahan');
        $kecamatan = $this->input->post('kecamatan');
        $kabupatenKota = $this->input->post('kabupatenKota');
        $provinsi = $this->input->post('provinsi');
        $tanggalPergi = $this->input->post('tanggalPergi');
        $tanggalPulang = $this->input->post('tanggalPulang');
        $alasanBepergian = $this->input->post('alasanBepergian');
        $keperluanSurat = $this->input->post('keperluanSurat');
       
                        $dataInput = array(
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'alamatTujuan' => $alamatTujuan,
                              'desaKelurahan' => $desaKelurahan,
                              'kecamatan' => $kecamatan,
                              'kabupatenKota' => $kabupatenKota,
                              'provinsi' => $provinsi,
                              'tanggalPergi' => $tanggalPergi,
                              'tanggalPulang' => $tanggalPulang,
                              'alasanBepergian' => $alasanBepergian,
                              'keperluanSurat' => $keperluanSurat,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f30_surat_keterangan_bepergian' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f30_surat_keterangan_bepergian()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f30_surat_keterangan_bepergian' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F30()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F30()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;    
        $selectAllShop = $this->Home_model->getSelectData("*,UPPER(pekerjaan) pekT","penduduk", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        echo json_encode($hasil);

    }


    public function showDataUpdate_F30()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $alamatTujuan;
        $desaKelurahan;
        $kecamatan;
        $kabupatenKota;
        $provinsi;
        $tanggalPergi;
        $tanggalPulang;
        $alasanBepergian;
        $keperluanSurat;     
        $selectAllShop = $this->Home_model->getSelectData("*","f30_surat_keterangan_bepergian", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $alamatTujuan = $row->alamatTujuan;
            $desaKelurahan = $row->desaKelurahan;
            $kecamatan = $row->kecamatan;
            $kabupatenKota = $row->kabupatenKota;
            $provinsi = $row->provinsi;
            $tanggalPergi = $row->tanggalPergi;
            $tanggalPulang = $row->tanggalPulang;
            $alasanBepergian = $row->alasanBepergian;
            $keperluanSurat = $row->keperluanSurat;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['alamatTujuan'] = $alamatTujuan;
        $hasil['desaKelurahan'] = $desaKelurahan;
        $hasil['kecamatan'] = $kecamatan;
        $hasil['kabupatenKota'] = $kabupatenKota;
        $hasil['provinsi'] = $provinsi;
        $hasil['tanggalPergi'] = $tanggalPergi;
        $hasil['tanggalPulang'] = $tanggalPulang;
        $hasil['alasanBepergian'] = $alasanBepergian;
        $hasil['keperluanSurat'] = $keperluanSurat;
        echo json_encode($hasil);

    }



    public function showTable_F30()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f30_surat_keterangan_bepergian,penduduk", "WHERE f30_surat_keterangan_bepergian.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f30_surat_keterangan_bepergian,penduduk", "WHERE f30_surat_keterangan_bepergian.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f30_surat_keterangan_bepergian";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                $row->tanggalPergi,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f30_surat_keterangan_bepergian(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f30_surat_keterangan_bepergian('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f30_surat_keterangan_bepergian('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F30()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f30'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f30_surat_keterangan_bepergian", "WHERE f30_surat_keterangan_bepergian.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");


                
                $this->load->view('adminPage/f30_surat_keterangan_bepergian/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }





    //------------------Pelayanan Administrasi Umum - Surat Keterangan Beda Identitas - (F32) ---------------------


    public function f32_surat_keterangan_beda_identitas()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f32_surat_keterangan_beda_identitas";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f32_surat_keterangan_beda_identitas/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f32_surat_keterangan_beda_identitas_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f32_surat_keterangan_beda_identitas/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f32_surat_keterangan_beda_identitas()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $namaLain = $this->input->post('namaLain');
        $tempatLahirLain = $this->input->post('tempatLahirLain');
        $tanggalLahirLain = $this->input->post('tanggalLahirLain');
        $alamatLain = $this->input->post('alamatLain');
        $buktiBerupa = $this->input->post('buktiBerupa');
        $denganNomor = $this->input->post('denganNomor');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f32",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'namaLain' => $namaLain,
                              'tempatLahirLain' => $tempatLahirLain,
                              'tanggalLahirLain' => $tanggalLahirLain,
                              'alamatLain' => $alamatLain,
                              'buktiBerupa' => $buktiBerupa,
                              'denganNomor' => $denganNomor,
                              'keperluan' => $keperluan,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f32_surat_keterangan_beda_identitas' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }
    public function add_f32_surat_keterangan_beda_identitas_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $namaLain = $this->input->post('namaLain');
        $tempatLahirLain = $this->input->post('tempatLahirLain');
        $tanggalLahirLain = $this->input->post('tanggalLahirLain');
        $alamatLain = $this->input->post('alamatLain');
        $buktiBerupa = $this->input->post('buktiBerupa');
        $denganNomor = $this->input->post('denganNomor');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       


                        $dataInput = array(
                              'kode_formulir' => "f32",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'namaLain' => $namaLain,
                              'tempatLahirLain' => $tempatLahirLain,
                              'tanggalLahirLain' => $tanggalLahirLain,
                              'alamatLain' => $alamatLain,
                              'buktiBerupa' => $buktiBerupa,
                              'denganNomor' => $denganNomor,
                              'keperluan' => $keperluan,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                                
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f32_surat_keterangan_beda_identitas' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f32_surat_keterangan_beda_identitas",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan beda identitas",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f32_surat_keterangan_beda_identitas()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $namaLain = $this->input->post('namaLain');
        $tempatLahirLain = $this->input->post('tempatLahirLain');
        $tanggalLahirLain = $this->input->post('tanggalLahirLain');
        $alamatLain = $this->input->post('alamatLain');
        $buktiBerupa = $this->input->post('buktiBerupa');
        $denganNomor = $this->input->post('denganNomor');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f32",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'namaLain' => $namaLain,
                              'tempatLahirLain' => $tempatLahirLain,
                              'tanggalLahirLain' => $tanggalLahirLain,
                              'alamatLain' => $alamatLain,
                              'buktiBerupa' => $buktiBerupa,
                              'denganNomor' => $denganNomor,
                              'keperluan' => $keperluan,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f32_surat_keterangan_beda_identitas' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f32_surat_keterangan_beda_identitas()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f32_surat_keterangan_beda_identitas' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F32()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F32()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $tempatLahirLain;
        $tanggalLahirLain;
        $alamatLain;
        $selectAllShop = $this->Home_model->getSelectData("*,UPPER(pekerjaan) pekT, LOWER(alamatLengkap)alamatL","penduduk", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;
            // tambahan
            $alamatLain = $row->alamatL;
            $tempatLahirLain = $row->tempatLahir;
            $tanggalLahirLain = $row->tanggalLahir;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        // tambahan
        $hasil['alamatLain'] = $alamatLain;
        $hasil['tempatLahirLain'] = $tempatLahirLain;
        $hasil['tanggalLahirLain'] = $tanggalLahirLain;
        echo json_encode($hasil);

    }


    public function showDataUpdate_F32()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $namaLain;
        $tempatLahirLain;
        $tanggalLahirLain;
        $alamatLain;
        $buktiBerupa;
        $denganNomor;
        $keperluan;     
        $selectAllShop = $this->Home_model->getSelectData("*","f32_surat_keterangan_beda_identitas", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $namaLain = $row->namaLain;
            $tempatLahirLain = $row->tempatLahirLain;
            $tanggalLahirLain = $row->tanggalLahirLain;
            $alamatLain = $row->alamatLain;
            $buktiBerupa = $row->buktiBerupa;
            $denganNomor = $row->denganNomor; 
            $keperluan = $row->keperluan;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['namaLain'] = $namaLain;
        $hasil['tempatLahirLain'] = $tempatLahirLain;
        $hasil['tanggalLahirLain'] = $tanggalLahirLain;
        $hasil['alamatLain'] = $alamatLain;
        $hasil['buktiBerupa'] = $buktiBerupa;
        $hasil['denganNomor'] = $denganNomor;
        $hasil['keperluan'] = $keperluan;
        echo json_encode($hasil);

    }



    public function showTable_F32()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f32_surat_keterangan_beda_identitas,penduduk", "WHERE f32_surat_keterangan_beda_identitas.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f32_surat_keterangan_beda_identitas,penduduk", "WHERE f32_surat_keterangan_beda_identitas.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f32_surat_keterangan_beda_identitas";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                $row->namaLain,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f32_surat_keterangan_beda_identitas(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f32_surat_keterangan_beda_identitas('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f32_surat_keterangan_beda_identitas('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F32()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f32'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f32_surat_keterangan_beda_identitas", "WHERE f32_surat_keterangan_beda_identitas.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL","penduduk", "WHERE penduduk.NIK=$NIK");


                
                $this->load->view('adminPage/f32_surat_keterangan_beda_identitas/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }




    //----------------Pelayanan Administrasi Umum - Surat Keterangan Lainnya - (F33) ----------------------


    public function f33_surat_keterangan_lainnya()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f33_surat_keterangan_lainnya";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f33_surat_keterangan_lainnya/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f33_surat_keterangan_lainnya_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f33_surat_keterangan_lainnya/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f33_surat_keterangan_lainnya()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $judulSurat = $this->input->post('judulSurat');
        $keterangan = $this->input->post('keterangan');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f33",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'judulSurat' => $judulSurat,
                              'keterangan' => $keterangan,
                              'keperluan' => $keperluan,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f33_surat_keterangan_lainnya' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f33_surat_keterangan_lainnya_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $judulSurat = $this->input->post('judulSurat');
        $keterangan = $this->input->post('keterangan');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       


                        $dataInput = array(
                              'kode_formulir' => "f33",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'judulSurat' => $judulSurat,
                              'keterangan' => $keterangan,
                              'keperluan' => $keperluan,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                                
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f33_surat_keterangan_lainnya' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f33_surat_keterangan_lainnya",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan lainnya",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f33_surat_keterangan_lainnya()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $judulSurat = $this->input->post('judulSurat');
        $keterangan = $this->input->post('keterangan');
        $keperluan = $this->input->post('keperluan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f33",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'judulSurat' => $judulSurat,
                              'keterangan' => $keterangan,
                              'keperluan' => $keperluan,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f33_surat_keterangan_lainnya' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f33_surat_keterangan_lainnya()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f33_surat_keterangan_lainnya' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F33()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F33()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $selectAllShop = $this->Home_model->getSelectData("*,UPPER(pekerjaan) pekT","penduduk", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        echo json_encode($hasil);

    }


    public function showDataUpdate_F33()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $judulSurat;
        $keterangan;
        $keperluan;
        $selectAllShop = $this->Home_model->getSelectData("*,f33_surat_keterangan_lainnya.keterangan ketx","f33_surat_keterangan_lainnya", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            // tambahan
            $judulSurat = $row->judulSurat;
            $keterangan = $row->ketx;
            $keperluan = $row->keperluan;
        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        // tambahan
        $hasil['judulSurat'] = $judulSurat;
        $hasil['keterangan'] = $keterangan;
        $hasil['keperluan'] = $keperluan;
        echo json_encode($hasil);

    }



    public function showTable_F33()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f33_surat_keterangan_lainnya,penduduk", "WHERE f33_surat_keterangan_lainnya.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*,f33_surat_keterangan_lainnya.keterangan ketx","f33_surat_keterangan_lainnya,penduduk", "WHERE f33_surat_keterangan_lainnya.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f33_surat_keterangan_lainnya";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->judulSurat,
                $row->nama,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f33_surat_keterangan_lainnya(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f33_surat_keterangan_lainnya('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f33_surat_keterangan_lainnya('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F33()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f33'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f33_surat_keterangan_lainnya", "WHERE f33_surat_keterangan_lainnya.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");


                
                $this->load->view('adminPage/f33_surat_keterangan_lainnya/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }




    //----------------Pelayanan Administrasi Pertanahan - Surat Keterangan Pencocokan - (F34) --------------


    public function f34_surat_keterangan_pencocokan()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['dataDusun'] = $this->Home_model->getSelectData("*, UPPER(namaDusun) dusX","o_data_dusun", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f34_surat_keterangan_pencocokan";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f34_surat_keterangan_pencocokan/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f34_surat_keterangan_pencocokan_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
                $data['dataDusun'] = $this->Home_model->getSelectData("*, UPPER(namaDusun) dusX","o_data_dusun", "");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f34_surat_keterangan_pencocokan/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f34_surat_keterangan_pencocokan()
    {   
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $pekerjaan = $this->input->post('pekerjaan');
        $alamat = $this->input->post('alamat');
        $statusHakTanah = $this->input->post('statusHakTanah');
        $sejakTahun = $this->input->post('sejakTahun');
        $petugasPemeriksa = $this->input->post('petugasPemeriksa');
        $hasilPencocokan = $this->input->post('hasilPencocokan');
        $namadiSPPT = $this->input->post('namadiSPPT');
        $tahunSPPT = $this->input->post('tahunSPPT');
        $nomorSPPT = $this->input->post('nomorSPPT');
        $batasUtara = $this->input->post('batasUtara');
        $batasTimur = $this->input->post('batasTimur');
        $batasSelatan = $this->input->post('batasSelatan');
        $batasBarat = $this->input->post('batasBarat');
        $dusun = $this->input->post('dusun');
        $luasTanah = $this->input->post('luasTanah');
        $penggunaanTanah = $this->input->post('penggunaanTanah');
        $keteranganTambahan = $this->input->post('keteranganTambahan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f34",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'pekerjaan' => $pekerjaan,
                              'alamat' => $alamat,
                              'statusHakTanah' => $statusHakTanah,
                              'sejakTahun' => $sejakTahun,
                              'petugasPemeriksa' => $petugasPemeriksa,
                              'hasilPencocokan' => $hasilPencocokan,
                              'namadiSPPT' => $namadiSPPT,
                              'tahunSPPT' => $tahunSPPT,
                              'nomorSPPT' => $nomorSPPT,
                              'batasUtara' => $batasUtara,
                              'batasTimur' => $batasTimur,
                              'batasSelatan' => $batasSelatan,
                              'batasBarat' => $batasBarat,
                              'dusun' => $dusun,
                              'luasTanah' => $luasTanah,
                              'penggunaanTanah' => $penggunaanTanah,
                              'keteranganTambahan' => $keteranganTambahan,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f34_surat_keterangan_pencocokan' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f34_surat_keterangan_pencocokan_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $pekerjaan = $this->input->post('pekerjaan');
        $alamat = $this->input->post('alamat');
        $statusHakTanah = $this->input->post('statusHakTanah');
        $sejakTahun = $this->input->post('sejakTahun');
        $petugasPemeriksa = $this->input->post('petugasPemeriksa');
        $hasilPencocokan = $this->input->post('hasilPencocokan');
        $namadiSPPT = $this->input->post('namadiSPPT');
        $tahunSPPT = $this->input->post('tahunSPPT');
        $nomorSPPT = $this->input->post('nomorSPPT');
        $batasUtara = $this->input->post('batasUtara');
        $batasTimur = $this->input->post('batasTimur');
        $batasSelatan = $this->input->post('batasSelatan');
        $batasBarat = $this->input->post('batasBarat');
        $dusun = $this->input->post('dusun');
        $luasTanah = $this->input->post('luasTanah');
        $penggunaanTanah = $this->input->post('penggunaanTanah');
        $keteranganTambahan = $this->input->post('keteranganTambahan');
        $randomCode = $this->input->post('randomCode');
       


                        $dataInput = array(
                              'kode_formulir' => "f34",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'pekerjaan' => $pekerjaan,
                              'alamat' => $alamat,
                              'statusHakTanah' => $statusHakTanah,
                              'sejakTahun' => $sejakTahun,
                              'petugasPemeriksa' => $petugasPemeriksa,
                              'hasilPencocokan' => $hasilPencocokan,
                              'namadiSPPT' => $namadiSPPT,
                              'tahunSPPT' => $tahunSPPT,
                              'nomorSPPT' => $nomorSPPT,
                              'batasUtara' => $batasUtara,
                              'batasTimur' => $batasTimur,
                              'batasSelatan' => $batasSelatan,
                              'batasBarat' => $batasBarat,
                              'dusun' => $dusun,
                              'luasTanah' => $luasTanah,
                              'penggunaanTanah' => $penggunaanTanah,
                              'keteranganTambahan' => $keteranganTambahan,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                                
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f34_surat_keterangan_pencocokan' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f34_surat_keterangan_pencocokan",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan pencocokan",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f34_surat_keterangan_pencocokan()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $pekerjaan = $this->input->post('pekerjaan');
        $alamat = $this->input->post('alamat');
        $statusHakTanah = $this->input->post('statusHakTanah');
        $sejakTahun = $this->input->post('sejakTahun');
        $petugasPemeriksa = $this->input->post('petugasPemeriksa');
        $hasilPencocokan = $this->input->post('hasilPencocokan');
        $namadiSPPT = $this->input->post('namadiSPPT');
        $tahunSPPT = $this->input->post('tahunSPPT');
        $nomorSPPT = $this->input->post('nomorSPPT');
        $batasUtara = $this->input->post('batasUtara');
        $batasTimur = $this->input->post('batasTimur');
        $batasSelatan = $this->input->post('batasSelatan');
        $batasBarat = $this->input->post('batasBarat');
        $dusun = $this->input->post('dusun');
        $luasTanah = $this->input->post('luasTanah');
        $penggunaanTanah = $this->input->post('penggunaanTanah');
        $keteranganTambahan = $this->input->post('keteranganTambahan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'pekerjaan' => $pekerjaan,
                              'alamat' => $alamat,
                              'statusHakTanah' => $statusHakTanah,
                              'sejakTahun' => $sejakTahun,
                              'petugasPemeriksa' => $petugasPemeriksa,
                              'hasilPencocokan' => $hasilPencocokan,
                              'namadiSPPT' => $namadiSPPT,
                              'tahunSPPT' => $tahunSPPT,
                              'nomorSPPT' => $nomorSPPT,
                              'batasUtara' => $batasUtara,
                              'batasTimur' => $batasTimur,
                              'batasSelatan' => $batasSelatan,
                              'batasBarat' => $batasBarat,
                              'dusun' => $dusun,
                              'luasTanah' => $luasTanah,
                              'penggunaanTanah' => $penggunaanTanah,
                              'keteranganTambahan' => $keteranganTambahan,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f34_surat_keterangan_pencocokan' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f34_surat_keterangan_pencocokan()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f34_surat_keterangan_pencocokan' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F34()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F34()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $pekerjaan;
        $alamatL;
        $selectAllShop = $this->Home_model->getSelectData("*,UPPER(pekerjaan)pekT","penduduk", "WHERE penduduk.NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;
            $pekerjaan = $row->pekT;
            $alamatL = $row->alamatLengkap;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        $hasil['pekerjaan'] = $pekerjaan;
        $hasil['alamatL'] = strtolower($alamatL);
        echo json_encode($hasil);

    }


    public function showDataUpdate_F34()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $noSurat;
        $NIKKepalaKeluarga;
        $namaKepalaKeluarga;
        $pekerjaan;
        $alamat;
        $statusHakTanah;
        $sejakTahun;
        $petugasPemeriksa;
        $hasilPencocokan;
        $namadiSPPT;
        $tahunSPPT;
        $nomorSPPT;
        $batasUtara;
        $batasTimur;
        $batasSelatan;
        $batasBarat;
        $dusun;
        $luasTanah;
        $penggunaanTanah;
        $keteranganTambahan;   
        $selectAllShop = $this->Home_model->getSelectData("*","f34_surat_keterangan_pencocokan", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $pekerjaan = $row->pekerjaan;
            $alamat = $row->alamat;
            $statusHakTanah = $row->statusHakTanah;
            $sejakTahun = $row->sejakTahun;
            $petugasPemeriksa = $row->petugasPemeriksa;
            $hasilPencocokan = $row->hasilPencocokan;
            $namadiSPPT = $row->namadiSPPT;
            $tahunSPPT = $row->tahunSPPT;
            $nomorSPPT = $row->nomorSPPT;
            $batasUtara = $row->batasUtara;
            $batasTimur = $row->batasTimur;
            $batasSelatan = $row->batasSelatan;
            $batasBarat = $row->batasBarat;
            $dusun = $row->dusun;
            $luasTanah = $row->luasTanah;
            $penggunaanTanah = $row->penggunaanTanah;
            $keteranganTambahan = $row->keteranganTambahan;  

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['pekerjaan'] = $pekerjaan;
        $hasil['alamat'] = $alamat;
        $hasil['statusHakTanah'] = $statusHakTanah;
        $hasil['sejakTahun'] = $sejakTahun;
        $hasil['petugasPemeriksa'] = $petugasPemeriksa;
        $hasil['hasilPencocokan'] = $hasilPencocokan;
        $hasil['namadiSPPT'] = $namadiSPPT;
        $hasil['tahunSPPT'] = $tahunSPPT;
        $hasil['nomorSPPT'] = $nomorSPPT;
        $hasil['batasUtara'] = $batasUtara;
        $hasil['batasTimur'] = $batasTimur;
        $hasil['batasSelatan'] = $batasSelatan;
        $hasil['batasBarat'] = $batasBarat;
        $hasil['dusun'] = $dusun;
        $hasil['luasTanah'] = $luasTanah;
        $hasil['penggunaanTanah'] = $penggunaanTanah;
        $hasil['keteranganTambahan'] = $keteranganTambahan;
        echo json_encode($hasil);

    }



    public function showTable_F34()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f34_surat_keterangan_pencocokan,penduduk", "WHERE f34_surat_keterangan_pencocokan.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f34_surat_keterangan_pencocokan,penduduk", "WHERE f34_surat_keterangan_pencocokan.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f34_surat_keterangan_pencocokan";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                $row->luasTanah,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f34_surat_keterangan_pencocokan(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f34_surat_keterangan_pencocokan('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f34_surat_keterangan_pencocokan('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F34()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f34'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f34_surat_keterangan_pencocokan", "WHERE f34_surat_keterangan_pencocokan.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");

                
                $this->load->view('adminPage/f34_surat_keterangan_pencocokan/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }




    //----------------Pelayanan Administrasi Pertanahan - Sporandik - (F35) --------------


    public function f35_sporandik()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['dataDusun'] = $this->Home_model->getSelectData("*, UPPER(namaDusun) dusX","o_data_dusun", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f35_sporandik";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f35_sporandik/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }
    public function f35_sporandik_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
                $data['dataDusun'] = $this->Home_model->getSelectData("*, UPPER(namaDusun) dusX","o_data_dusun", "");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f35_sporandik/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f35_sporandik()
    {   
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');

        //data umum
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $pekerjaan = $this->input->post('pekerjaan');
        $alamat = $this->input->post('alamat');
        
        //data tanah
        $namadiSPPT = $this->input->post('namadiSPPT');
        $tahunSPPT = $this->input->post('tahunSPPT');
        $nomorSPPT = $this->input->post('nomorSPPT');
        $batasUtara = $this->input->post('batasUtara');
        $batasTimur = $this->input->post('batasTimur');
        $batasSelatan = $this->input->post('batasSelatan');
        $batasBarat = $this->input->post('batasBarat');
        $jalan = $this->input->post('jalan');
        $rtRW = $this->input->post('rtRW');
        $dusun = $this->input->post('dusun');
        $penggunaanTanah = $this->input->post('penggunaanTanah');
        $panjangTanah = $this->input->post('panjangTanah');
        $lebarTanah = $this->input->post('lebarTanah');
        $luasTanah = $this->input->post('luasTanah');
        $luasAsalTanah = $this->input->post('luasAsalTanah');
        $riwayatTanah = $this->input->post('riwayatTanah');

        //data saksi1
        $namaSaksi1 = $this->input->post('namaSaksi1');
        $umurSaksi1 = $this->input->post('umurSaksi1');
        $pekerjaanSaksi1 = $this->input->post('pekerjaanSaksi1');
        $alamatSaksi1 = $this->input->post('alamatSaksi1');

        //data saksi2
        $namaSaksi2 = $this->input->post('namaSaksi2');
        $umurSaksi2 = $this->input->post('umurSaksi2');
        $pekerjaanSaksi2 = $this->input->post('pekerjaanSaksi2');
        $alamatSaksi2 = $this->input->post('alamatSaksi2');

        $randomCode = $this->input->post('randomCode');

       
                        $dataInput = array(
                              'kode_formulir' => "f35",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                              'dataUmum' => $tempatLahir.";".$tanggalLahir.";".$pekerjaan.";".$alamat,
                              'dataTanah' => $namadiSPPT.";".$tahunSPPT.";".$nomorSPPT.";".$batasUtara.";".$batasTimur.";".$batasSelatan.";".$batasBarat.";".$jalan.";".$rtRW.";".$dusun.";".$penggunaanTanah.";".$panjangTanah.";".$lebarTanah.";".$luasTanah.";".$luasAsalTanah.";".$riwayatTanah,
                              'dataSaksi1' => $namaSaksi1.";".$umurSaksi1.";".$pekerjaanSaksi1.";".$alamatSaksi1,
                              'dataSaksi2' => $namaSaksi2.";".$umurSaksi2.";".$pekerjaanSaksi2.";".$alamatSaksi2,
                            );
                        
                        $simpan = $this->Home_model->insertData('f35_sporandik' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f35_sporandik_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');

        //data umum
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $pekerjaan = $this->input->post('pekerjaan');
        $alamat = $this->input->post('alamat');
        
        //data tanah
        $namadiSPPT = $this->input->post('namadiSPPT');
        $tahunSPPT = $this->input->post('tahunSPPT');
        $nomorSPPT = $this->input->post('nomorSPPT');
        $batasUtara = $this->input->post('batasUtara');
        $batasTimur = $this->input->post('batasTimur');
        $batasSelatan = $this->input->post('batasSelatan');
        $batasBarat = $this->input->post('batasBarat');
        $jalan = $this->input->post('jalan');
        $rtRW = $this->input->post('rtRW');
        $dusun = $this->input->post('dusun');
        $penggunaanTanah = $this->input->post('penggunaanTanah');
        $panjangTanah = $this->input->post('panjangTanah');
        $lebarTanah = $this->input->post('lebarTanah');
        $luasTanah = $this->input->post('luasTanah');
        $luasAsalTanah = $this->input->post('luasAsalTanah');
        $riwayatTanah = $this->input->post('riwayatTanah');

        //data saksi1
        $namaSaksi1 = $this->input->post('namaSaksi1');
        $umurSaksi1 = $this->input->post('umurSaksi1');
        $pekerjaanSaksi1 = $this->input->post('pekerjaanSaksi1');
        $alamatSaksi1 = $this->input->post('alamatSaksi1');

        //data saksi2
        $namaSaksi2 = $this->input->post('namaSaksi2');
        $umurSaksi2 = $this->input->post('umurSaksi2');
        $pekerjaanSaksi2 = $this->input->post('pekerjaanSaksi2');
        $alamatSaksi2 = $this->input->post('alamatSaksi2');

        $randomCode = $this->input->post('randomCode');
       


                        $dataInput = array(
                              'kode_formulir' => "f35",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              'dataUmum' => $tempatLahir.";".$tanggalLahir.";".$pekerjaan.";".$alamat,
                              'dataTanah' => $namadiSPPT.";".$tahunSPPT.";".$nomorSPPT.";".$batasUtara.";".$batasTimur.";".$batasSelatan.";".$batasBarat.";".$jalan.";".$rtRW.";".$dusun.";".$penggunaanTanah.";".$panjangTanah.";".$lebarTanah.";".$luasTanah.";".$luasAsalTanah.";".$riwayatTanah,
                              'dataSaksi1' => $namaSaksi1.";".$umurSaksi1.";".$pekerjaanSaksi1.";".$alamatSaksi1,
                              'dataSaksi2' => $namaSaksi2.";".$umurSaksi2.";".$pekerjaanSaksi2.";".$alamatSaksi2,
                                
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f35_sporandik' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f35_sporandik",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat soprandik",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f35_sporandik()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        
        //data umum
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $pekerjaan = $this->input->post('pekerjaan');
        $alamat = $this->input->post('alamat');
        
        //data tanah
        $namadiSPPT = $this->input->post('namadiSPPT');
        $tahunSPPT = $this->input->post('tahunSPPT');
        $nomorSPPT = $this->input->post('nomorSPPT');
        $batasUtara = $this->input->post('batasUtara');
        $batasTimur = $this->input->post('batasTimur');
        $batasSelatan = $this->input->post('batasSelatan');
        $batasBarat = $this->input->post('batasBarat');
        $jalan = $this->input->post('jalan');
        $rtRW = $this->input->post('rtRW');
        $dusun = $this->input->post('dusun');
        $penggunaanTanah = $this->input->post('penggunaanTanah');
        $panjangTanah = $this->input->post('panjangTanah');
        $lebarTanah = $this->input->post('lebarTanah');
        $luasTanah = $this->input->post('luasTanah');
        $luasAsalTanah = $this->input->post('luasAsalTanah');
        $riwayatTanah = $this->input->post('riwayatTanah');

        //data saksi1
        $namaSaksi1 = $this->input->post('namaSaksi1');
        $umurSaksi1 = $this->input->post('umurSaksi1');
        $pekerjaanSaksi1 = $this->input->post('pekerjaanSaksi1');
        $alamatSaksi1 = $this->input->post('alamatSaksi1');

        //data saksi2
        $namaSaksi2 = $this->input->post('namaSaksi2');
        $umurSaksi2 = $this->input->post('umurSaksi2');
        $pekerjaanSaksi2 = $this->input->post('pekerjaanSaksi2');
        $alamatSaksi2 = $this->input->post('alamatSaksi2');

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'dataUmum' => $tempatLahir.";".$tanggalLahir.";".$pekerjaan.";".$alamat,
                              'dataTanah' => $namadiSPPT.";".$tahunSPPT.";".$nomorSPPT.";".$batasUtara.";".$batasTimur.";".$batasSelatan.";".$batasBarat.";".$jalan.";".$rtRW.";".$dusun.";".$penggunaanTanah.";".$panjangTanah.";".$lebarTanah.";".$luasTanah.";".$luasAsalTanah.";".$riwayatTanah,
                              'dataSaksi1' => $namaSaksi1.";".$umurSaksi1.";".$pekerjaanSaksi1.";".$alamatSaksi1,
                              'dataSaksi2' => $namaSaksi2.";".$umurSaksi2.";".$pekerjaanSaksi2.";".$alamatSaksi2,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f35_sporandik' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f35_sporandik()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f35_sporandik' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F35()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F35()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $tempatLahir;
        $tanggalLahir;
        $umur;
        $pekerjaan;
        $alamatL;
        $selectAllShop = $this->Home_model->getSelectData("*,UPPER(pekerjaan)pekT,TIMESTAMPDIFF(YEAR,tanggalLahir,CURDATE()) as umur","penduduk", "WHERE penduduk.NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $tempatLahir = $row->tempatLahir;
            $tanggalLahir = $row->tanggalLahir;
            $umur = $row->umur;
            $pekerjaan = $row->pekT;
            $alamatL = $row->alamatLengkap;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['tempatLahir'] = $tempatLahir;
        $hasil['tanggalLahir'] = $tanggalLahir;
        $hasil['umur'] = $umur;
        $hasil['pekerjaan'] = $pekerjaan;
        $hasil['alamatL'] = strtolower($alamatL);
        echo json_encode($hasil);

    }


    


    public function showTable_F35()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f35_sporandik,penduduk", "WHERE f35_sporandik.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f35_sporandik,penduduk", "WHERE f35_sporandik.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f35_sporandik";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $dataTanah = explode(";", $row->dataTanah);

                        $luasTanah = $dataTanah[13];
            // $selectAllShopDataAyah = $this->Home_model->getSelectData("*","penduduk", "WHERE  penduduk.NIK=$dataAyahGet");

            // $namaayah = "";
            // foreach ($selectAllShopDataAyah->result() as $rowx) {
            //     $namaayah = $rowx->namaLengkap;
            // }

            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                $luasTanah,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f35_sporandik(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f35_sporandik('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\',\''.$row->nomorKK.'\',\''.$row->nama.'\',\''.$row->dataUmum.'\',\''.$row->dataTanah.'\',\''.$row->dataSaksi1.'\',\''.$row->dataSaksi2.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f35_sporandik('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F35()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f35'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f35_sporandik", "WHERE f35_sporandik.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");

                
                $this->load->view('adminPage/f35_sporandik/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }





    //-------------Pelayanan Administrasi Pertanahan - Surat Keterangan Kepemilikan Tanah - (F36) --------------


    public function f36_surat_keterangan_kepemilikan_tanah()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['dataDusun'] = $this->Home_model->getSelectData("*, UPPER(namaDusun) dusX","o_data_dusun", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f36_surat_keterangan_kepemilikan_tanah";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f36_surat_keterangan_kepemilikan_tanah/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f36_surat_keterangan_kepemilikan_tanah_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
                $data['dataDusun'] = $this->Home_model->getSelectData("*, UPPER(namaDusun) dusX","o_data_dusun", "");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f36_surat_keterangan_kepemilikan_tanah/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f36_surat_keterangan_kepemilikan_tanah()
    {   
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $pekerjaan = $this->input->post('pekerjaan');
        $namadiSPPT = $this->input->post('namadiSPPT');
        $tahunSPPT = $this->input->post('tahunSPPT');
        $nomorSPPT = $this->input->post('nomorSPPT');
        $batasUtara = $this->input->post('batasUtara');
        $batasTimur = $this->input->post('batasTimur');
        $batasSelatan = $this->input->post('batasSelatan');
        $batasBarat = $this->input->post('batasBarat');
        $luasTanah = $this->input->post('luasTanah');
        $luasAsalTanah = $this->input->post('luasAsalTanah');
        $penggunaanTanah = $this->input->post('penggunaanTanah');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f34",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'pekerjaan' => $pekerjaan,
                              'namadiSPPT' => $namadiSPPT,
                              'tahunSPPT' => $tahunSPPT,
                              'nomorSPPT' => $nomorSPPT,
                              'batasUtara' => $batasUtara,
                              'batasTimur' => $batasTimur,
                              'batasSelatan' => $batasSelatan,
                              'batasBarat' => $batasBarat,
                              'luasTanah' => $luasTanah,
                              'luasAsalTanah' => $luasAsalTanah,
                              'penggunaanTanah' => $penggunaanTanah,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f36_surat_keterangan_kepemilikan_tanah' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }
    public function add_f36_surat_keterangan_kepemilikan_tanah_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $pekerjaan = $this->input->post('pekerjaan');
        $namadiSPPT = $this->input->post('namadiSPPT');
        $tahunSPPT = $this->input->post('tahunSPPT');
        $nomorSPPT = $this->input->post('nomorSPPT');
        $batasUtara = $this->input->post('batasUtara');
        $batasTimur = $this->input->post('batasTimur');
        $batasSelatan = $this->input->post('batasSelatan');
        $batasBarat = $this->input->post('batasBarat');
        $luasTanah = $this->input->post('luasTanah');
        $luasAsalTanah = $this->input->post('luasAsalTanah');
        $penggunaanTanah = $this->input->post('penggunaanTanah');
        $randomCode = $this->input->post('randomCode');
       


                        $dataInput = array(
                              'kode_formulir' => "f34",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'pekerjaan' => $pekerjaan,
                              'namadiSPPT' => $namadiSPPT,
                              'tahunSPPT' => $tahunSPPT,
                              'nomorSPPT' => $nomorSPPT,
                              'batasUtara' => $batasUtara,
                              'batasTimur' => $batasTimur,
                              'batasSelatan' => $batasSelatan,
                              'batasBarat' => $batasBarat,
                              'luasTanah' => $luasTanah,
                              'luasAsalTanah' => $luasAsalTanah,
                              'penggunaanTanah' => $penggunaanTanah,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                                
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f36_surat_keterangan_kepemilikan_tanah' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f36_surat_keterangan_kepemilikan_tanah",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request suket kepemilikan tanah",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f36_surat_keterangan_kepemilikan_tanah()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $pekerjaan = $this->input->post('pekerjaan');
        $namadiSPPT = $this->input->post('namadiSPPT');
        $tahunSPPT = $this->input->post('tahunSPPT');
        $nomorSPPT = $this->input->post('nomorSPPT');
        $batasUtara = $this->input->post('batasUtara');
        $batasTimur = $this->input->post('batasTimur');
        $batasSelatan = $this->input->post('batasSelatan');
        $batasBarat = $this->input->post('batasBarat');
        $luasTanah = $this->input->post('luasTanah');
        $luasAsalTanah = $this->input->post('luasAsalTanah');
        $penggunaanTanah = $this->input->post('penggunaanTanah');
       
                        $dataInput = array(
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'pekerjaan' => $pekerjaan,
                              'namadiSPPT' => $namadiSPPT,
                              'tahunSPPT' => $tahunSPPT,
                              'nomorSPPT' => $nomorSPPT,
                              'batasUtara' => $batasUtara,
                              'batasTimur' => $batasTimur,
                              'batasSelatan' => $batasSelatan,
                              'batasBarat' => $batasBarat,
                              'luasTanah' => $luasTanah,
                              'luasAsalTanah' => $luasAsalTanah,
                              'penggunaanTanah' => $penggunaanTanah,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f36_surat_keterangan_kepemilikan_tanah' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f36_surat_keterangan_kepemilikan_tanah()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f36_surat_keterangan_kepemilikan_tanah' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F36()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F36()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $pekerjaan;
        $selectAllShop = $this->Home_model->getSelectData("*,UPPER(pekerjaan)pekT","penduduk", "WHERE penduduk.NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;
            $pekerjaan = $row->pekT;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        $hasil['pekerjaan'] = $pekerjaan;
        echo json_encode($hasil);

    }


    public function showDataUpdate_F36()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $noSurat;
        $NIKKepalaKeluarga;
        $namaKepalaKeluarga;
        $pekerjaan;
        $namadiSPPT;
        $tahunSPPT;
        $nomorSPPT;
        $batasUtara;
        $batasTimur;
        $batasSelatan;
        $batasBarat;
        $dusun;
        $luasTanah;
        $luasAsalTanah;
        $penggunaanTanah; 
        $selectAllShop = $this->Home_model->getSelectData("*","f36_surat_keterangan_kepemilikan_tanah", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $pekerjaan = $row->pekerjaan;
            $namadiSPPT = $row->namadiSPPT;
            $tahunSPPT = $row->tahunSPPT;
            $nomorSPPT = $row->nomorSPPT;
            $batasUtara = $row->batasUtara;
            $batasTimur = $row->batasTimur;
            $batasSelatan = $row->batasSelatan;
            $batasBarat = $row->batasBarat;
            $luasTanah = $row->luasTanah;
            $luasAsalTanah = $row->luasAsalTanah;
            $penggunaanTanah = $row->penggunaanTanah;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['pekerjaan'] = $pekerjaan;
        $hasil['namadiSPPT'] = $namadiSPPT;
        $hasil['tahunSPPT'] = $tahunSPPT;
        $hasil['nomorSPPT'] = $nomorSPPT;
        $hasil['batasUtara'] = $batasUtara;
        $hasil['batasTimur'] = $batasTimur;
        $hasil['batasSelatan'] = $batasSelatan;
        $hasil['batasBarat'] = $batasBarat;
        $hasil['luasTanah'] = $luasTanah;
        $hasil['luasAsalTanah'] = $luasAsalTanah;
        $hasil['penggunaanTanah'] = $penggunaanTanah;
        echo json_encode($hasil);

    }



    public function showTable_F36()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f36_surat_keterangan_kepemilikan_tanah,penduduk", "WHERE f36_surat_keterangan_kepemilikan_tanah.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f36_surat_keterangan_kepemilikan_tanah,penduduk", "WHERE f36_surat_keterangan_kepemilikan_tanah.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f36_surat_keterangan_kepemilikan_tanah";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                $row->luasTanah,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f36_surat_keterangan_kepemilikan_tanah(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f36_surat_keterangan_kepemilikan_tanah('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f36_surat_keterangan_kepemilikan_tanah('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F36()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f36'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f36_surat_keterangan_kepemilikan_tanah", "WHERE f36_surat_keterangan_kepemilikan_tanah.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");

                
                $this->load->view('adminPage/f36_surat_keterangan_kepemilikan_tanah/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }




    //----------------Pelayanan Administrasi Pertanahan - Surat Keterangan jaminan Rumah - (F37) --------------


    public function f37_keterangan_jaminanrumah()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['dataDusun'] = $this->Home_model->getSelectData("*, UPPER(namaDusun) dusX","o_data_dusun", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f37_keterangan_jaminanrumah";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f37_keterangan_jaminanrumah/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }
    public function f37_keterangan_jaminanrumah_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
                $data['dataDusun'] = $this->Home_model->getSelectData("*, UPPER(namaDusun) dusX","o_data_dusun", "");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f37_keterangan_jaminanrumah/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f37_keterangan_jaminanrumah()
    {   
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');

        //data umum
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $pekerjaan = $this->input->post('pekerjaan');
        $alamat = $this->input->post('alamat');
        $keperluan = $this->input->post('keperluan');
        
        //data rumah
        $jenisRumah = $this->input->post('jenisRumah');
        $alamatRumah = $this->input->post('alamatRumah');
        $panjang = $this->input->post('panjang');
        $lebar = $this->input->post('lebar');
        $tinggi = $this->input->post('tinggi');
        $konstruksiTiang = $this->input->post('konstruksiTiang');
        $konstruksiLantai = $this->input->post('konstruksiLantai');
        $konstruksiDinding = $this->input->post('konstruksiDinding');
        $konstruksiAtap = $this->input->post('konstruksiAtap');

        //data tanah
        $namaPemilik = $this->input->post('namaPemilik');
        $namadiSPPT = $this->input->post('namadiSPPT');
        $tahunSPPT = $this->input->post('tahunSPPT');
        $nomorSPPT = $this->input->post('nomorSPPT');
        $batasUtara = $this->input->post('batasUtara');
        $batasTimur = $this->input->post('batasTimur');
        $batasSelatan = $this->input->post('batasSelatan');
        $batasBarat = $this->input->post('batasBarat');

        $randomCode = $this->input->post('randomCode');

       
                        $dataInput = array(
                              'kode_formulir' => "f37",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                              'dataUmum' => $tempatLahir.";".$tanggalLahir.";".$pekerjaan.";".$alamat.";".$keperluan,
                              'dataRumah' => $jenisRumah.";".$alamatRumah.";".$panjang.";".$lebar.";".$tinggi.";".$konstruksiTiang.";".$konstruksiLantai.";".$konstruksiDinding.";".$konstruksiAtap,
                              'dataTanah' => $namaPemilik.";".$namadiSPPT.";".$tahunSPPT.";".$nomorSPPT.";".$batasUtara.";".$batasTimur.";".$batasSelatan.";".$batasBarat,
                            );
                        
                        $simpan = $this->Home_model->insertData('f37_keterangan_jaminanrumah' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f37_keterangan_jaminanrumah_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');

        //data umum
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $pekerjaan = $this->input->post('pekerjaan');
        $alamat = $this->input->post('alamat');
        $keperluan = $this->input->post('keperluan');
        
        //data rumah
        $jenisRumah = $this->input->post('jenisRumah');
        $alamatRumah = $this->input->post('alamatRumah');
        $panjang = $this->input->post('panjang');
        $lebar = $this->input->post('lebar');
        $tinggi = $this->input->post('tinggi');
        $konstruksiTiang = $this->input->post('konstruksiTiang');
        $konstruksiLantai = $this->input->post('konstruksiLantai');
        $konstruksiDinding = $this->input->post('konstruksiDinding');
        $konstruksiAtap = $this->input->post('konstruksiAtap');

        //data tanah
        $namaPemilik = $this->input->post('namaPemilik');
        $namadiSPPT = $this->input->post('namadiSPPT');
        $tahunSPPT = $this->input->post('tahunSPPT');
        $nomorSPPT = $this->input->post('nomorSPPT');
        $batasUtara = $this->input->post('batasUtara');
        $batasTimur = $this->input->post('batasTimur');
        $batasSelatan = $this->input->post('batasSelatan');
        $batasBarat = $this->input->post('batasBarat');

        $randomCode = $this->input->post('randomCode');

       


                        $dataInput = array(
                              'kode_formulir' => "f37",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              'dataUmum' => $tempatLahir.";".$tanggalLahir.";".$pekerjaan.";".$alamat.";".$keperluan,
                              'dataRumah' => $jenisRumah.";".$alamatRumah.";".$panjang.";".$lebar.";".$tinggi.";".$konstruksiTiang.";".$konstruksiLantai.";".$konstruksiDinding.";".$konstruksiAtap,
                              'dataTanah' => $namaPemilik.";".$namadiSPPT.";".$tahunSPPT.";".$nomorSPPT.";".$batasUtara.";".$batasTimur.";".$batasSelatan.";".$batasBarat,
                                
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f37_keterangan_jaminanrumah' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f37_keterangan_jaminanrumah",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request suket jaminan rumah",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f37_keterangan_jaminanrumah()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        
        //data umum
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $pekerjaan = $this->input->post('pekerjaan');
        $alamat = $this->input->post('alamat');
        $keperluan = $this->input->post('keperluan');
        
        //data rumah
        $jenisRumah = $this->input->post('jenisRumah');
        $alamatRumah = $this->input->post('alamatRumah');
        $panjang = $this->input->post('panjang');
        $lebar = $this->input->post('lebar');
        $tinggi = $this->input->post('tinggi');
        $konstruksiTiang = $this->input->post('konstruksiTiang');
        $konstruksiLantai = $this->input->post('konstruksiLantai');
        $konstruksiDinding = $this->input->post('konstruksiDinding');
        $konstruksiAtap = $this->input->post('konstruksiAtap');

        //data tanah
        $namaPemilik = $this->input->post('namaPemilik');
        $namadiSPPT = $this->input->post('namadiSPPT');
        $tahunSPPT = $this->input->post('tahunSPPT');
        $nomorSPPT = $this->input->post('nomorSPPT');
        $batasUtara = $this->input->post('batasUtara');
        $batasTimur = $this->input->post('batasTimur');
        $batasSelatan = $this->input->post('batasSelatan');
        $batasBarat = $this->input->post('batasBarat');

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'dataUmum' => $tempatLahir.";".$tanggalLahir.";".$pekerjaan.";".$alamat.";".$keperluan,
                              'dataRumah' => $jenisRumah.";".$alamatRumah.";".$panjang.";".$lebar.";".$tinggi.";".$konstruksiTiang.";".$konstruksiLantai.";".$konstruksiDinding.";".$konstruksiAtap,
                              'dataTanah' => $namaPemilik.";".$namadiSPPT.";".$tahunSPPT.";".$nomorSPPT.";".$batasUtara.";".$batasTimur.";".$batasSelatan.";".$batasBarat,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f37_keterangan_jaminanrumah' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f37_keterangan_jaminanrumah()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f37_keterangan_jaminanrumah' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F37()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F37()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $tempatLahir;
        $tanggalLahir;
        $umur;
        $pekerjaan;
        $alamatL;
        $selectAllShop = $this->Home_model->getSelectData("*,UPPER(pekerjaan)pekT,TIMESTAMPDIFF(YEAR,tanggalLahir,CURDATE()) as umur","penduduk", "WHERE penduduk.NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $tempatLahir = $row->tempatLahir;
            $tanggalLahir = $row->tanggalLahir;
            $umur = $row->umur;
            $pekerjaan = $row->pekT;
            $alamatL = $row->alamatLengkap;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['tempatLahir'] = $tempatLahir;
        $hasil['tanggalLahir'] = $tanggalLahir;
        $hasil['umur'] = $umur;
        $hasil['pekerjaan'] = $pekerjaan;
        $hasil['alamatL'] = strtolower($alamatL);
        echo json_encode($hasil);

    }



    public function showTable_F37()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f37_keterangan_jaminanrumah,penduduk", "WHERE f37_keterangan_jaminanrumah.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f37_keterangan_jaminanrumah,penduduk", "WHERE f37_keterangan_jaminanrumah.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f37_keterangan_jaminanrumah";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $dataUmum = explode(";", $row->dataUmum);

                        $keperluan = $dataUmum[4];
            // $selectAllShopDataAyah = $this->Home_model->getSelectData("*","penduduk", "WHERE  penduduk.NIK=$dataAyahGet");

            // $namaayah = "";
            // foreach ($selectAllShopDataAyah->result() as $rowx) {
            //     $namaayah = $rowx->namaLengkap;
            // }



            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                $keperluan,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f37_keterangan_jaminanrumah(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f37_keterangan_jaminanrumah('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\',\''.$row->nomorKK.'\',\''.$row->nama.'\',\''.$row->dataUmum.'\',\''.$row->dataRumah.'\',\''.$row->dataTanah.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f37_keterangan_jaminanrumah('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F37()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f37'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f37_keterangan_jaminanrumah", "WHERE f37_keterangan_jaminanrumah.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");

                
                $this->load->view('adminPage/f37_keterangan_jaminanrumah/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }


    //-------------Pelayanan Administrasi Pertanahan - Permohonan Mutasi - (F38) --------------


    public function f38_permohonan_mutasi()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['dataDusun'] = $this->Home_model->getSelectData("*, UPPER(namaDusun) dusX","o_data_dusun", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            $data['jabatan'] = $jabatan;
            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f38_permohonan_mutasi";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f38_permohonan_mutasi/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f38_permohonan_mutasi_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
                $data['dataDusun'] = $this->Home_model->getSelectData("*, UPPER(namaDusun) dusX","o_data_dusun", "");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f38_permohonan_mutasi/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f38_permohonan_mutasi()
    {   
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIK');
        $namaKepalaKeluarga = $this->input->post('nama');

        //data pemohon
        $pekerjaan = $this->input->post('pekerjaan');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $umur = $this->input->post('umur');
        $alamat = $this->input->post('alamat');

        //data tanah
        $namadiSPPT = $this->input->post('namadiSPPT');
        $tahunSPPT = $this->input->post('tahunSPPT');
        $nomorSPPT = $this->input->post('nomorSPPT');
        $batasUtara = $this->input->post('batasUtara');
        $batasTimur = $this->input->post('batasTimur');
        $batasSelatan = $this->input->post('batasSelatan');
        $batasBarat = $this->input->post('batasBarat');
        $dusun = $this->input->post('dusun');
        $luasTanah = $this->input->post('luasTanah');
        $luasBangunan = $this->input->post('luasBangunan');
        $mutasiPBB = $this->input->post('mutasiPBB');
        $mutasiLainnya = $this->input->post('mutasiLainnya');

        //data objek
        $nomorFormulir = $this->input->post('nomorFormulir');
        $jenisTransaksi = $this->input->post('jenisTransaksi');
        $nop = $this->input->post('nop');
        $nopBersama = $this->input->post('nopBersama');
        $nopAsal = $this->input->post('nopAsal');
        $nopSPPTLama = $this->input->post('nopSPPTLama');

        //data letak objek
        $namaJalanObjek = $this->input->post('namaJalanObjek');
        $blokObjek = $this->input->post('blokObjek');
        $desaKelObjek = $this->input->post('desaKelObjek');
        $rtObjek = $this->input->post('rtObjek');
        $rwObjek = $this->input->post('rwObjek');

        //data subjek
        $statusSubjek = $this->input->post('statusSubjek');
        $pekerjaanSubjek = $this->input->post('pekerjaanSubjek');
        $noKTPSubjek = $this->input->post('noKTPSubjek');
        $namaSubjek = $this->input->post('namaSubjek');
        $npwpSubjek = $this->input->post('npwpSubjek');
        $namaJalanSubjek = $this->input->post('namaJalanSubjek');
        $blokSubjek = $this->input->post('blokSubjek');
        $desaKelurahanSubjek = $this->input->post('desaKelurahanSubjek');
        $rtSubjek = $this->input->post('rtSubjek');
        $rwSubjek = $this->input->post('rwSubjek');

        //data tanah bangunan
        $luasTanahBangunan = $this->input->post('luasTanahBangunan');
        $zonaNilaiTanah = $this->input->post('zonaNilaiTanah');
        $jenisTanahBangunan = $this->input->post('jenisTanahBangunan');

        //data pendata
        $namaPendata = $this->input->post('namaPendata');
        $nipPendata = $this->input->post('nipPendata');
        $namaPejabat = $this->input->post('namaPejabat');
        $nipPejabat = $this->input->post('nipPejabat');

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f38",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'dataPemohon' => $pekerjaan.";".$tempatLahir.";".$tanggalLahir.";".$umur.";".$alamat,
                              'dataTanah' => $namadiSPPT.";".$tahunSPPT.";".$nomorSPPT.";".$batasUtara.";".$batasTimur.";".$batasSelatan.";".$batasBarat.";".$dusun.";".$luasTanah.";".$luasBangunan.";".$mutasiPBB.";".$mutasiLainnya,
                              'dataObjek' => $nomorFormulir.";".$jenisTransaksi.";".$nop.";".$nopBersama.";".$nopAsal.";".$nopSPPTLama,
                              'dataLetakObjek' => $namaJalanObjek.";".$blokObjek.";".$desaKelObjek.";".$rtObjek.";".$rwObjek,
                              'dataSubjek' => $statusSubjek.";".$pekerjaanSubjek.";".$noKTPSubjek.";".$namaSubjek.";".$npwpSubjek.";".$namaJalanSubjek.";".$blokSubjek.";".$desaKelurahanSubjek.";".$rtSubjek.";".$rwSubjek,
                              'dataTanahBangunan' => $luasTanahBangunan.";".$zonaNilaiTanah.";".$jenisTanahBangunan,
                              'dataPendata' => $namaPendata.";".$nipPendata.";".$namaPejabat.";".$nipPejabat,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f38_permohonan_mutasi' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f38_permohonan_mutasi_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIK');
        $namaKepalaKeluarga = $this->input->post('nama');

        //data pemohon
        $pekerjaan = $this->input->post('pekerjaan');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $umur = $this->input->post('umur');
        $alamat = $this->input->post('alamat');

        //data tanah
        $namadiSPPT = $this->input->post('namadiSPPT');
        $tahunSPPT = $this->input->post('tahunSPPT');
        $nomorSPPT = $this->input->post('nomorSPPT');
        $batasUtara = $this->input->post('batasUtara');
        $batasTimur = $this->input->post('batasTimur');
        $batasSelatan = $this->input->post('batasSelatan');
        $batasBarat = $this->input->post('batasBarat');
        $dusun = $this->input->post('dusun');
        $luasTanah = $this->input->post('luasTanah');
        $luasBangunan = $this->input->post('luasBangunan');
        $mutasiPBB = $this->input->post('mutasiPBB');
        $mutasiLainnya = $this->input->post('mutasiLainnya');

        //data objek
        $nomorFormulir = $this->input->post('nomorFormulir');
        $jenisTransaksi = $this->input->post('jenisTransaksi');
        $nop = $this->input->post('nop');
        $nopBersama = $this->input->post('nopBersama');
        $nopAsal = $this->input->post('nopAsal');
        $nopSPPTLama = $this->input->post('nopSPPTLama');

        //data letak objek
        $namaJalanObjek = $this->input->post('namaJalanObjek');
        $blokObjek = $this->input->post('blokObjek');
        $desaKelObjek = $this->input->post('desaKelObjek');
        $rtObjek = $this->input->post('rtObjek');
        $rwObjek = $this->input->post('rwObjek');

        //data subjek
        $statusSubjek = $this->input->post('statusSubjek');
        $pekerjaanSubjek = $this->input->post('pekerjaanSubjek');
        $noKTPSubjek = $this->input->post('noKTPSubjek');
        $namaSubjek = $this->input->post('namaSubjek');
        $npwpSubjek = $this->input->post('npwpSubjek');
        $namaJalanSubjek = $this->input->post('namaJalanSubjek');
        $blokSubjek = $this->input->post('blokSubjek');
        $desaKelurahanSubjek = $this->input->post('desaKelurahanSubjek');
        $rtSubjek = $this->input->post('rtSubjek');
        $rwSubjek = $this->input->post('rwSubjek');

        //data tanah bangunan
        $luasTanahBangunan = $this->input->post('luasTanahBangunan');
        $zonaNilaiTanah = $this->input->post('zonaNilaiTanah');
        $jenisTanahBangunan = $this->input->post('jenisTanahBangunan');

        //data pendata
        $namaPendata = $this->input->post('namaPendata');
        $nipPendata = $this->input->post('nipPendata');
        $namaPejabat = $this->input->post('namaPejabat');
        $nipPejabat = $this->input->post('nipPejabat');

        $randomCode = $this->input->post('randomCode');

       


                        $dataInput = array(
                              'kode_formulir' => "f38",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'dataPemohon' => $pekerjaan.";".$tempatLahir.";".$tanggalLahir.";".$umur.";".$alamat,
                              'dataTanah' => $namadiSPPT.";".$tahunSPPT.";".$nomorSPPT.";".$batasUtara.";".$batasTimur.";".$batasSelatan.";".$batasBarat.";".$dusun.";".$luasTanah.";".$luasBangunan.";".$mutasiPBB.";".$mutasiLainnya,
                              'dataObjek' => $nomorFormulir.";".$jenisTransaksi.";".$nop.";".$nopBersama.";".$nopAsal.";".$nopSPPTLama,
                              'dataLetakObjek' => $namaJalanObjek.";".$blokObjek.";".$desaKelObjek.";".$rtObjek.";".$rwObjek,
                              'dataSubjek' => $statusSubjek.";".$pekerjaanSubjek.";".$noKTPSubjek.";".$namaSubjek.";".$npwpSubjek.";".$namaJalanSubjek.";".$blokSubjek.";".$desaKelurahanSubjek.";".$rtSubjek.";".$rwSubjek,
                              'dataTanahBangunan' => $luasTanahBangunan.";".$zonaNilaiTanah.";".$jenisTanahBangunan,
                              'dataPendata' => $namaPendata.";".$nipPendata.";".$namaPejabat.";".$nipPejabat,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f38_permohonan_mutasi' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f38_permohonan_mutasi",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat mutasi",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f38_permohonan_mutasi()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIK');
        $namaKepalaKeluarga = $this->input->post('nama');

        //data pemohon
        $pekerjaan = $this->input->post('pekerjaan');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $umur = $this->input->post('umur');
        $alamat = $this->input->post('alamat');

        //data tanah
        $namadiSPPT = $this->input->post('namadiSPPT');
        $tahunSPPT = $this->input->post('tahunSPPT');
        $nomorSPPT = $this->input->post('nomorSPPT');
        $batasUtara = $this->input->post('batasUtara');
        $batasTimur = $this->input->post('batasTimur');
        $batasSelatan = $this->input->post('batasSelatan');
        $batasBarat = $this->input->post('batasBarat');
        $dusun = $this->input->post('dusun');
        $luasTanah = $this->input->post('luasTanah');
        $luasBangunan = $this->input->post('luasBangunan');
        $mutasiPBB = $this->input->post('mutasiPBB');
        $mutasiLainnya = $this->input->post('mutasiLainnya');

        //data objek
        $nomorFormulir = $this->input->post('nomorFormulir');
        $jenisTransaksi = $this->input->post('jenisTransaksi');
        $nop = $this->input->post('nop');
        $nopBersama = $this->input->post('nopBersama');
        $nopAsal = $this->input->post('nopAsal');
        $nopSPPTLama = $this->input->post('nopSPPTLama');

        //data letak objek
        $namaJalanObjek = $this->input->post('namaJalanObjek');
        $blokObjek = $this->input->post('blokObjek');
        $desaKelObjek = $this->input->post('desaKelObjek');
        $rtObjek = $this->input->post('rtObjek');
        $rwObjek = $this->input->post('rwObjek');

        //data subjek
        $statusSubjek = $this->input->post('statusSubjek');
        $pekerjaanSubjek = $this->input->post('pekerjaanSubjek');
        $noKTPSubjek = $this->input->post('noKTPSubjek');
        $namaSubjek = $this->input->post('namaSubjek');
        $npwpSubjek = $this->input->post('npwpSubjek');
        $namaJalanSubjek = $this->input->post('namaJalanSubjek');
        $blokSubjek = $this->input->post('blokSubjek');
        $desaKelurahanSubjek = $this->input->post('desaKelurahanSubjek');
        $rtSubjek = $this->input->post('rtSubjek');
        $rwSubjek = $this->input->post('rwSubjek');

        //data tanah bangunan
        $luasTanahBangunan = $this->input->post('luasTanahBangunan');
        $zonaNilaiTanah = $this->input->post('zonaNilaiTanah');
        $jenisTanahBangunan = $this->input->post('jenisTanahBangunan');

        //data pendata
        $namaPendata = $this->input->post('namaPendata');
        $nipPendata = $this->input->post('nipPendata');
        $namaPejabat = $this->input->post('namaPejabat');
        $nipPejabat = $this->input->post('nipPejabat');

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'dataPemohon' => $pekerjaan.";".$tempatLahir.";".$tanggalLahir.";".$umur.";".$alamat,
                              'dataTanah' => $namadiSPPT.";".$tahunSPPT.";".$nomorSPPT.";".$batasUtara.";".$batasTimur.";".$batasSelatan.";".$batasBarat.";".$dusun.";".$luasTanah.";".$luasBangunan.";".$mutasiPBB.";".$mutasiLainnya,
                              'dataObjek' => $nomorFormulir.";".$jenisTransaksi.";".$nop.";".$nopBersama.";".$nopAsal.";".$nopSPPTLama,
                              'dataLetakObjek' => $namaJalanObjek.";".$blokObjek.";".$desaKelObjek.";".$rtObjek.";".$rwObjek,
                              'dataSubjek' => $statusSubjek.";".$pekerjaanSubjek.";".$noKTPSubjek.";".$namaSubjek.";".$npwpSubjek.";".$namaJalanSubjek.";".$blokSubjek.";".$desaKelurahanSubjek.";".$rtSubjek.";".$rwSubjek,
                              'dataTanahBangunan' => $luasTanahBangunan.";".$zonaNilaiTanah.";".$jenisTanahBangunan,
                              'dataPendata' => $namaPendata.";".$nipPendata.";".$namaPejabat.";".$nipPejabat,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f38_permohonan_mutasi' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }



    public function add_f38_lampiran()
    {   
        $noKK = $this->input->post('noKK');
        
        $idMutasi = $this->input->post('idMutasi');

        $urutBangunan = $this->input->post('urutBangunan');

        //data bangunan
        $penggunaanBangunan = $this->input->post('penggunaanBangunan');
        $luasBangunan = $this->input->post('luasBangunan');
        $jumlahLantai = $this->input->post('jumlahLantai');
        $tahunDibangun = $this->input->post('tahunDibangun');
        $tahunDirenovasi = $this->input->post('tahunDirenovasi');
        $dayaListrik = $this->input->post('dayaListrik');
        $kondisiBangunan = $this->input->post('kondisiBangunan');
        $konstruksi = $this->input->post('konstruksi');
        $atap = $this->input->post('atap');
        $dinding = $this->input->post('dinding');
        $lantai = $this->input->post('lantai');
        $langitLangit = $this->input->post('langitLangit');

        //data fasilitas
        $split = $this->input->post('split');
        $Window = $this->input->post('Window');
        $acCentral = $this->input->post('acCentral');
        $luasKolamRenang = $this->input->post('luasKolamRenang');
        $materialKolamRenang = $this->input->post('materialKolamRenang');
        $panjangPagar = $this->input->post('panjangPagar');
        $materialPagar = $this->input->post('materialPagar');
        $jumlahSaluran = $this->input->post('jumlahSaluran');
        $keadaanSumur = $this->input->post('keadaanSumur');

        //data perkerasan halaman
        $ringan = $this->input->post('ringan');
        $sedang = $this->input->post('sedang');
        $berat = $this->input->post('berat');
        $penutupLantai = $this->input->post('penutupLantai');

        //data lapangan tenis
        $tdlBeton = $this->input->post('tdlBeton');
        $tdlAspal = $this->input->post('tdlAspal');
        $tdlRumput = $this->input->post('tdlRumput');
        $ttlBeton = $this->input->post('ttlBeton');
        $ttlAspal = $this->input->post('ttlAspal');
        $ttlRumput = $this->input->post('ttlRumput');

        //data lift
        $penumpang = $this->input->post('penumpang');
        $kapsul = $this->input->post('kapsul');
        $barang = $this->input->post('barang');
        $lebarKurang = $this->input->post('lebarKurang');
        $lebarLebih = $this->input->post('lebarLebih');

        //data pemadam kebakaran
        $hydrant = $this->input->post('hydrant');
        $sprinkler = $this->input->post('sprinkler');
        $fireAi = $this->input->post('fireAi');

        //data penilaian individual
        $sistem = $this->input->post('sistem');
        $nilaiIndividual = $this->input->post('nilaiIndividual');

        //data pendata
        $namaPendata = $this->input->post('namaPendata');
        $nipPendata = $this->input->post('nipPendata');
        $tanggalKunjungan = $this->input->post('tanggalKunjungan');
        $tanggalPendataan = $this->input->post('tanggalPendataan');

        //data pejabat
        $namaPejabat = $this->input->post('namaPejabat');
        $nipPejabat = $this->input->post('nipPejabat');
        $tanggalPenelitian = $this->input->post('tanggalPenelitian');

        //tambahan
        $jpb2KelasBangunan = $this->input->post('jpb2KelasBangunan');

        $jpb3TinggiKolam = $this->input->post('jpb3TinggiKolam');
        $jpb3LebarBentang = $this->input->post('jpb3LebarBentang');
        $jpb3LuasMezzanine = $this->input->post('jpb3LuasMezzanine');
        $jpb3DayaDukungLantai = $this->input->post('jpb3DayaDukungLantai');
        $jpb3KelilingDinding = $this->input->post('jpb3KelilingDinding');

        $jpb4KelasBangunan = $this->input->post('jpb4KelasBangunan');

        $jpb5KelasBangunan = $this->input->post('jpb5KelasBangunan');
        $jpb5LuasKamarACCentral = $this->input->post('jpb5LuasKamarACCentral');
        $jpb5LuasRuangLainACCentral = $this->input->post('jpb5LuasRuangLainACCentral');

        $jpb6KelasBangunan = $this->input->post('jpb6KelasBangunan');

        $jpb7JenisHotel = $this->input->post('jpb7JenisHotel');
        $jpb7JumlahHotel = $this->input->post('jpb7JumlahHotel');
        $jpb7JumlahKamar = $this->input->post('jpb7JumlahKamar');
        $jpb7LuasKamarACCentral = $this->input->post('jpb7LuasKamarACCentral');
        $jpb7LuasRuangLainACCentral = $this->input->post('jpb7LuasRuangLainACCentral');

        $jpb8TinggiKolam = $this->input->post('jpb8TinggiKolam');
        $jpb8LebarBentang = $this->input->post('jpb8LebarBentang');
        $jpb8LuasMezzanine = $this->input->post('jpb8LuasMezzanine');
        $jpb8DayaDukungLantai = $this->input->post('jpb8DayaDukungLantai');
        $jpb8KelilingDinding = $this->input->post('jpb8KelilingDinding');

        $jpb9KelasBangunan = $this->input->post('jpb9KelasBangunan');

        $jpb12TipeBangunan = $this->input->post('jpb12TipeBangunan');

        $jpb13KelasBangunan = $this->input->post('jpb13KelasBangunan');
        $jpb13JumlahKamar = $this->input->post('jpb13JumlahKamar');
        $jpb13LuasKamarACCentral = $this->input->post('jpb13LuasKamarACCentral');
        $jpb13LuasRuangLainACCentral = $this->input->post('jpb13LuasRuangLainACCentral');

        $jpb15KapasitasTangki = $this->input->post('jpb15KapasitasTangki');
        $jpb15LetakTangki = $this->input->post('jpb15LetakTangki');

        $jpb16KelasBangunan = $this->input->post('jpb16KelasBangunan');

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'idMutasi' => $idMutasi,
                              'urutBangunan' => $urutBangunan,
                              'dataBangunan' => $penggunaanBangunan.";".$luasBangunan.";".$jumlahLantai.";".$tahunDibangun.";".$tahunDirenovasi.";".$dayaListrik.";".$kondisiBangunan.";".$konstruksi.";".$atap.";".$dinding.";".$lantai.";".$langitLangit,
                              'fasilitas' => $split.";".$Window.";".$acCentral.";".$luasKolamRenang.";".$materialKolamRenang.";".$panjangPagar.";".$materialPagar.";".$jumlahSaluran.";".$keadaanSumur,
                              'perkerasanHalaman' => $ringan.";".$sedang.";".$berat.";".$penutupLantai,
                              'lapanganTenis' => $tdlBeton.";".$tdlAspal.";".$tdlRumput.";".$ttlBeton.";".$ttlAspal.";".$ttlRumput,
                              'lift' => $penumpang.";".$kapsul.";".$barang.";".$lebarKurang.";".$lebarLebih,
                              'pemadamKebakaran' => $hydrant.";".$sprinkler.";".$fireAi,
                              'penilaianIndividual' => $sistem.";".$nilaiIndividual,
                              'identitasPendata' => $namaPendata.";".$nipPendata.";".$tanggalKunjungan.";".$tanggalPendataan,
                              'identitasPejabat' => $namaPejabat.";".$nipPejabat.";".$tanggalPenelitian,
                              'jpb_dua' => $jpb2KelasBangunan,
                              'jpb_tiga' => $jpb3TinggiKolam.";".$jpb3LebarBentang.";".$jpb3LuasMezzanine.";".$jpb3DayaDukungLantai.";".$jpb3KelilingDinding,
                              'jpb_empat' => $jpb4KelasBangunan,
                              'jpb_lima' => $jpb5KelasBangunan.";".$jpb5LuasKamarACCentral.";".$jpb5LuasRuangLainACCentral,
                              'jpb_enam' => $jpb6KelasBangunan,
                              'jpb_tujuh' => $jpb7JenisHotel.";".$jpb7JumlahHotel.";".$jpb7JumlahKamar.";".$jpb7LuasKamarACCentral.";".$jpb7LuasRuangLainACCentral,
                              'jpb_delapan' => $jpb8TinggiKolam.";".$jpb8LebarBentang.";".$jpb8LuasMezzanine.";".$jpb8DayaDukungLantai.";".$jpb8KelilingDinding,
                              'jpb_sembilan' => $jpb9KelasBangunan,
                              'jpb_duabelas' => $jpb12TipeBangunan,
                              'jpb_tigabelas' => $jpb13KelasBangunan.";".$jpb13JumlahKamar.";".$jpb13LuasKamarACCentral.";".$jpb13LuasRuangLainACCentral,
                              'jpb_limabelas' => $jpb15KapasitasTangki.";".$jpb15LetakTangki,
                              'jpb_enambelas' => $jpb16KelasBangunan,
                              'status' => "aktif",
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f38_lampiran' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }



    public function update_f38_lampiran()
    {
        
        $IDUpdateMutasi = $this->input->post('IDUpdateMutasi');

        $urutBangunan = $this->input->post('urutBangunan');

        //data bangunan
        $penggunaanBangunan = $this->input->post('penggunaanBangunan');
        $luasBangunan = $this->input->post('luasBangunan');
        $jumlahLantai = $this->input->post('jumlahLantai');
        $tahunDibangun = $this->input->post('tahunDibangun');
        $tahunDirenovasi = $this->input->post('tahunDirenovasi');
        $dayaListrik = $this->input->post('dayaListrik');
        $kondisiBangunan = $this->input->post('kondisiBangunan');
        $konstruksi = $this->input->post('konstruksi');
        $atap = $this->input->post('atap');
        $dinding = $this->input->post('dinding');
        $lantai = $this->input->post('lantai');
        $langitLangit = $this->input->post('langitLangit');

        //data fasilitas
        $split = $this->input->post('split');
        $Window = $this->input->post('Window');
        $acCentral = $this->input->post('acCentral');
        $luasKolamRenang = $this->input->post('luasKolamRenang');
        $materialKolamRenang = $this->input->post('materialKolamRenang');
        $panjangPagar = $this->input->post('panjangPagar');
        $materialPagar = $this->input->post('materialPagar');
        $jumlahSaluran = $this->input->post('jumlahSaluran');
        $keadaanSumur = $this->input->post('keadaanSumur');

        //data perkerasan halaman
        $ringan = $this->input->post('ringan');
        $sedang = $this->input->post('sedang');
        $berat = $this->input->post('berat');
        $penutupLantai = $this->input->post('penutupLantai');

        //data lapangan tenis
        $tdlBeton = $this->input->post('tdlBeton');
        $tdlAspal = $this->input->post('tdlAspal');
        $tdlRumput = $this->input->post('tdlRumput');
        $ttlBeton = $this->input->post('ttlBeton');
        $ttlAspal = $this->input->post('ttlAspal');
        $ttlRumput = $this->input->post('ttlRumput');

        //data lift
        $penumpang = $this->input->post('penumpang');
        $kapsul = $this->input->post('kapsul');
        $barang = $this->input->post('barang');
        $lebarKurang = $this->input->post('lebarKurang');
        $lebarLebih = $this->input->post('lebarLebih');

        //data pemadam kebakaran
        $hydrant = $this->input->post('hydrant');
        $sprinkler = $this->input->post('sprinkler');
        $fireAi = $this->input->post('fireAi');

        //data penilaian individual
        $sistem = $this->input->post('sistem');
        $nilaiIndividual = $this->input->post('nilaiIndividual');

        //data pendata
        $namaPendata = $this->input->post('namaPendata');
        $nipPendata = $this->input->post('nipPendata');
        $tanggalKunjungan = $this->input->post('tanggalKunjungan');
        $tanggalPendataan = $this->input->post('tanggalPendataan');

        //data pejabat
        $namaPejabat = $this->input->post('namaPejabat');
        $nipPejabat = $this->input->post('nipPejabat');
        $tanggalPenelitian = $this->input->post('tanggalPenelitian');

         //tambahan
        $jpb2KelasBangunan = $this->input->post('jpb2KelasBangunan');

        $jpb3TinggiKolam = $this->input->post('jpb3TinggiKolam');
        $jpb3LebarBentang = $this->input->post('jpb3LebarBentang');
        $jpb3LuasMezzanine = $this->input->post('jpb3LuasMezzanine');
        $jpb3DayaDukungLantai = $this->input->post('jpb3DayaDukungLantai');
        $jpb3KelilingDinding = $this->input->post('jpb3KelilingDinding');

        $jpb4KelasBangunan = $this->input->post('jpb4KelasBangunan');

        $jpb5KelasBangunan = $this->input->post('jpb5KelasBangunan');
        $jpb5LuasKamarACCentral = $this->input->post('jpb5LuasKamarACCentral');
        $jpb5LuasRuangLainACCentral = $this->input->post('jpb5LuasRuangLainACCentral');

        $jpb6KelasBangunan = $this->input->post('jpb6KelasBangunan');

        $jpb7JenisHotel = $this->input->post('jpb7JenisHotel');
        $jpb7JumlahHotel = $this->input->post('jpb7JumlahHotel');
        $jpb7JumlahKamar = $this->input->post('jpb7JumlahKamar');
        $jpb7LuasKamarACCentral = $this->input->post('jpb7LuasKamarACCentral');
        $jpb7LuasRuangLainACCentral = $this->input->post('jpb7LuasRuangLainACCentral');

        $jpb8TinggiKolam = $this->input->post('jpb8TinggiKolam');
        $jpb8LebarBentang = $this->input->post('jpb8LebarBentang');
        $jpb8LuasMezzanine = $this->input->post('jpb8LuasMezzanine');
        $jpb8DayaDukungLantai = $this->input->post('jpb8DayaDukungLantai');
        $jpb8KelilingDinding = $this->input->post('jpb8KelilingDinding');

        $jpb9KelasBangunan = $this->input->post('jpb9KelasBangunan');

        $jpb12TipeBangunan = $this->input->post('jpb12TipeBangunan');

        $jpb13KelasBangunan = $this->input->post('jpb13KelasBangunan');
        $jpb13JumlahKamar = $this->input->post('jpb13JumlahKamar');
        $jpb13LuasKamarACCentral = $this->input->post('jpb13LuasKamarACCentral');
        $jpb13LuasRuangLainACCentral = $this->input->post('jpb13LuasRuangLainACCentral');

        $jpb15KapasitasTangki = $this->input->post('jpb15KapasitasTangki');
        $jpb15LetakTangki = $this->input->post('jpb15LetakTangki');
        
        $jpb16KelasBangunan = $this->input->post('jpb16KelasBangunan');

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                            'urutBangunan' => $urutBangunan,
                              'dataBangunan' => $penggunaanBangunan.";".$luasBangunan.";".$jumlahLantai.";".$tahunDibangun.";".$tahunDirenovasi.";".$dayaListrik.";".$kondisiBangunan.";".$konstruksi.";".$atap.";".$dinding.";".$lantai.";".$langitLangit,
                              'fasilitas' => $split.";".$Window.";".$acCentral.";".$luasKolamRenang.";".$materialKolamRenang.";".$panjangPagar.";".$materialPagar.";".$jumlahSaluran.";".$keadaanSumur,
                              'perkerasanHalaman' => $ringan.";".$sedang.";".$berat.";".$penutupLantai,
                              'lapanganTenis' => $tdlBeton.";".$tdlAspal.";".$tdlRumput.";".$ttlBeton.";".$ttlAspal.";".$ttlRumput,
                              'lift' => $penumpang.";".$kapsul.";".$barang.";".$lebarKurang.";".$lebarLebih,
                              'pemadamKebakaran' => $hydrant.";".$sprinkler.";".$fireAi,
                              'penilaianIndividual' => $sistem.";".$nilaiIndividual,
                              'identitasPendata' => $namaPendata.";".$nipPendata.";".$tanggalKunjungan.";".$tanggalPendataan,
                              'identitasPejabat' => $namaPejabat.";".$nipPejabat.";".$tanggalPenelitian,
                              'jpb_dua' => $jpb2KelasBangunan,
                              'jpb_tiga' => $jpb3TinggiKolam.";".$jpb3LebarBentang.";".$jpb3LuasMezzanine.";".$jpb3DayaDukungLantai.";".$jpb3KelilingDinding,
                              'jpb_empat' => $jpb4KelasBangunan,
                              'jpb_lima' => $jpb5KelasBangunan.";".$jpb5LuasKamarACCentral.";".$jpb5LuasRuangLainACCentral,
                              'jpb_enam' => $jpb6KelasBangunan,
                              'jpb_tujuh' => $jpb7JenisHotel.";".$jpb7JumlahHotel.";".$jpb7JumlahKamar.";".$jpb7LuasKamarACCentral.";".$jpb7LuasRuangLainACCentral,
                              'jpb_delapan' => $jpb8TinggiKolam.";".$jpb8LebarBentang.";".$jpb8LuasMezzanine.";".$jpb8DayaDukungLantai.";".$jpb8KelilingDinding,
                              'jpb_sembilan' => $jpb9KelasBangunan,
                              'jpb_duabelas' => $jpb12TipeBangunan,
                              'jpb_tigabelas' => $jpb13KelasBangunan.";".$jpb13JumlahKamar.";".$jpb13LuasKamarACCentral.";".$jpb13LuasRuangLainACCentral,
                              'jpb_limabelas' => $jpb15KapasitasTangki.";".$jpb15LetakTangki,
                              'jpb_enambelas' => $jpb16KelasBangunan,

                            );
                        
                        $simpan = $this->Home_model->updateData('f38_lampiran' , $dataInput," id=$IDUpdateMutasi");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }



    public function delete_f38_permohonan_mutasi()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f38_permohonan_mutasi' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function delete_f38_lampiran()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f38_lampiran' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F38()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F38()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $pekerjaan;
        $tempatLahir;
        $tanggalLahir;
        $umur;
        $alamat;
        $selectAllShop = $this->Home_model->getSelectData("*,TIMESTAMPDIFF(YEAR,tanggalLahir,CURDATE()) as umur,UPPER(pekerjaan)pekT","penduduk", "WHERE penduduk.NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;
            $pekerjaan = $row->pekT;
            $tempatLahir = $row->tempatLahir;
            $tanggalLahir = $row->tanggalLahir;
            $umur = $row->umur;
            $alamat = $row->alamatLengkap;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        $hasil['pekerjaan'] = $pekerjaan;
        $hasil['tempatLahir'] = $tempatLahir;
        $hasil['tanggalLahir'] = $tanggalLahir;
        $hasil['umur'] = $umur;
        $hasil['alamatLengkap'] = ucwords(strtolower($alamat));
        echo json_encode($hasil);

    }


    public function showDataUpdate_F38()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $noSurat;
        $NIKKepalaKeluarga;
        $namaKepalaKeluarga;
        $pekerjaan;
        $namadiSPPT;
        $tahunSPPT;
        $nomorSPPT;
        $batasUtara;
        $batasTimur;
        $batasSelatan;
        $batasBarat;
        $dusun;
        $luasTanah;
        $luasAsalTanah;
        $penggunaanTanah; 
        $selectAllShop = $this->Home_model->getSelectData("*","f38_permohonan_mutasi", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $pekerjaan = $row->pekerjaan;
            $namadiSPPT = $row->namadiSPPT;
            $tahunSPPT = $row->tahunSPPT;
            $nomorSPPT = $row->nomorSPPT;
            $batasUtara = $row->batasUtara;
            $batasTimur = $row->batasTimur;
            $batasSelatan = $row->batasSelatan;
            $batasBarat = $row->batasBarat;
            $luasTanah = $row->luasTanah;
            $luasAsalTanah = $row->luasAsalTanah;
            $penggunaanTanah = $row->penggunaanTanah;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['pekerjaan'] = $pekerjaan;
        $hasil['namadiSPPT'] = $namadiSPPT;
        $hasil['tahunSPPT'] = $tahunSPPT;
        $hasil['nomorSPPT'] = $nomorSPPT;
        $hasil['batasUtara'] = $batasUtara;
        $hasil['batasTimur'] = $batasTimur;
        $hasil['batasSelatan'] = $batasSelatan;
        $hasil['batasBarat'] = $batasBarat;
        $hasil['luasTanah'] = $luasTanah;
        $hasil['luasAsalTanah'] = $luasAsalTanah;
        $hasil['penggunaanTanah'] = $penggunaanTanah;
        echo json_encode($hasil);

    }



    public function showTable_F38()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f38_permohonan_mutasi,penduduk", "WHERE f38_permohonan_mutasi.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f38_permohonan_mutasi,penduduk", "WHERE f38_permohonan_mutasi.NIK=penduduk.NIK");
        }
       
        

        $number=0;

        $btnSide = "";
        $mutasiPBB = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           $idMut = $row->id;
           $mutasi = explode(";", $row->dataTanah);
        
            $selectbangunan = $this->Home_model->getSelectData("*","f38_lampiran", "WHERE f38_lampiran.idMutasi=$idMut");

            $jmlDataKe = $selectbangunan->num_rows()+1;

            // foreach ($selectbangunan->result() as $key) {

            // $kodeBangunan = $key->bangunanke;
            // $urutan = (int) substr($kodeBangunan, 3, 3);
            // $urutan++;
            // $kodeBangunan = sprintf("%03s", $urutan);

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                $mutasi[10],
                $btnSide='  
                                     <div class="dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f38_permohonan_mutasi(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="width:45px;">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f38_permohonan_mutasi('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\',\''.$row->nomorKK.'\',\''.$row->nama.'\',\''.$row->dataPemohon.'\',\''.$row->dataTanah.'\',\''.$row->dataObjek.'\',\''.$row->dataLetakObjek.'\',\''.$row->dataSubjek.'\',\''.$row->dataTanahBangunan.'\',\''.$row->dataPendata.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f38_permohonan_mutasi('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>

                                        </div>
                                      </div>

                                      <div style="height: 3px;"></div>

                                      <div class="dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f38_spop(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> SPOP</button>
                                        <button type="button" class="btn btn-primary btn-sm" id="btnTambah" data-toggle="modal" data-target="#l-Modal" onclick="showModalBaru('.$row->id.',\''.$jmlDataKe.'\')"><i class="ti-align-left"></i></button>
                                        </button>
                                      </div>'
                
            ));
                // }
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }


    public function showTablelampiran_F38()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f38_lampiran", "WHERE f38_lampiran.idMutasi=$keyword");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f38_lampiran", "WHERE f38_lampiran.idMutasi LIKE '%$keyword%'");   
        }
       
        
        $number=0;

        $btnSide = "";
        $tahunDibangun = "";
        $luasBangunan = "";
        $penggunaanBangunan = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
           $bangunan = explode(";", $row->dataBangunan);
        

            array_push($result,array(
                $number+=1,
                $bangunan[3],
                $bangunan[1].' m<sup>2</sup>',
                $bangunan[0],
                $btnSide='  
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f38_lampiran(\''.$row->id.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f38_lampiran('.$row->id.',\''.$row->dataBangunan.'\',\''.$row->fasilitas.'\',\''.$row->perkerasanHalaman.'\',\''.$row->lapanganTenis.'\',\''.$row->lift.'\',\''.$row->pemadamKebakaran.'\',\''.$row->penilaianIndividual.'\',\''.$row->identitasPendata.'\',\''.$row->identitasPejabat.'\',\''.$row->jpb_dua.'\',\''.$row->jpb_tiga.'\',\''.$row->jpb_empat.'\',\''.$row->jpb_lima.'\',\''.$row->jpb_enam.'\',\''.$row->jpb_tujuh.'\',\''.$row->jpb_delapan.'\',\''.$row->jpb_sembilan.'\',\''.$row->jpb_duabelas.'\',\''.$row->jpb_tigabelas.'\',\''.$row->jpb_limabelas.'\',\''.$row->jpb_enambelas.'\',\''.$row->urutBangunan.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f38_lampiran('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>
                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }


    public function showTablelampiran_F38Spesific()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f38_lampiran", "WHERE f38_lampiran.idMutasi=$keyword");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f38_lampiran", "WHERE f38_lampiran.idMutasi=$keyword");   
        }
       
        
        $number=0;

        $btnSide = "";
        $tahunDibangun = "";
        $luasBangunan = "";
        $penggunaanBangunan = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
           $bangunan = explode(";", $row->dataBangunan);
        

            array_push($result,array(
                $number+=1,
                $bangunan[3],
                $bangunan[1].' m<sup>2</sup>',
                $bangunan[0],
                $btnSide='  
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f38_lampiran(\''.$row->id.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f38_lampiran('.$row->id.',\''.$row->dataBangunan.'\',\''.$row->fasilitas.'\',\''.$row->perkerasanHalaman.'\',\''.$row->lapanganTenis.'\',\''.$row->lift.'\',\''.$row->pemadamKebakaran.'\',\''.$row->penilaianIndividual.'\',\''.$row->identitasPendata.'\',\''.$row->identitasPejabat.'\',\''.$row->jpb_dua.'\',\''.$row->jpb_tiga.'\',\''.$row->jpb_empat.'\',\''.$row->jpb_lima.'\',\''.$row->jpb_enam.'\',\''.$row->jpb_tujuh.'\',\''.$row->jpb_delapan.'\',\''.$row->jpb_sembilan.'\',\''.$row->jpb_duabelas.'\',\''.$row->jpb_tigabelas.'\',\''.$row->jpb_limabelas.'\',\''.$row->jpb_enambelas.'\',\''.$row->urutBangunan.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f38_lampiran('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>
                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F38()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            $data['jabatan'] = $jabatan;

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f38'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f38_permohonan_mutasi", "WHERE f38_permohonan_mutasi.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");

                
                $this->load->view('adminPage/f38_permohonan_mutasi/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }


    public function printForm_F38_spop()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            $data['jabatan'] = $jabatan;

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f38'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f38_permohonan_mutasi", "WHERE f38_permohonan_mutasi.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                    $idMut = $row->id;
                }

                $data['showjumlahbangunan'] = $this->Home_model->getSelectData("*","f38_lampiran", "WHERE f38_lampiran.idMutasi=$idMut");

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");

                
                $this->load->view('adminPage/f38_permohonan_mutasi/print/print_spop' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }



    public function printForm_F38_lampiran()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            $data['jabatan'] = $jabatan;
            


            //show form by id form here

                $value1 = $this->uri->segment(4);


                $data['showData'] = $this->Home_model->getSelectData("*,count(id) jumlahBangunan","f38_lampiran", "WHERE f38_lampiran.id='$value1'");

                $idMut;
                foreach ($data['showData']->result() as $row) {
                    $idMut = $row->idMutasi;
                }

                $data['showDataMutasi'] = $this->Home_model->getSelectData("*","f38_permohonan_mutasi", "WHERE f38_permohonan_mutasi.id=$idMut");
                
                $data['showjumlahbangunan'] = $this->Home_model->getSelectData("*","f38_lampiran", "WHERE f38_lampiran.idMutasi=$idMut");
                
                $this->load->view('adminPage/f38_permohonan_mutasi/print/print_lampiran' ,$data);
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }


    //----------------Pelayanan Administrasi Pertanahan - Keterangan Ahli Waris - (F39) --------------

    public function f39_keterangan_ahli_waris()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "WHERE kedudukanDalamKeluarga='KEPALA KELUARGA' ORDER BY namaLengkap ASC");
            $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
            $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
            $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
            $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");

            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f39_keterangan_ahli_waris";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f39_keterangan_ahli_waris/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f39_keterangan_ahli_waris_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
                $data['dataDusun'] = $this->Home_model->getSelectData("*, UPPER(namaDusun) dusX","o_data_dusun", "");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f39_keterangan_ahli_waris/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }



    public function add_f39_keterangan_ahli_waris()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $randomCode = $this->input->post('randomCode');
        $nama = $this->input->post('nama');
        $jenisKelamin = $this->input->post('jenisKelamin');
        
        //data meninggal
        $tanggalMeninggal = $this->input->post('tanggalMeninggal');
        $alamatMeninggal = $this->input->post('alamatMeninggal');
        $tanggalDikuburkan = $this->input->post('tanggalDikuburkan');
        $alamatDikuburkan = $this->input->post('alamatDikuburkan');

        //data ahli waris
        $nikAhliWaris = $this->input->post('nikAhliWaris');
        $namaAhliWaris = $this->input->post('namaAhliWaris');
        $jenisKelaminAhliWaris = $this->input->post('jenisKelaminAhliWaris'); 

        $kuasaAhliWaris = $this->input->post('kuasaAhliWaris');

        $nikAhliWarisParsed = "";
        $namaAhliWarisParsed = "";
        $jenisKelaminAhliWarisParsed = "";
        
        for ($i=0; $i < count($nikAhliWaris); $i++) { 
            $nikAhliWarisParsed.= $nikAhliWaris[$i].";";
        }

        for ($i=0; $i < count($namaAhliWaris); $i++) { 
            $namaAhliWarisParsed.= $namaAhliWaris[$i].";";
        }

        for ($i=0; $i < count($jenisKelaminAhliWaris); $i++) { 
            $jenisKelaminAhliWarisParsed.= $jenisKelaminAhliWaris[$i].";";
        }
        
       
                        $dataInput = array(
                              'kode_formulir' => "f39",
                              'nomorSurat' => $noSurat,
                              'NIK' => $noKK,
                              'nama' => $nama,
                              'jenisKelamin' => $jenisKelamin,
                              'dataMeninggal' => $tanggalMeninggal.";".$alamatMeninggal.";".$tanggalDikuburkan.";".$alamatDikuburkan,
                              'nikAhliWaris' => $nikAhliWarisParsed,
                              'namaAhliWaris' => $namaAhliWarisParsed,
                              'jenisKelaminAhliWaris' => $jenisKelaminAhliWarisParsed,
                              'kuasaAhliWaris' => $kuasaAhliWaris,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                            );
                        
                        $simpan = $this->Home_model->insertData('f39_keterangan_ahli_waris' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f39_keterangan_ahli_waris_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $randomCode = $this->input->post('randomCode');
        $nama = $this->input->post('nama');
        $jenisKelamin = $this->input->post('jenisKelamin');
        
        //data meninggal
        $tanggalMeninggal = $this->input->post('tanggalMeninggal');
        $alamatMeninggal = $this->input->post('alamatMeninggal');
        $tanggalDikuburkan = $this->input->post('tanggalDikuburkan');
        $alamatDikuburkan = $this->input->post('alamatDikuburkan');

        //data ahli waris
        $nikAhliWaris = $this->input->post('nikAhliWaris');
        $namaAhliWaris = $this->input->post('namaAhliWaris');
        $jenisKelaminAhliWaris = $this->input->post('jenisKelaminAhliWaris'); 

        $kuasaAhliWaris = $this->input->post('kuasaAhliWaris');

        $nikAhliWarisParsed = "";
        $namaAhliWarisParsed = "";
        $jenisKelaminAhliWarisParsed = "";
        
        for ($i=0; $i < count($nikAhliWaris); $i++) { 
            $nikAhliWarisParsed.= $nikAhliWaris[$i].";";
        }

        for ($i=0; $i < count($namaAhliWaris); $i++) { 
            $namaAhliWarisParsed.= $namaAhliWaris[$i].";";
        }

        for ($i=0; $i < count($jenisKelaminAhliWaris); $i++) { 
            $jenisKelaminAhliWarisParsed.= $jenisKelaminAhliWaris[$i].";";
        }

       


                        $dataInput = array(
                              'kode_formulir' => "f39",
                              'nomorSurat' => $noSurat,
                              'NIK' => $noKK,
                              'nama' => $nama,
                              'jenisKelamin' => $jenisKelamin,
                              'dataMeninggal' => $tanggalMeninggal.";".$alamatMeninggal.";".$tanggalDikuburkan.";".$alamatDikuburkan,
                              'nikAhliWaris' => $nikAhliWarisParsed,
                              'namaAhliWaris' => $namaAhliWarisParsed,
                              'jenisKelaminAhliWaris' => $jenisKelaminAhliWarisParsed,
                              'kuasaAhliWaris' => $kuasaAhliWaris,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f39_keterangan_ahli_waris' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f39_keterangan_ahli_waris",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request suket ahli waris",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f39_keterangan_ahli_waris()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $randomCode = $this->input->post('randomCode');
        $nama = $this->input->post('nama');
        $jenisKelamin = $this->input->post('jenisKelamin');
        
        //data meninggal
        $tanggalMeninggal = $this->input->post('tanggalMeninggal');
        $alamatMeninggal = $this->input->post('alamatMeninggal');
        $tanggalDikuburkan = $this->input->post('tanggalDikuburkan');
        $alamatDikuburkan = $this->input->post('alamatDikuburkan');

        //data ahli waris
        $nikAhliWaris = $this->input->post('nikAhliWaris');
        $namaAhliWaris = $this->input->post('namaAhliWaris');
        $jenisKelaminAhliWaris = $this->input->post('jenisKelaminAhliWaris'); 

        $kuasaAhliWaris = $this->input->post('kuasaAhliWaris');

        $nikAhliWarisParsed = "";
        $namaAhliWarisParsed = "";
        $jenisKelaminAhliWarisParsed = "";
        
        for ($i=0; $i < count($nikAhliWaris); $i++) { 
            $nikAhliWarisParsed.= $nikAhliWaris[$i].";";
        }

        for ($i=0; $i < count($namaAhliWaris); $i++) { 
            $namaAhliWarisParsed.= $namaAhliWaris[$i].";";
        }

        for ($i=0; $i < count($jenisKelaminAhliWaris); $i++) { 
            $jenisKelaminAhliWarisParsed.= $jenisKelaminAhliWaris[$i].";";
        }
       
                        $dataInput = array(
                              'nomorSurat' => $noSurat,
                              'NIK' => $noKK,
                              'nama' => $nama,
                              'jenisKelamin' => $jenisKelamin,
                              'dataMeninggal' => $tanggalMeninggal.";".$alamatMeninggal.";".$tanggalDikuburkan.";".$alamatDikuburkan,
                              'nikAhliWaris' => $nikAhliWarisParsed,
                              'namaAhliWaris' => $namaAhliWarisParsed,
                              'jenisKelaminAhliWaris' => $jenisKelaminAhliWarisParsed,
                              'kuasaAhliWaris' => $kuasaAhliWaris,
                              'randomCode' => $randomCode,
                            );
                        
                        
                        $simpan = $this->Home_model->updateData('f39_keterangan_ahli_waris' , $dataInput,"id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function delete_f39_keterangan_ahli_waris()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f39_keterangan_ahli_waris' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }



    public function showPendudukData_f39()
    {

        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];
            $kodeDesa = $namaadmin['kodeDesa'];

            $result = array();
            $hasil['kontenKK'] = "";

            $data['dataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE kodeDesa='$kodeDesa'");
            $alamatTambahan ="";
            foreach ($data['dataDesa']->result() as $row) {
                $alamatTambahan = "Kecamatan ".$row->namaKecamatan." Kabupaten ".$row->namaKabupaten;
            }

            // $keyword = $this->uri->segment(3);
            $keyword = $this->input->post('NIK');

            $noKK;
            $namaKepalaKK;       $kelengkapanPenduduk;
            $NIKKepalaKeluarga;
            $pendidikanTerakhir;
            $pekerjaan;
            $agama;
            $tglLahir;
            $tanggalLahir;
            $umur;
            $pekerjaan;
            $kewarganegaraan;
            $tempatLahir;
            $namaKepalaKeluarga;
            $anakKe = 0;
            $jenisKelamin ;
            $alamatSekarang ;
            $selectAllShop = $this->Home_model->getSelectData("*,TIMESTAMPDIFF(YEAR,tanggalLahir,CURDATE()) as umur","penduduk", "WHERE NIK='$keyword'");
            foreach ($selectAllShop->result() as $row) {
                    //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

                $noKK = $row->nomorKK;
                $namaKepalaKK = $row->namaLengkap;
                $NIKKepalaKeluarga = $row->NIK;
                $pendidikanTerakhir = $row->pendidikanTerakhir;
                $pekerjaan = $row->pekerjaan;
                $agama = $row->agama;
                $tglLahir = $row->tanggalLahir;
                $tanggalLahir = $row->tanggalLahir;
                $umur = $row->umur;
                $pekerjaan = $row->pekerjaan;
                $kewarganegaraan = $row->kewarganegaraan;
                $tempatLahir = $row->tempatLahir;
                $jenisKelamin = $row->jenisKelamin;
                $alamatSekarang = $row->alamatLengkap;

            }

            $selectKKDataKepalaKeluarga = $this->Home_model->getSelectData("*","penduduk", "WHERE nomorKK='$noKK' AND kedudukanDalamKeluarga='KEPALA KELUARGA'");
            foreach ($selectKKDataKepalaKeluarga->result() as $row) {
                $namaKepalaKeluargaReal = $row->namaLengkap;
            }

            $selectKKDataAnakKe = $this->Home_model->getSelectData("*, penduduk.NIK nikAnak","penduduk", "WHERE nomorKK='$noKK' AND kedudukanDalamKeluarga='KEPALA KELUARGA'");

            $tglLahir = explode("-", $tglLahir);
            $tglLahir = $tglLahir[2]."/".$tglLahir[1]."/".$tglLahir[0];

            // $alamatSekarang = explode(",", $alamatSekarang);
            // $alamatSekarang = $alamatSekarang[0]." ".strtoupper($alamatTambahan);

            
                //Menampilkan Array dalam Format JSON
            $hasil['noKK'] = $noKK;
            $hasil['kewarganegaraan'] = $kewarganegaraan;
            $hasil['tempatLahir'] = $tempatLahir;
            $hasil['namaKepalaKK'] = $namaKepalaKK;
            $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
            $hasil['pendidikanTerakhir'] = $pendidikanTerakhir;
            $hasil['agama'] = $agama;
            $hasil['tglLahir'] = $tglLahir;
            $hasil['tanggalLahir'] = $tanggalLahir;
            $hasil['umur'] = $umur;
            $hasil['alamatSekarang'] = ucwords(strtolower($alamatSekarang));
            $hasil['jenisKelamin'] = $jenisKelamin;
            $hasil['pekerjaan'] = strtoupper($pekerjaan);
            $hasil['namaKepalaKeluargaReal'] = strtoupper($namaKepalaKeluargaReal);
            $hasil['anakKe'] = $anakKe;
            echo json_encode($hasil);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

    }



    public function showTableF39()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f39_keterangan_ahli_waris,penduduk", "WHERE f39_keterangan_ahli_waris.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%' || penduduk.nomorKK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f39_keterangan_ahli_waris,penduduk", "WHERE f39_keterangan_ahli_waris.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f39_keterangan_ahli_waris";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
            // $NIK = $row->kuasaAhliWaris;

            //  $penduduk = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.NIK=$NIK");
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
             // foreach ($penduduk->result() as $key) {

                $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->namaLengkap,
                $row->kuasaAhliWaris,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f39_keterangan_ahli_waris(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f39_keterangan_ahli_waris('.$row->id.',\''.$row->nomorSurat.'\',\''.$row->NIK.'\',\''.$row->nama.'\',\''.$row->jenisKelamin.'\',\''.$row->dataMeninggal.'\',\''.$row->nikAhliWaris.'\',\''.$row->namaAhliWaris.'\',\''.$row->jenisKelaminAhliWaris.'\',\''.$row->kuasaAhliWaris.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f39_keterangan_ahli_waris('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        // }
    }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }




    //----------------Pelayanan Administrasi Pertanahan - Keterangan Desa - (F40) ----------------------


    public function f40_keterangan_desa()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f40_keterangan_desa";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f40_keterangan_desa/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f40_keterangan_desa_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
                $data['dataDusun'] = $this->Home_model->getSelectData("*, UPPER(namaDusun) dusX","o_data_dusun", "");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f40_keterangan_desa/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f40_keterangan_desa()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $jenisSurat = $this->input->post('jenisSurat');
        $keterangan = $this->input->post('keterangan');
        $pihakSatu = $this->input->post('pihakSatu');
        $pihakDua = $this->input->post('pihakDua');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f40",
                              'nomorSurat' => $noSurat,
                              'jenisSurat' => $jenisSurat,
                              'keterangan' => $keterangan,
                              'pihakSatu' => $pihakSatu,
                              'pihakDua' => $pihakDua,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f40_keterangan_desa' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f40_keterangan_desa_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $jenisSurat = $this->input->post('jenisSurat');
        $keterangan = $this->input->post('keterangan');
        $pihakSatu = $this->input->post('pihakSatu');
        $pihakDua = $this->input->post('pihakDua');
        $randomCode = $this->input->post('randomCode');

       


                        $dataInput = array(
                              'kode_formulir' => "f40",
                              'nomorSurat' => $noSurat,
                              'jenisSurat' => $jenisSurat,
                              'keterangan' => $keterangan,
                              'pihakSatu' => $pihakSatu,
                              'pihakDua' => $pihakDua,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f40_keterangan_desa' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f40_keterangan_desa",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan desa",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f40_keterangan_desa()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $jenisSurat = $this->input->post('jenisSurat');
        $keterangan = $this->input->post('keterangan');
        $pihakSatu = $this->input->post('pihakSatu');
        $pihakDua = $this->input->post('pihakDua');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f40",
                              'nomorSurat' => $noSurat,
                              'jenisSurat' => $jenisSurat,
                              'keterangan' => $keterangan,
                              'pihakSatu' => $pihakSatu,
                              'pihakDua' => $pihakDua,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f40_keterangan_desa' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f40_keterangan_desa()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f40_keterangan_desa' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F40()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F40()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $selectAllShop = $this->Home_model->getSelectData("*,UPPER(pekerjaan) pekT","penduduk", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        echo json_encode($hasil);

    }


    public function showDataUpdate_F40()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('id');

        // $noSurat;
        $jenisSurat;       
        $keterangan;
        $pihakSatu;
        $pihakDua;
        $selectAllShop = $this->Home_model->getSelectData("*,f40_keterangan_desa.keterangan ketx","f40_keterangan_desa", "WHERE id=$keyword");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            // $noSurat = $row->nomorSurat;
            $jenisSurat = $row->jenisSurat;
            $keterangan = $row->ketx;
            $pihakSatu = $row->pihakSatu;
            $pihakDua = $row->pihakDua;
        }

            //Menampilkan Array dalam Format JSON
        // $hasil['noSurat'] = $noSurat;
        $hasil['jenisSurat'] = $jenisSurat;
        $hasil['keterangan'] = $keterangan;
        $hasil['pihakSatu'] = $pihakSatu;
        $hasil['pihakDua'] = $pihakDua;
        echo json_encode($hasil);

    }



    public function showTable_F40()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f40_keterangan_desa", "WHERE (f40_keterangan_desa.nomorSurat LIKE '%$keyword%' || f40_keterangan_desa.jenisSurat LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f40_keterangan_desa", "WHERE (f40_keterangan_desa.nomorSurat LIKE '%$keyword%' || f40_keterangan_desa.jenisSurat LIKE '%$keyword%')");   
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f40_keterangan_desa";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->jenisSurat,
                $row->pihakSatu,
                $row->pihakDua,
                $showSigned." ".$showPrinted,
                
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f40_keterangan_desa(\''.$row->randomCode.'\',\''.$row->nomorSurat.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f40_keterangan_desa('.$row->id.',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f40_keterangan_desa('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F40()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f40'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*,UPPER(jenisSurat)jenSurat","f40_keterangan_desa", "WHERE f40_keterangan_desa.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    // $NIK = $row->NIK;
                }

                // $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*,DATE_FORMAT(penduduk.tanggalLahir, '%d-%m-%Y') tglLahirFormat, LOWER(alamatLengkap)alamatL, LOWER(pekerjaan)pekerjaan","penduduk", "WHERE penduduk.NIK=$NIK");


                
                $this->load->view('adminPage/f40_keterangan_desa/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }




    //---------------------Surat Bebas - Surat Keterangan Hibah - (F41) ------------------------


    public function f41_surat_keterangan_hibah()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f41_surat_keterangan_hibah";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f41_surat_keterangan_hibah/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f41_surat_keterangan_hibah_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
                $data['dataDusun'] = $this->Home_model->getSelectData("*, UPPER(namaDusun) dusX","o_data_dusun", "");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f41_surat_keterangan_hibah/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f41_surat_keterangan_hibah()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $namaPemberiHibah = $this->input->post('namaPemberiHibah');
        $NIKPemberiHibah = $this->input->post('NIKPemberiHibah');
        $alamatPemberiHibah = $this->input->post('alamatPemberiHibah');
        $namaPenerimaHibah = $this->input->post('namaPenerimaHibah');
        $NIKPenerimaHibah = $this->input->post('NIKPenerimaHibah');
        $alamatPenerimaHibah = $this->input->post('alamatPenerimaHibah');
        $tanahAtasNama = $this->input->post('tanahAtasNama');
        $petokNomorTanah = $this->input->post('petokNomorTanah');
        $persilNomorTanah = $this->input->post('persilNomorTanah');
        $luasTanah = $this->input->post('luasTanah');
        $kelasTanah = $this->input->post('kelasTanah');
        $blokTanah = $this->input->post('blokTanah');
        $alamatTanah = $this->input->post('alamatTanah');
        $batasUtara = $this->input->post('batasUtara');
        $batasSelatan = $this->input->post('batasSelatan');
        $batasTimur = $this->input->post('batasTimur');
        $batasBarat = $this->input->post('batasBarat');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f41",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'namaPemberiHibah' => $namaPemberiHibah,
                              'NIKPemberiHibah' => $NIKPemberiHibah,
                              'alamatPemberiHibah' => $alamatPemberiHibah,
                              'namaPenerimaHibah' => $namaPenerimaHibah,
                              'NIKPenerimaHibah' => $NIKPenerimaHibah,
                              'alamatPenerimaHibah' => $alamatPenerimaHibah,
                              'tanahAtasNama' => $tanahAtasNama,
                              'petokNomorTanah' => $petokNomorTanah,
                              'persilNomorTanah' => $persilNomorTanah,
                              'luasTanah' => $luasTanah,
                              'kelasTanah' => $kelasTanah,
                              'blokTanah' => $blokTanah,
                              'alamatTanah' => $alamatTanah,
                              'batasUtara' => $batasUtara,
                              'batasSelatan' => $batasSelatan,
                              'batasTimur' => $batasTimur,
                              'batasBarat' => $batasBarat,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f41_surat_keterangan_hibah' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f41_surat_keterangan_hibah_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $namaPemberiHibah = $this->input->post('namaPemberiHibah');
        $NIKPemberiHibah = $this->input->post('NIKPemberiHibah');
        $alamatPemberiHibah = $this->input->post('alamatPemberiHibah');
        $namaPenerimaHibah = $this->input->post('namaPenerimaHibah');
        $NIKPenerimaHibah = $this->input->post('NIKPenerimaHibah');
        $alamatPenerimaHibah = $this->input->post('alamatPenerimaHibah');
        $tanahAtasNama = $this->input->post('tanahAtasNama');
        $petokNomorTanah = $this->input->post('petokNomorTanah');
        $persilNomorTanah = $this->input->post('persilNomorTanah');
        $luasTanah = $this->input->post('luasTanah');
        $kelasTanah = $this->input->post('kelasTanah');
        $blokTanah = $this->input->post('blokTanah');
        $alamatTanah = $this->input->post('alamatTanah');
        $batasUtara = $this->input->post('batasUtara');
        $batasSelatan = $this->input->post('batasSelatan');
        $batasTimur = $this->input->post('batasTimur');
        $batasBarat = $this->input->post('batasBarat');
        $randomCode = $this->input->post('randomCode');
       


                        $dataInput = array(
                              'kode_formulir' => "f41",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'namaPemberiHibah' => $namaPemberiHibah,
                              'NIKPemberiHibah' => $NIKPemberiHibah,
                              'alamatPemberiHibah' => $alamatPemberiHibah,
                              'namaPenerimaHibah' => $namaPenerimaHibah,
                              'NIKPenerimaHibah' => $NIKPenerimaHibah,
                              'alamatPenerimaHibah' => $alamatPenerimaHibah,
                              'tanahAtasNama' => $tanahAtasNama,
                              'petokNomorTanah' => $petokNomorTanah,
                              'persilNomorTanah' => $persilNomorTanah,
                              'luasTanah' => $luasTanah,
                              'kelasTanah' => $kelasTanah,
                              'blokTanah' => $blokTanah,
                              'alamatTanah' => $alamatTanah,
                              'batasUtara' => $batasUtara,
                              'batasSelatan' => $batasSelatan,
                              'batasTimur' => $batasTimur,
                              'batasBarat' => $batasBarat,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f41_surat_keterangan_hibah' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f41_surat_keterangan_hibah",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat keterangan hibah",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f41_surat_keterangan_hibah()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $namaPemberiHibah = $this->input->post('namaPemberiHibah');
        $NIKPemberiHibah = $this->input->post('NIKPemberiHibah');
        $alamatPemberiHibah = $this->input->post('alamatPemberiHibah');
        $namaPenerimaHibah = $this->input->post('namaPenerimaHibah');
        $NIKPenerimaHibah = $this->input->post('NIKPenerimaHibah');
        $alamatPenerimaHibah = $this->input->post('alamatPenerimaHibah');
        $tanahAtasNama = $this->input->post('tanahAtasNama');
        $petokNomorTanah = $this->input->post('petokNomorTanah');
        $persilNomorTanah = $this->input->post('persilNomorTanah');
        $luasTanah = $this->input->post('luasTanah');
        $kelasTanah = $this->input->post('kelasTanah');
        $blokTanah = $this->input->post('blokTanah');
        $alamatTanah = $this->input->post('alamatTanah');
        $batasUtara = $this->input->post('batasUtara');
        $batasSelatan = $this->input->post('batasSelatan');
        $batasTimur = $this->input->post('batasTimur');
        $batasBarat = $this->input->post('batasBarat');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f41",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'namaPemberiHibah' => $namaPemberiHibah,
                              'NIKPemberiHibah' => $NIKPemberiHibah,
                              'alamatPemberiHibah' => $alamatPemberiHibah,
                              'namaPenerimaHibah' => $namaPenerimaHibah,
                              'NIKPenerimaHibah' => $NIKPenerimaHibah,
                              'alamatPenerimaHibah' => $alamatPenerimaHibah,
                              'tanahAtasNama' => $tanahAtasNama,
                              'petokNomorTanah' => $petokNomorTanah,
                              'persilNomorTanah' => $persilNomorTanah,
                              'luasTanah' => $luasTanah,
                              'kelasTanah' => $kelasTanah,
                              'blokTanah' => $blokTanah,
                              'alamatTanah' => $alamatTanah,
                              'batasUtara' => $batasUtara,
                              'batasSelatan' => $batasSelatan,
                              'batasTimur' => $batasTimur,
                              'batasBarat' => $batasBarat,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f41_surat_keterangan_hibah' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f41_surat_keterangan_hibah()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f41_surat_keterangan_hibah' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F41()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F41()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;    
        $selectAllShop = $this->Home_model->getSelectData("*,UPPER(pekerjaan) pekT","penduduk", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        echo json_encode($hasil);

    }


    public function showDataUpdate_F41()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $namaPemberiHibah;
        $NIKPemberiHibah;
        $alamatPemberiHibah;
        $namaPenerimaHibah;
        $NIKPenerimaHibah;
        $alamatPenerimaHibah;
        $tanahAtasNama;
        $petokNomorTanah;
        $persilNomorTanah;
        $luasTanah;
        $kelasTanah;
        $blokTanah;
        $alamatTanah;
        $batasUtara;
        $batasSelatan;
        $batasTimur;
        $batasBarat;      
        $selectAllShop = $this->Home_model->getSelectData("*","f41_surat_keterangan_hibah", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $namaPemberiHibah = $row->namaPemberiHibah;
            $NIKPemberiHibah = $row->NIKPemberiHibah;
            $alamatPemberiHibah = $row->alamatPemberiHibah;
            $namaPenerimaHibah = $row->namaPenerimaHibah;
            $NIKPenerimaHibah = $row->NIKPenerimaHibah;
            $alamatPenerimaHibah = $row->alamatPenerimaHibah;
            $tanahAtasNama = $row->tanahAtasNama;
            $petokNomorTanah = $row->petokNomorTanah;
            $persilNomorTanah = $row->persilNomorTanah;
            $luasTanah = $row->luasTanah;
            $kelasTanah = $row->kelasTanah;
            $blokTanah = $row->blokTanah;
            $alamatTanah = $row->alamatTanah;
            $batasUtara = $row->batasUtara;
            $batasSelatan = $row->batasSelatan;
            $batasTimur = $row->batasTimur;
            $batasBarat = $row->batasBarat;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['namaPemberiHibah'] = $namaPemberiHibah;
        $hasil['NIKPemberiHibah'] = $NIKPemberiHibah;
        $hasil['alamatPemberiHibah'] = $alamatPemberiHibah;
        $hasil['namaPenerimaHibah'] = $namaPenerimaHibah;
        $hasil['NIKPenerimaHibah'] = $NIKPenerimaHibah;
        $hasil['alamatPenerimaHibah'] = $alamatPenerimaHibah;
        $hasil['tanahAtasNama'] = $tanahAtasNama;
        $hasil['petokNomorTanah'] = $petokNomorTanah;
        $hasil['persilNomorTanah'] = $persilNomorTanah;
        $hasil['luasTanah'] = $luasTanah;
        $hasil['kelasTanah'] = $kelasTanah;
        $hasil['blokTanah'] = $blokTanah;
        $hasil['alamatTanah'] = $alamatTanah;
        $hasil['batasUtara'] = $batasUtara;
        $hasil['batasSelatan'] = $batasSelatan;
        $hasil['batasTimur'] = $batasTimur;
        $hasil['batasBarat'] = $batasBarat;
        echo json_encode($hasil);

    }



    public function showTable_F41()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f41_surat_keterangan_hibah,penduduk", "WHERE f41_surat_keterangan_hibah.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f41_surat_keterangan_hibah,penduduk", "WHERE f41_surat_keterangan_hibah.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f41_surat_keterangan_hibah";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f41_surat_keterangan_hibah(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f41_surat_keterangan_hibah('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f41_surat_keterangan_hibah('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F41()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f41'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f41_surat_keterangan_hibah", "WHERE f41_surat_keterangan_hibah.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.NIK=$NIK");


                
                $this->load->view('adminPage/f41_surat_keterangan_hibah/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }




    //---------------------Surat Bebas - Surat Kuasa - (F42) ------------------------


    public function f42_surat_kuasa()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f42_surat_kuasa";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f42_surat_kuasa/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f42_surat_kuasa_mobile()
    {

        $keyword="0";
            $keyword = $this->uri->segment(3);
            // $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
                $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
                $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
                $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
                $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
                $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
                $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
                $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
                $data['dataDusun'] = $this->Home_model->getSelectData("*, UPPER(namaDusun) dusX","o_data_dusun", "");
                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f42_surat_kuasa/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }
        
        // $this->load->view('index');
    }


    public function add_f42_surat_kuasa()
    {
        
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $namaPemberiKuasa = $this->input->post('namaPemberiKuasa');
        $NIKPemberiKuasa = $this->input->post('NIKPemberiKuasa');
        $jabatanPemberiKuasa = $this->input->post('jabatanPemberiKuasa');
        $namaPenerimaKuasa = $this->input->post('namaPenerimaKuasa');
        $NIKPenerimaKuasa = $this->input->post('NIKPenerimaKuasa');
        $jabatanPenerimaKuasa = $this->input->post('jabatanPenerimaKuasa');
        $kuasaYangDiberikan = $this->input->post('kuasaYangDiberikan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f42",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'namaPemberiKuasa' => $namaPemberiKuasa,
                              'NIKPemberiKuasa' => $NIKPemberiKuasa,
                              'jabatanPemberiKuasa' => $jabatanPemberiKuasa,
                              'namaPenerimaKuasa' => $namaPenerimaKuasa,
                              'NIKPenerimaKuasa' => $NIKPenerimaKuasa,
                              'jabatanPenerimaKuasa' => $jabatanPenerimaKuasa,
                              'kuasaYangDiberikan' => $kuasaYangDiberikan,
                              'status' => "aktif",
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f42_surat_kuasa' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function add_f42_surat_kuasa_mobile()
    {
        
        $NIKUSERLOGINED = $this->input->post('NIKUSERLOGINED');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $namaPemberiKuasa = $this->input->post('namaPemberiKuasa');
        $NIKPemberiKuasa = $this->input->post('NIKPemberiKuasa');
        $jabatanPemberiKuasa = $this->input->post('jabatanPemberiKuasa');
        $namaPenerimaKuasa = $this->input->post('namaPenerimaKuasa');
        $NIKPenerimaKuasa = $this->input->post('NIKPenerimaKuasa');
        $jabatanPenerimaKuasa = $this->input->post('jabatanPenerimaKuasa');
        $kuasaYangDiberikan = $this->input->post('kuasaYangDiberikan');
        $randomCode = $this->input->post('randomCode');
       


                        $dataInput = array(
                              'kode_formulir' => "f42",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'namaPemberiKuasa' => $namaPemberiKuasa,
                              'NIKPemberiKuasa' => $NIKPemberiKuasa,
                              'jabatanPemberiKuasa' => $jabatanPemberiKuasa,
                              'namaPenerimaKuasa' => $namaPenerimaKuasa,
                              'NIKPenerimaKuasa' => $NIKPenerimaKuasa,
                              'jabatanPenerimaKuasa' => $jabatanPenerimaKuasa,
                              'kuasaYangDiberikan' => $kuasaYangDiberikan,
                              'status' => "mobile;".$NIKUSERLOGINED,
                              'randomCode' => $randomCode,
                              
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f42_surat_kuasa' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f42_surat_kuasa",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Pembuatan Surat',
                                      'keterangan' => "Request surat kuasa",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            

    }


    public function update_f42_surat_kuasa()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noKK = $this->input->post('noKK');
        $noSurat = $this->input->post('noSurat');
        $NIKKepalaKeluarga = $this->input->post('NIKKepalaKeluarga');
        $namaKepalaKeluarga = $this->input->post('namaKepalaKeluarga');
        $namaPemberiKuasa = $this->input->post('namaPemberiKuasa');
        $NIKPemberiKuasa = $this->input->post('NIKPemberiKuasa');
        $jabatanPemberiKuasa = $this->input->post('jabatanPemberiKuasa');
        $namaPenerimaKuasa = $this->input->post('namaPenerimaKuasa');
        $NIKPenerimaKuasa = $this->input->post('NIKPenerimaKuasa');
        $jabatanPenerimaKuasa = $this->input->post('jabatanPenerimaKuasa');
        $kuasaYangDiberikan = $this->input->post('kuasaYangDiberikan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f42",
                              'nomorSurat' => $noSurat,
                              'nomorKK' => $noKK,
                              'NIK' => $NIKKepalaKeluarga,
                              'nama' => $namaKepalaKeluarga,
                              'namaPemberiKuasa' => $namaPemberiKuasa,
                              'NIKPemberiKuasa' => $NIKPemberiKuasa,
                              'jabatanPemberiKuasa' => $jabatanPemberiKuasa,
                              'namaPenerimaKuasa' => $namaPenerimaKuasa,
                              'NIKPenerimaKuasa' => $NIKPenerimaKuasa,
                              'jabatanPenerimaKuasa' => $jabatanPenerimaKuasa,
                              'kuasaYangDiberikan' => $kuasaYangDiberikan,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f42_surat_kuasa' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f42_surat_kuasa()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f42_surat_kuasa' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function selectUserByAjax_F42()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');
       
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE (namaLengkap LIKE '%$keyword%' || NIK LIKE '%$keyword%') ORDER BY namaLengkap ASC");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           

            array_push($result,array(
                'idPenduduk'  => $row->idPenduduk,
                'namaLengkap'  => $row->namaLengkap,
                'NIK'  => $row->NIK,
                
            ));
        }

        $resx = false;

        if ($selectAllShop->result()) {
            $resx = false;
        }else {
            $resx = true;
        }

            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "total_count" => $selectAllShop->num_rows(),"incomplete_results" => $resx,'items'=>$result));

    }


    public function showPendudukData_F42()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;    
        $selectAllShop = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->namaLengkap;
            $NIKKepalaKeluarga = $row->NIK;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        echo json_encode($hasil);

    }


    public function showDataUpdate_F42()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        // $keyword = $this->uri->segment(3);
        $keyword = $this->input->post('NIK');

        $noKK;
        $namaKepalaKK;       
        $NIKKepalaKeluarga;
        $namaPemberiKuasa;
        $NIKPemberiKuasa;
        $jabatanPemberiKuasa;
        $namaPenerimaKuasa;
        $NIKPenerimaKuasa;
        $jabatanPenerimaKuasa;
        $kuasaYangDiberikan;    
        $selectAllShop = $this->Home_model->getSelectData("*","f42_surat_kuasa", "WHERE NIK='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $noKK = $row->nomorKK;
            $namaKepalaKK = $row->nama;
            $NIKKepalaKeluarga = $row->NIK;
            //tambahan
            $namaPemberiKuasa = $row->namaPemberiKuasa;
            $NIKPemberiKuasa = $row->NIKPemberiKuasa;
            $jabatanPemberiKuasa = $row->jabatanPemberiKuasa;
            $namaPenerimaKuasa = $row->namaPenerimaKuasa;
            $NIKPenerimaKuasa = $row->NIKPenerimaKuasa;
            $jabatanPenerimaKuasa = $row->jabatanPenerimaKuasa;
            $kuasaYangDiberikan = $row->kuasaYangDiberikan;

        }

            //Menampilkan Array dalam Format JSON
        $hasil['noKK'] = $noKK;
        $hasil['namaKepalaKK'] = $namaKepalaKK;
        $hasil['NIKKepalaKeluarga'] = $NIKKepalaKeluarga;
        //tambahan
        $hasil['namaPemberiKuasa'] = $namaPemberiKuasa;
        $hasil['NIKPemberiKuasa'] = $NIKPemberiKuasa;
        $hasil['jabatanPemberiKuasa'] = $jabatanPemberiKuasa;
        $hasil['namaPenerimaKuasa'] = $namaPenerimaKuasa;
        $hasil['NIKPenerimaKuasa'] = $NIKPenerimaKuasa;
        $hasil['jabatanPenerimaKuasa'] = $jabatanPenerimaKuasa;
        $hasil['kuasaYangDiberikan'] = $kuasaYangDiberikan;
        echo json_encode($hasil);

    }



    public function showTable_F42()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f42_surat_kuasa,penduduk", "WHERE f42_surat_kuasa.NIK=penduduk.NIK AND (penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f42_surat_kuasa,penduduk", "WHERE f42_surat_kuasa.NIK=penduduk.NIK");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f42_surat_kuasa";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->nomorSurat,
                $row->nama,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f42_surat_kuasa(\''.$row->randomCode.'\',\''.$row->NIK.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f42_surat_kuasa('.$row->id.',\''.$row->NIK.'\',\''.$row->nomorSurat.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f42_surat_kuasa('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

   
    public function printForm_F42()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            

            $kode_form = $this->uri->segment(3);
            


            //show form by id form here
            if($kode_form=='f42'){

                $value1 = $this->uri->segment(4);
                $value2 = $this->uri->segment(6);


                $data['showData'] = $this->Home_model->getSelectData("*","f42_surat_kuasa", "WHERE f42_surat_kuasa.randomCode='$value1'");

                $idNoKK;
                foreach ($data['showData']->result() as $row) {
                    $NIK = $row->NIK;
                }

                $data['showDataDaftarKK'] = $this->Home_model->getSelectData("*","penduduk", "WHERE penduduk.NIK=$NIK");


                
                $this->load->view('adminPage/f42_surat_kuasa/print/print_page' ,$data);
            }


            else {

            }
              
            
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }

    //------------------------ Surat Bebas - F-43 Surat Pengajuan Registrasi Produk UMKM -----------------------------


    public function f43_pengajuan_registrasiprodukumkm()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataAgama'] = $this->Home_model->getSelectData("*","o_agama", "");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['dataDusun'] = $this->Home_model->getSelectData("*, UPPER(namaDusun) dusX","o_data_dusun", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f43_pengajuan_registrasiprodukumkm";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f43_pengajuan_registrasiprodukumkm/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    public function f43_pengajuan_registrasiprodukumkm_mobile()
    {
            $keyword="0";
            $keyword = $this->uri->segment(3);
            $nikUSERLOGINED = $this->uri->segment(4);
            $selectUser = $this->Home_model->getSelectData("*","penduduk", "WHERE NIK='$keyword'");

            if ($selectUser->result()) {
                $data['nikUSERLOGINED'] = $keyword;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                $this->load->view('adminPage/template/header',$data);
                // $this->load->view('adminPage/template/navigasi' ,$data);
                $this->load->view('adminPage/f43_pengajuan_registrasiprodukumkm/index_mobile' ,$data);

            }else {
                $data['nikUSERLOGINED'] = $nikUSERLOGINED;
                $data['namaUserGiven'] = "others";
                $data['namaLengkap'] = "others";
                $data['pictureUserGiven'] = 'assets/png/layers-2x.png';
                $data['jabatan'] = "others";$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

                
                // // $this->load->view('adminPage/template/navigasi' ,$data);
                // $this->load->view('adminPage/f1_kartu_keluarga/index_mobile' ,$data);
            }

    }


    public function add_f43_pengajuan_registrasiprodukumkm()
    {
        
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];
            $kodeDesa = $namaadmin['kodeDesa'];

            $namaDesa="";
            $data['dataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE kodeDesa='$kodeDesa'");
            foreach ($data['dataDesa']->result() as $row) {
                $namaDesa = $row->namaDesa;
            }

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $NIK = $this->input->post('NIK');
            $nama = $this->input->post('nama');
            $judulUMKM = $this->input->post('judulUMKM');
            $deskripsi = $this->input->post('deskripsi');
            $jenisProduk = $this->input->post('jenisProduk');
            $hargaSatuan = $this->input->post('hargaSatuan');
            $satuanProduk = $this->input->post('satuanProduk');
            $alamat = $this->input->post('alamat');
            $nomorWA = $this->input->post('nomorWA');
            $foto = $this->input->post('filesss');
            $randomCode = $this->input->post('resultx');
           
                            $imagename = "";

                            $initialize = $this->upload->initialize(array(
                                "upload_path" => 'assets/jpg/market_place',
                                "allowed_types" => "*",
                                "remove_spaces" => TRUE,
                                "overwrite" => TRUE
                            ));

                            if (!$this->upload->do_upload('filesss')) {
                                $error = array('error' => $this->upload->display_errors());
                                // echo $this->upload->display_errors();
                            } else {
                                $data = $this->upload->data();
                                $imagename = $data['file_name'];
                                
                            } 

                            if($imagename!=""){
                                $dataInput = array(
                                      
                                      'NIK' => $NIK,
                                      'nama' => $nama,
                                      'judulUMKM' => $judulUMKM,
                                      'kodeDesa' => $kodeDesa,
                                      'deskripsi' => $deskripsi,
                                      'produkDari' => $namaDesa,
                                      'jenisProduk' => $jenisProduk,
                                      'hargaSatuan' => $hargaSatuan,
                                      'satuanProduk' => $satuanProduk,
                                      'alamat' => $alamat,
                                      'nomorWA' => $nomorWA,
                                      'status' => 'Aktif',
                                      'randomCode' => $randomCode,
                                      'gambarProduk' => 'assets/jpg/market_place/'.$imagename,
                                );
                                $simpan = $this->Home_model->insertData('f43_pengajuan_registrasiprodukumkm' , $dataInput);
                            }else {
                                $dataInput = array(

                                      'NIK' => $NIK,
                                      'nama' => $nama,
                                      'judulUMKM' => $judulUMKM,
                                      'kodeDesa' => $kodeDesa,
                                      'deskripsi' => $deskripsi,
                                      'produkDari' => $namaDesa,
                                      'jenisProduk' => $jenisProduk,
                                      'hargaSatuan' => $hargaSatuan,
                                      'satuanProduk' => $satuanProduk,
                                      'alamat' => $alamat,
                                      'nomorWA' => $nomorWA,
                                      'produkDari' => $namaDesa,
                                      'status' => 'Aktif',
                                      
                                );
                                $simpan = $this->Home_model->insertData('f43_pengajuan_registrasiprodukumkm' , $dataInput);
                            }

                //Menampilkan Array dalam Format JSON
                            if ($simpan) {
                                $hasil['resultnya'] = "true";
                                echo json_encode($hasil);
                            }else {
                                $hasil['resultnya'] = "false";
                                echo json_encode($hasil);
                            }
                                

        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }
                            

    }

    public function add_f43_pengajuan_registrasiprodukumkm_mobile()
    {
        
            $kodeDesa = "14.09.07.2005";

            $namaDesa="";
            $data['dataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE kodeDesa='$kodeDesa'");
            foreach ($data['dataDesa']->result() as $row) {
                $namaDesa = $row->namaDesa;
            }
            
            $NIKUSERLOGINED = $this->input->post('nikUSERLOGINED');
        
            $NIK = $this->input->post('NIK');
            $nama = $this->input->post('nama');
            $judulUMKM = $this->input->post('judulUMKM');
            $deskripsi = $this->input->post('deskripsi');
            $jenisProduk = $this->input->post('jenisProduk');
            $hargaSatuan = $this->input->post('hargaSatuan');
            $satuanProduk = $this->input->post('satuanProduk');
            $alamat = $this->input->post('alamat');
            $nomorWA = $this->input->post('nomorWA');
            $foto = $this->input->post('filesss');
            $randomCode = $this->input->post('resultx');
       
                        $imagename = "";

                            $initialize = $this->upload->initialize(array(
                                "upload_path" => 'assets/jpg/market_place',
                                "allowed_types" => "*",
                                "remove_spaces" => TRUE,
                                "overwrite" => TRUE
                            ));

                            if (!$this->upload->do_upload('filesss')) {
                                $error = array('error' => $this->upload->display_errors());
                                // echo $this->upload->display_errors();
                            } else {
                                $data = $this->upload->data();
                                $imagename = $data['file_name'];
                                
                            } 

                            if($imagename!=""){
                                $dataInput = array(
                                      
                                      'NIK' => $NIK,
                                      'nama' => $nama,
                                      'judulUMKM' => $judulUMKM,
                                      'kodeDesa' => $kodeDesa,
                                      'deskripsi' => $deskripsi,
                                      'produkDari' => $namaDesa,
                                      'jenisProduk' => $jenisProduk,
                                      'hargaSatuan' => $hargaSatuan,
                                      'satuanProduk' => $satuanProduk,
                                      'alamat' => $alamat,
                                      'nomorWA' => $nomorWA,
                                      'status' => 'Aktif',
                                      'randomCode' => $randomCode,
                                      'gambarProduk' => 'assets/jpg/market_place/'.$imagename,
                                );
                                $simpan = $this->Home_model->insertData('f43_pengajuan_registrasiprodukumkm' , $dataInput);
                            }else {
                                $dataInput = array(

                                      'NIK' => $NIK,
                                      'nama' => $nama,
                                      'judulUMKM' => $judulUMKM,
                                      'kodeDesa' => $kodeDesa,
                                      'deskripsi' => $deskripsi,
                                      'produkDari' => $namaDesa,
                                      'jenisProduk' => $jenisProduk,
                                      'hargaSatuan' => $hargaSatuan,
                                      'satuanProduk' => $satuanProduk,
                                      'alamat' => $alamat,
                                      'nomorWA' => $nomorWA,
                                      'produkDari' => $namaDesa,
                                      'status' => 'Aktif',
                                      
                                );
                                $simpan = $this->Home_model->insertData('f43_pengajuan_registrasiprodukumkm' , $dataInput);
                            }
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }



                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE status='aktif'");
                            foreach ($selectUser->result() as $row) {
                                $dataInput = array(
                                      'kode_formulir' => "f43_pengajuan_registrasiprodukumkm",
                                      'idPengirim' => $NIKUSERLOGINED,
                                      'idPenerima' => $row->NIK,
                                      'randomCode' => $randomCode,
                                      'subjectNotif' => 'Permohonan Registrasi Produk UMKM',
                                      'keterangan' => "Request Permohonan Registrasi Produk UMKM",
                                      'statusNotif' => 'belum_dibaca',
                                      'hasShown' => '0',
                                        
                                    );
                                
                                $simpan = $this->Home_model->insertData('notification' , $dataInput);
                            }
                        //notifikasi from mobile ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                        
                            

    }


    public function update_f43_pengajuan_registrasiprodukumkm()
    {
        
        $NIK = $this->input->post('NIK');
        $nama = $this->input->post('nama');
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $judulUMKM = $this->input->post('judulUMKM');
        $deskripsi = $this->input->post('deskripsi');
        $jenisProduk = $this->input->post('jenisProduk');
        $hargaSatuan = $this->input->post('hargaSatuan');
        $satuanProduk = $this->input->post('satuanProduk');
        $alamat = $this->input->post('alamat');
        $nomorWA = $this->input->post('nomorWA');
        $foto = $this->input->post('filesss');
       
                        $imagename = "";

                        $initialize = $this->upload->initialize(array(
                            "upload_path" => 'assets/jpg/market_place',
                            "allowed_types" => "*",
                            "remove_spaces" => TRUE,
                            "overwrite" => TRUE
                        ));

                        if (!$this->upload->do_upload('filesss')) {
                            $error = array('error' => $this->upload->display_errors());
                            // echo $this->upload->display_errors();
                        } else {
                            $data = $this->upload->data();
                            $imagename = $data['file_name'];
                            
                        } 

                        if($imagename!=""){
                            $dataInput = array(
                                  
                                  'NIK' => $NIK,
                                  'nama' => $nama,
                                  'judulUMKM' => $judulUMKM,
                                  'deskripsi' => $deskripsi,
                                  'jenisProduk' => $jenisProduk,
                                  'hargaSatuan' => $hargaSatuan,
                                  'satuanProduk' => $satuanProduk,
                                  'alamat' => $alamat,
                                  'nomorWA' => $nomorWA,
                                  'gambarProduk' => 'assets/jpg/market_place/'.$imagename,
                            );
                            $simpan = $this->Home_model->updateData('f43_pengajuan_registrasiprodukumkm' , $dataInput,"id=$IDDataUpdate");
                        }else {
                            $dataInput = array(
                                  
                                  'NIK' => $NIK,
                                  'nama' => $nama,
                                  'judulUMKM' => $judulUMKM,
                                  'deskripsi' => $deskripsi,
                                  'jenisProduk' => $jenisProduk,
                                  'hargaSatuan' => $hargaSatuan,
                                  'satuanProduk' => $satuanProduk,
                                  'alamat' => $alamat,
                                  'nomorWA' => $nomorWA,
                                  
                            );
                            $simpan = $this->Home_model->updateData('f43_pengajuan_registrasiprodukumkm' , $dataInput,"id=$IDDataUpdate");
                        }


            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_f43_pengajuan_registrasiprodukumkm()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f43_pengajuan_registrasiprodukumkm' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function persetujuan_f43_pengajuan_registrasiprodukumkm()
    {

    if($this->session->userdata('adminSession')){        
        $namaadmin = $this->session->userdata('adminSession');
        $data['namaLengkap'] = $namaadmin['namaLengkap'];
        $userLoginName = $namaadmin['namaLengkap'];
        $data['levelUser'] = $namaadmin['levelUser'];
        $data['idUser'] = $namaadmin['idUser'];
        
        $idUser = $namaadmin['idUser'];
        $kodeDesa = $namaadmin['kodeDesa'];

        $namaDesa="";
        $data['dataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE kodeDesa='$kodeDesa'");
        foreach ($data['dataDesa']->result() as $row) {
            $namaDesa = $row->namaDesa;
        }
        
        $idData = $this->input->post('idData');

        $NIK = $this->input->post('NIK');
        $nama = $this->input->post('nama');
        $judulUMKM = $this->input->post('judulUMKM');
        $deskripsi = $this->input->post('deskripsi');
        $jenisProduk = $this->input->post('jenisProduk');
        $hargaSatuan = $this->input->post('hargaSatuan');
        $satuanProduk = $this->input->post('satuanProduk');
        $alamat = $this->input->post('alamat');
        $nomorWA = $this->input->post('nomorWA');
        $gambarProduk = $this->input->post('gambarProduk');

        $dataInput = array(

              'status' => "Disetujui",
              
        );

        $simpan = $this->Home_model->updateData('f43_pengajuan_registrasiprodukumkm' , $dataInput,"id=$idData");

        $dataMarket = array(
                                      
            'pemilik' => $nama,
            'judulUMKM' => $judulUMKM,
            'kodeDesa' => $kodeDesa,
            'deskripsi' => $deskripsi,
            'produkDari' => $namaDesa,
            'jenisProduk' => $jenisProduk,
            'hargaSatuan' => $hargaSatuan,
            'satuanProduk' => $satuanProduk,
            'alamat' => $alamat,
            'nomorWA' => $nomorWA,
            'status' => 'Aktif',
            'gambarProduk' => $gambarProduk,
        );

        $market = $this->Home_model->insertData('market_place' , $dataMarket);
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }

        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }
                            
    }



    public function showTable_F43()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f43_pengajuan_registrasiprodukumkm", "WHERE (f43_pengajuan_registrasiprodukumkm.judulUMKM LIKE '%$keyword%' || f43_pengajuan_registrasiprodukumkm.nama LIKE '%$keyword%' || f43_pengajuan_registrasiprodukumkm.NIK LIKE '%$keyword%') ORDER BY status='Aktif' DESC");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f43_pengajuan_registrasiprodukumkm", "WHERE (f43_pengajuan_registrasiprodukumkm.judulUMKM LIKE '%$keyword%' || f43_pengajuan_registrasiprodukumkm.nama LIKE '%$keyword%') ORDER BY status='Aktif' DESC");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f1_kartu_keluarga";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            // $headline = str_replace('\'', '"', $row->isi);
            // $headline = str_replace('"', '&quot;', $row->isi);

            if($row->status=="Aktif"){
                $showStats = '<label class="badge badge-warning">Belum Disetujui</label>';
            }else if($row->status=="Disetujui"){
                $showStats = '<label class="badge badge-success">Disetujui</label>';
            }

            $headline = str_replace('\'', '`', $row->deskripsi);
            $headline = str_replace('"', '`', $row->deskripsi);

            $tomboltrima="";

            if($row->status=="Aktif"){
                $tomboltrima='<div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-success btn-sm" style="width:97px;" onclick="persetujuan_f43_pengajuan_registrasiprodukumkm('.$row->id.',\''.$row->NIK.'\',\''.$row->nama.'\',\''.$row->judulUMKM.'\',\''.$headline.'\',\''.$row->jenisProduk.'\',\''.$row->hargaSatuan.'\',\''.$row->satuanProduk.'\',\''.$row->alamat.'\',\''.$row->nomorWA.'\',\''.$row->gambarProduk.'\')"><i class="icofont icofont-check"></i> Setujui</button>
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                      </div>

                                      <div style="height: 3px;"></div>';
            }else{$tomboltrima="";}

            array_push($result,array(
                $number+=1,
                $row->judulUMKM."<br>".$showStats,
                $row->nama,
                $btnSide=$tomboltrima.'
                                     

                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f43_pengajuan_registrasiprodukumkm(\''.$row->randomCode.'\',\''.$row->id.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f43_pengajuan_registrasiprodukumkm('.$row->id.',\''.$row->NIK.'\',\''.$row->nama.'\',\''.$row->judulUMKM.'\',\''.$headline.'\',\''.$row->jenisProduk.'\',\''.$row->hargaSatuan.'\',\''.$row->satuanProduk.'\',\''.$row->alamat.'\',\''.$row->nomorWA.'\',\''.$row->gambarProduk.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f43_pengajuan_registrasiprodukumkm('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>

                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }



    //----------------Surat Bebas - Surat Format Baru - (F44) ----------------------


    public function f44_surat_format_baru()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f44_surat_format_baru";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/f44_surat_format_baru/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }


    public function add_f44_surat_format_baru()
    {
        
        $noSurat = $this->input->post('noSurat');
        $judulSurat = $this->input->post('judulSurat');
        $keterangan = $this->input->post('keterangan');
        $status = $this->input->post('status');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f44",
                              'nomorSurat' => $noSurat,
                              'judulSurat' => $judulSurat,
                              'keterangan' => $keterangan,
                              'status' => $status,
                              'randomCode' => $randomCode,
                                
                            );
                        
                        $simpan = $this->Home_model->insertData('f44_surat_format_baru' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function update_f44_surat_format_baru()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $noSurat = $this->input->post('noSurat');
        $judulSurat = $this->input->post('judulSurat');
        $keterangan = $this->input->post('keterangan');
        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                              'kode_formulir' => "f44",
                              'nomorSurat' => $noSurat,
                              'judulSurat' => $judulSurat,
                              'keterangan' => $keterangan,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('f44_surat_format_baru' , $dataInput," id=$IDDataUpdate");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function showDataUpdate_F44()
    {
        $result = array();
        $hasil['kontenKK'] = "";

        $keyword = $this->input->post('id');

        $noKK;
        $nomorSurat;
        $judulSurat;
        $keterangan;
        $status;
        $selectAllShop = $this->Home_model->getSelectData("*","f44_surat_format_baru", "WHERE id='$keyword'");
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $nomorSurat = $row->nomorSurat;
            $judulSurat = $row->judulSurat;
            $keterangan = $row->keterangan;
            $status = $row->status;
        }

        $hasil['nomorSurat'] = $nomorSurat;
        $hasil['judulSurat'] = $judulSurat;
        $hasil['keterangan'] = $keterangan;
        $hasil['status'] = $status;
        $data['kodeForm'] = "f44_surat_format_baru";
        echo json_encode($hasil);

    }


    public function delete_f44_surat_format_baru()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('f44_surat_format_baru' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function showTable_F44()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f44_surat_format_baru", "WHERE status='template' AND (f44_surat_format_baru.nomorSurat LIKE '%$keyword%' || f44_surat_format_baru.judulSurat LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f44_surat_format_baru", "WHERE status='template' AND (f44_surat_format_baru.nomorSurat LIKE '%$keyword%' || f44_surat_format_baru.judulSurat LIKE '%$keyword%')");    
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f44_surat_format_baru";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            $data['kodeForm'] = "f44_surat_format_baru";

            array_push($result,array(
                $number+=1,
                $row->judulSurat,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f44_surat_format_baru(\''.$row->randomCode.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="salin_template_f44('.$row->id.')" href="#"><i class="icofont icofont-file"></i>Salin</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f44_surat_format_baru('.$row->id.')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f44_surat_format_baru('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>
                                          
                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

    public function showTable_F44_salinan()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","f44_surat_format_baru", "WHERE status='aktif' AND (f44_surat_format_baru.nomorSurat LIKE '%$keyword%' || f44_surat_format_baru.judulSurat LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","f44_surat_format_baru", "WHERE status='aktif' AND (f44_surat_format_baru.nomorSurat LIKE '%$keyword%' || f44_surat_format_baru.judulSurat LIKE '%$keyword%')");    
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f44_surat_format_baru";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $showSigned = "";
            $showPrinted = "";

            if($row->tertandai!=null){
                $showSigned = '<i class="icon-note text-c-green" style="display:inline-block" title="Ditandatangani"></i>';
            }else {
                if(strtolower($jabatan)=='kepala desa'){
                    $showSigned = '<a href="#" onclick="ttd_this_form(\''.$row->randomCode.'\',\''.$namaTable.'\')"><i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD. Tandatangan sekarang!"></i><a/>';
                }else {
                    $showSigned = '<i class="icon-note text-muted" style="display:inline-block" title="Belum di TTD"></i>';
                }
            }

            if($row->printed!=null){
                $showPrinted = '<i class="fa fa-print text-c-green" style="display:inline-block" title="Telah di cetak"></i>';
            }else {
                $showPrinted = '<i class="fa fa-print text-muted" style="display:inline-block" title="Belum di cetak"></i> ';
            }

            array_push($result,array(
                $number+=1,
                $row->judulSurat,
                $showSigned." ".$showPrinted,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-primary btn-sm" onclick="cetak_f44_surat_format_baru(\''.$row->randomCode.'\')"><i class="icofont icofont-printer"></i> Cetak</button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split waves-effect waves-light btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="sr-only">Toggle primary</span>
                                        </button>
                                        <div class="dropdown-menu" >
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="update_f44_surat_format_baru('.$row->id.')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="dropdown-item waves-effect waves-light tombolHapusData" onclick="delete_f44_surat_format_baru('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>
                                          
                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }



    //---------------------------------------- Berita Desa ------------------------------------------


    public function berita_desa()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataAgama'] = $this->Home_model->getSelectData("*","o_agama", "");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['dataDusun'] = $this->Home_model->getSelectData("*, UPPER(namaDusun) dusX","o_data_dusun", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/berita_desa/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }


    public function add_berita_desa()
    {
        
        $judul = $this->input->post('judul');
        $kategori = $this->input->post('kategori');
        $isi = $this->input->post('isi');
        $penulis = $this->input->post('penulis');
        $foto = $this->input->post('filesss');
       
                        $imagename = "";

                        $initialize = $this->upload->initialize(array(
                            "upload_path" => 'assets/jpg/berita',
                            "allowed_types" => "*",
                            "remove_spaces" => TRUE,
                            "overwrite" => TRUE
                        ));

                        if (!$this->upload->do_upload('filesss')) {
                            $error = array('error' => $this->upload->display_errors());
                            // echo $this->upload->display_errors();
                        } else {
                            $data = $this->upload->data();
                            $imagename = $data['file_name'];
                            
                        } 

                        if($imagename!=""){
                            $dataInput = array(
                                  
                                  'judul' => $judul,
                                  'kategori' => $kategori,
                                  'isi' => $isi,
                                  'penulis' => $penulis,
                                  'gambar' => 'assets/jpg/berita/'.$imagename,
                            );
                            $simpan = $this->Home_model->insertData('berita_desa' , $dataInput);
                        }else {
                            $dataInput = array(

                                  'judul' => $judul,
                                  'kategori' => $kategori,
                                  'isi' => $isi,
                                  'penulis' => $penulis,
                                  
                            );
                            $simpan = $this->Home_model->insertData('berita_desa' , $dataInput);
                        }

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function update_berita_desa()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $judul = $this->input->post('judul');
        $kategori = $this->input->post('kategori');
        $isi = $this->input->post('isi');
        $penulis = $this->input->post('penulis');
        $foto = $this->input->post('filesss');
       
                        $imagename = "";

                        $initialize = $this->upload->initialize(array(
                            "upload_path" => 'assets/jpg/berita',
                            "allowed_types" => "*",
                            "remove_spaces" => TRUE,
                            "overwrite" => TRUE
                        ));

                        if (!$this->upload->do_upload('filesss')) {
                            $error = array('error' => $this->upload->display_errors());
                            // echo $this->upload->display_errors();
                        } else {
                            $data = $this->upload->data();
                            $imagename = $data['file_name'];
                            
                        } 

                        if($imagename!=""){
                            $dataInput = array(
                                  
                                  'judul' => $judul,
                                  'kategori' => $kategori,
                                  'isi' => $isi,
                                  'penulis' => $penulis,
                                  'gambar' => 'assets/jpg/berita/'.$imagename,
                            );
                            $simpan = $this->Home_model->updateData('berita_desa' , $dataInput,"id=$IDDataUpdate");
                        }else {
                            $dataInput = array(
                                  'judul' => $judul,
                                  'kategori' => $kategori,
                                  'isi' => $isi,
                                  'penulis' => $penulis,
                                  
                            );
                            $simpan = $this->Home_model->updateData('berita_desa' , $dataInput,"id=$IDDataUpdate");
                        }


            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_berita_desa()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('berita_desa' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }



    public function showTable_Desa()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","berita_desa", "WHERE (berita_desa.judul LIKE '%$keyword%' || berita_desa.kategori LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","berita_desa", "WHERE (berita_desa.judul LIKE '%$keyword%' || berita_desa.kategori LIKE '%$keyword%')");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f1_kartu_keluarga";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $headline = str_replace('\'', '"', $row->isi);
            $headline = str_replace('"', '&quot;', $row->isi);

            array_push($result,array(
                $number+=1,
                $row->judul,
                $row->kategori,
                $row->penulis,
                $btnSide='
                                     <div class="" style="margin-bottom: 0px;padding-bottom: 0px">
                                        
                                          <button class="btn btn-sm btn-block btn-warning  waves-effect waves-light tombolHapusData" onclick="update_berita_desa('.$row->id.',\''.$row->judul.'\',\''.$row->kategori.'\',\''.$row->gambar.'\',\''.$headline.'\',\''.$row->penulis.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="btn btn-sm btn-block btn-danger  waves-effect waves-light tombolHapusData" onclick="delete_berita_desa('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }


    //---------------------------------------- Agenda Desa ------------------------------------------


    public function agenda_desa()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataAgama'] = $this->Home_model->getSelectData("*","o_agama", "");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['dataDusun'] = $this->Home_model->getSelectData("*, UPPER(namaDusun) dusX","o_data_dusun", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/agenda_desa/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }


    public function add_agenda_desa()
    {
        
        $tanggal = $this->input->post('tanggal');
        $agenda = $this->input->post('agenda');
        $lokasi = $this->input->post('lokasi');
        $jam = $this->input->post('jam');

                            $dataInput = array(

                                  'tanggal' => $tanggal,
                                  'agenda' => $agenda,
                                  'lokasi' => $lokasi,
                                  'jam' => $jam,
                                  'status' => 'Belum'

                                  
                            );

                            $simpan = $this->Home_model->insertData('agenda_desa' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function update_agenda_desa()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $tanggal = $this->input->post('tanggal');
        $agenda = $this->input->post('agenda');
        $lokasi = $this->input->post('lokasi');
        $jam = $this->input->post('jam');
       
                            $dataInput = array(
                                  'tanggal' => $tanggal,
                                  'agenda' => $agenda,
                                  'lokasi' => $lokasi,
                                  'jam' => $jam,
                                  
                            );

                            $simpan = $this->Home_model->updateData('agenda_desa' , $dataInput,"id=$IDDataUpdate");


            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_agenda_desa()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('agenda_desa' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function ready_agenda_desa()
    {
        
        $idData = $this->input->post('idData');

        $updateStatus = array(

              'status' => "Sudah",
              
        );

        $update = $this->Home_model->updateData('agenda_desa' , $updateStatus,"id=$idData");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($update) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }



    public function showTable_AgendaDesa()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","agenda_desa", "WHERE (agenda_desa.agenda LIKE '%$keyword%' || agenda_desa.tanggal LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","agenda_desa", "WHERE (agenda_desa.agenda LIKE '%$keyword%' || agenda_desa.tanggal LIKE '%$keyword%')");
        }
        

        $number=0;

            $jabatan = "";
            $namaTable = "f1_kartu_keluarga";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            if($row->status=="Belum"){
                $showStats = '<label class="badge badge-warning">Belum Dilaksanakan</label>';
            }else if($row->status=="Sudah"){
                $showStats = '<label class="badge badge-success">Sudah Terlaksana</label>';
            }

            array_push($result,array(
                $number+=1,
                $row->agenda.'<br>'.$showStats,
                $row->lokasi,
                $row->tanggal." ".$row->jam,
                $btnSide='
                                     <div class="" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button class="btn btn-sm btn-block btn-success  waves-effect waves-light tombolHapusData" onclick="ready_agenda_desa('.$row->id.')" href="#"><i class="icofont icofont-check"></i>Terlaksana</button>
                                        <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                        <button class="btn btn-sm btn-block btn-warning  waves-effect waves-light tombolHapusData" onclick="update_agenda_desa('.$row->id.',\''.$row->tanggal.'\',\''.$row->agenda.'\',\''.$row->lokasi.'\',\''.$row->jam.'\')" href="#"><i class="icofont icofont-pencil"></i>Edit</button>
                                        <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                        <button class="btn btn-sm btn-block btn-danger  waves-effect waves-light tombolHapusData" onclick="delete_agenda_desa('.$row->id.')" href="#"><i class="icofont icofont-trash"></i>Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }


    //---------------------------------------- Video & Foto Desa ------------------------------------------


    public function videofoto_desa()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataAgama'] = $this->Home_model->getSelectData("*","o_agama", "");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['dataDusun'] = $this->Home_model->getSelectData("*, UPPER(namaDusun) dusX","o_data_dusun", "");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['selectDataVideoFotoDesa'] = $this->Home_model->getSelectData("*","videofoto_desa", "WHERE status='aktif'");

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/videofoto_desa/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }


    public function add_foto_desa()
    {
        
        $nama = $this->input->post('nama');
       
                        $imagename = "";

                        $initialize = $this->upload->initialize(array(
                            "upload_path" => 'assets/jpg/fotovideo',
                            "allowed_types" => "*",
                            "remove_spaces" => TRUE,
                            "overwrite" => TRUE
                        ));

                        if (!$this->upload->do_upload('filesss')) {
                            $error = array('error' => $this->upload->display_errors());
                            // echo $this->upload->display_errors();
                        } else {
                            $data = $this->upload->data();
                            $imagename = $data['file_name'];
                            
                        } 

                        if($imagename!=""){
                            $dataInput = array(
                                  
                                  'nama' => $nama,
                                  'kategori' => 'Foto',
                                  'status' => 'Aktif',
                                  'videoFotoLink' => 'assets/jpg/fotovideo/'.$imagename,
                            );
                            $simpan = $this->Home_model->insertData('videofoto_desa' , $dataInput);
                        }else {
                            $dataInput = array(

                                  'nama' => $nama,
                                  'kategori' => 'Foto',
                                  'status' => 'Aktif',
                                  
                            );
                            $simpan = $this->Home_model->insertData('videofoto_desa' , $dataInput);
                        }

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function add_video_desa()
    {
        
        $namaVideo = $this->input->post('namaVideo');
        $link = $this->input->post('link');
       
                            $dataInput = array(
                                  
                                  'nama' => $namaVideo,
                                  'kategori' => 'Video',
                                  'videoFotoLink' => $link,
                                  'status' => 'Aktif',
                            );

                            $simpan = $this->Home_model->insertData('videofoto_desa' , $dataInput);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function update_foto_desa()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $nama = $this->input->post('nama');
       
                        $imagename = "";

                        $initialize = $this->upload->initialize(array(
                            "upload_path" => 'assets/jpg/fotovideo',
                            "allowed_types" => "*",
                            "remove_spaces" => TRUE,
                            "overwrite" => TRUE
                        ));

                        if (!$this->upload->do_upload('filesss')) {
                            $error = array('error' => $this->upload->display_errors());
                            // echo $this->upload->display_errors();
                        } else {
                            $data = $this->upload->data();
                            $imagename = $data['file_name'];
                            
                        } 

                        if($imagename!=""){
                            $dataInput = array(
                                  
                                  'nama' => $nama,
                                  'kategori' => 'Foto',
                                  'videoFotoLink' => 'assets/jpg/fotovideo/'.$imagename,
                            );
                            $simpan = $this->Home_model->updateData('videofoto_desa' , $dataInput,"id=$IDDataUpdate");
                        }else {
                            $dataInput = array(
                                  'nama' => $nama,
                                  'kategori' => 'Foto',
                                  
                            );
                            $simpan = $this->Home_model->updateData('videofoto_desa' , $dataInput,"id=$IDDataUpdate");
                        }


            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function update_video_desa()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdateDua');
        $namaVideo = $this->input->post('namaVideo');
        $link = $this->input->post('link');
       
                            $dataInput = array(
                                  'nama' => $namaVideo,
                                  'videoFotoLink' => $link,
                            );

                            $simpan = $this->Home_model->updateData('videofoto_desa' , $dataInput,"id=$IDDataUpdate");


            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_videofoto_desa()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('videofoto_desa' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }



    public function showTable_Video_Desa()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","videofoto_desa", "WHERE videofoto_desa.kategori='Video' AND (videofoto_desa.nama LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","videofoto_desa", "WHERE videofoto_desa.kategori='Video' AND (videofoto_desa.nama LIKE '%$keyword%')");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f1_kartu_keluarga";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            array_push($result,array(
                $number+=1,
                $row->nama,
                '<iframe width="100%" height="292px" src="https://www.youtube.com/embed/'.$row->videoFotoLink.'?controls=0"></iframe>',
                $btnSide='
                                     <div class="" style="margin-bottom: 0px;padding-bottom: 0px">
                                        
                                          <button class="btn btn-sm btn-warning btn-block waves-effect waves-light tombolHapusData" onclick="update_video_desa('.$row->id.',\''.$row->nama.'\',\''.$row->videoFotoLink.'\')" href="#"><i class="icofont icofont-pencil"></i>Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="btn btn-sm btn-danger btn-block waves-effect waves-light tombolHapusData" onclick="delete_videofoto_desa('.$row->id.')" href="#"><i class="icofont icofont-trash"></i>Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }


    public function showTable_Foto_Desa()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","videofoto_desa", "WHERE videofoto_desa.kategori='Foto' AND (videofoto_desa.nama LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","videofoto_desa", "WHERE videofoto_desa.kategori='Foto' AND (videofoto_desa.nama LIKE '%$keyword%')");
        }
       
        

        $number=0;

            $jabatan = "";
            $namaTable = "f1_kartu_keluarga";
            $namaadmin = $this->session->userdata('adminSession');
            $idUser = $namaadmin['idUser'];
            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            foreach ($selectUser->result() as $row) {
                $jabatan = strtolower($row->jabatan);
            }

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            array_push($result,array(
                $number+=1,
                $row->nama,
                '<div class="square" id="previewing" style="display:block;background-image: url('.base_url().'/'.$row->videoFotoLink.');width: 400px; height:200px;margin-bottom: 40px; margin: auto; border: 1px solid #f2f2f2;"></div>',
                $btnSide='
                                     <div class="" style="margin-bottom: 0px;padding-bottom: 0px">
                                        
                                          <button class="btn btn-sm btn-warning btn-block waves-effect waves-light tombolHapusData" onclick="update_foto_desa('.$row->id.',\''.$row->nama.'\',\''.$row->videoFotoLink.'\')" href="#"><i class="icofont icofont-pencil"></i>Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="btn btn-sm btn-danger btn-block waves-effect waves-light tombolHapusData" onclick="delete_videofoto_desa('.$row->id.')" href="#"><i class="icofont icofont-trash"></i>Hapus</button>


                                        </div>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

    //------------------------------------- Market Place ------------------------------------------


    public function market_place()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/market_place/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }


    public function add_market_place()
    {

         if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];
            $kodeDesa = $namaadmin['kodeDesa'];

            $namaDesa="";
            $data['dataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE kodeDesa='$kodeDesa'");
            foreach ($data['dataDesa']->result() as $row) {
                $namaDesa = $row->namaDesa;
            }

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $judulUMKM = $this->input->post('judulUMKM');
            $deskripsi = $this->input->post('deskripsi');
            $jenisProduk = $this->input->post('jenisProduk');
            $hargaSatuan = $this->input->post('hargaSatuan');
            $satuanProduk = $this->input->post('satuanProduk');
            $pemilik = $this->input->post('pemilik');
            $alamat = $this->input->post('alamat');
            $nomorWA = $this->input->post('nomorWA');
            $foto = $this->input->post('filesss');
           
                            $imagename = "";

                            $initialize = $this->upload->initialize(array(
                                "upload_path" => 'assets/jpg/market_place',
                                "allowed_types" => "*",
                                "remove_spaces" => TRUE,
                                "overwrite" => TRUE
                            ));

                            if (!$this->upload->do_upload('filesss')) {
                                $error = array('error' => $this->upload->display_errors());
                                // echo $this->upload->display_errors();
                            } else {
                                $data = $this->upload->data();
                                $imagename = $data['file_name'];
                                
                            } 

                            if($imagename!=""){
                                $dataInput = array(
                                      
                                      'judulUMKM' => $judulUMKM,
                                      'kodeDesa' => $kodeDesa,
                                      'deskripsi' => $deskripsi,
                                      'produkDari' => $namaDesa,
                                      'jenisProduk' => $jenisProduk,
                                      'hargaSatuan' => $hargaSatuan,
                                      'satuanProduk' => $satuanProduk,
                                      'pemilik' => $pemilik,
                                      'alamat' => $alamat,
                                      'nomorWA' => $nomorWA,
                                      'status' => 'Aktif',
                                      'gambarProduk' => 'assets/jpg/market_place/'.$imagename,
                                );
                                $simpan = $this->Home_model->insertData('market_place' , $dataInput);
                            }else {
                                $dataInput = array(

                                      'judulUMKM' => $judulUMKM,
                                      'kodeDesa' => $kodeDesa,
                                      'deskripsi' => $deskripsi,
                                      'produkDari' => $namaDesa,
                                      'jenisProduk' => $jenisProduk,
                                      'hargaSatuan' => $hargaSatuan,
                                      'satuanProduk' => $satuanProduk,
                                      'pemilik' => $pemilik,
                                      'alamat' => $alamat,
                                      'nomorWA' => $nomorWA,
                                      'produkDari' => $namaDesa,
                                      'status' => 'Aktif',
                                      
                                );
                                $simpan = $this->Home_model->insertData('market_place' , $dataInput);
                            }

                //Menampilkan Array dalam Format JSON
                            if ($simpan) {
                                $hasil['resultnya'] = "true";
                                echo json_encode($hasil);
                            }else {
                                $hasil['resultnya'] = "false";
                                echo json_encode($hasil);
                            }
                                

        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }


    }


    public function update_market_place()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $judulUMKM = $this->input->post('judulUMKM');
        $deskripsi = $this->input->post('deskripsi');
        $jenisProduk = $this->input->post('jenisProduk');
        $hargaSatuan = $this->input->post('hargaSatuan');
        $satuanProduk = $this->input->post('satuanProduk');
        $pemilik = $this->input->post('pemilik');
        $alamat = $this->input->post('alamat');
        $nomorWA = $this->input->post('nomorWA');
        $foto = $this->input->post('filesss');
       
                        $imagename = "";

                        $initialize = $this->upload->initialize(array(
                            "upload_path" => 'assets/jpg/market_place',
                            "allowed_types" => "*",
                            "remove_spaces" => TRUE,
                            "overwrite" => TRUE
                        ));

                        if (!$this->upload->do_upload('filesss')) {
                            $error = array('error' => $this->upload->display_errors());
                            // echo $this->upload->display_errors();
                        } else {
                            $data = $this->upload->data();
                            $imagename = $data['file_name'];
                            
                        } 

                        if($imagename!=""){
                            $dataInput = array(
                                  
                                  'judulUMKM' => $judulUMKM,
                                  'deskripsi' => $deskripsi,
                                  'jenisProduk' => $jenisProduk,
                                  'hargaSatuan' => $hargaSatuan,
                                  'satuanProduk' => $satuanProduk,
                                  'pemilik' => $pemilik,
                                  'alamat' => $alamat,
                                  'nomorWA' => $nomorWA,
                                  'gambarProduk' => 'assets/jpg/market_place/'.$imagename,
                            );
                            $simpan = $this->Home_model->updateData('market_place' , $dataInput,"id=$IDDataUpdate");
                        }else {
                            $dataInput = array(
                                  'judulUMKM' => $judulUMKM,
                                  'deskripsi' => $deskripsi,
                                  'jenisProduk' => $jenisProduk,
                                  'hargaSatuan' => $hargaSatuan,
                                  'satuanProduk' => $satuanProduk,
                                  'pemilik' => $pemilik,
                                  'alamat' => $alamat,
                                  'nomorWA' => $nomorWA,
                                  
                            );
                            $simpan = $this->Home_model->updateData('market_place' , $dataInput,"id=$IDDataUpdate");
                        }


            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_market_place()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('market_place' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }



    public function showTable_market_place()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","market_place", "WHERE (market_place.judulUMKM LIKE '%$keyword%' || market_place.jenisProduk LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","market_place", "WHERE (market_place.judulUMKM LIKE '%$keyword%' || market_place.jenisProduk LIKE '%$keyword%')");
        }
       
        

        $number=0;

          
        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            $headline = str_replace('\'', '`', $row->deskripsi);
            $headline = str_replace('"', '`', $row->deskripsi);

            array_push($result,array(
                $number+=1,
                $row->judulUMKM,
                $row->jenisProduk,
                $row->pemilik,
                $btnSide='
                                     <div class="" style="margin-bottom: 0px;padding-bottom: 0px">
                                        
                                          <button class="btn btn-sm btn-block btn-warning waves-effect waves-light tombolHapusData" onclick="update_market_place('.$row->id.',\''.$row->judulUMKM.'\',\''.$headline.'\',\''.$row->jenisProduk.'\',\''.$row->hargaSatuan.'\',\''.$row->satuanProduk.'\',\''.$row->pemilik.'\',\''.$row->alamat.'\',\''.$row->nomorWA.'\',\''.$row->gambarProduk.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="btn btn-sm btn-block btn-danger waves-effect waves-light tombolHapusData" onclick="delete_market_place('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }


    //------------------------------------- Monografi ------------------------------------------


     public function monografi()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['dataKategori'] = $this->Home_model->getSelectData("*,UPPER(namaKategori) nmKategori","monografi_kategori", "");
            $data['dataJenis'] = $this->Home_model->getSelectData("*,UPPER(namaJenis) nmJenis","monografi_jenis", "");

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/monografi/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }



    

    public function update_data_table_status_ttd()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $tableName = $this->input->post('tableName');
        
                            $dataInput = array(
                                  'tertandai' => 'signed',
                                  
                                  
                            );
                            $simpan = $this->Home_model->updateData($tableName , $dataInput,"randomCode='$IDDataUpdate'");


            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    

    public function add_data_sekolah()
    {

        $tipeSekolah = $this->input->post('tipeSekolah');
        $namaSekolah = $this->input->post('namaSekolah');
        $alamatSekolah = $this->input->post('alamatSekolah');
        $nomorRegistrasi = $this->input->post('nomorRegistrasi');
        $jumlahSiswa = $this->input->post('jumlahSiswa');

                            $dataInput = array(

                                  'tipeSekolah' => $tipeSekolah,
                                  'namaSekolah' => $namaSekolah,
                                  'alamatSekolah' => $alamatSekolah,
                                  'nomorRegistrasi' => $nomorRegistrasi,
                                  'jumlahSiswa' => $jumlahSiswa,
                                  'status' => "Aktif",
                                  
                            );
                            $simpan = $this->Home_model->insertData('data_sekolah' , $dataInput);
                        

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function update_data_sekolah()
    {
        
        $IDUpdateSekolah = $this->input->post('IDUpdateSekolah');
        $tipeSekolah = $this->input->post('tipeSekolah');
        $namaSekolah = $this->input->post('namaSekolah');
        $alamatSekolah = $this->input->post('alamatSekolah');
        $nomorRegistrasi = $this->input->post('nomorRegistrasi');
        $jumlahSiswa = $this->input->post('jumlahSiswa');

                            $dataInput = array(
                                  'tipeSekolah' => $tipeSekolah,
                                  'namaSekolah' => $namaSekolah,
                                  'alamatSekolah' => $alamatSekolah,
                                  'nomorRegistrasi' => $nomorRegistrasi,
                                  'jumlahSiswa' => $jumlahSiswa,
                                  
                            );
                            $simpan = $this->Home_model->updateData('data_sekolah' , $dataInput,"id=$IDUpdateSekolah");


            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_data_sekolah()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('data_sekolah' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }



    public function showTable_data_sekolah()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","data_sekolah", "WHERE (data_sekolah.tipeSekolah LIKE '%$keyword%' || data_sekolah.namaSekolah LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","data_sekolah", "WHERE (data_sekolah.tipeSekolah LIKE '%$keyword%' || data_sekolah.namaSekolah LIKE '%$keyword%')"); 
        }
       
        

        $number=0;


        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            

            array_push($result,array(
                $number+=1,
                $row->tipeSekolah,
                $row->namaSekolah,
                $row->nomorRegistrasi,
                $row->jumlahSiswa,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        
                                          <button class="btn btn-sm btn-block btn-warning  waves-effect waves-light tombolHapusData" onclick="update_data_sekolah('.$row->id.',\''.$row->tipeSekolah.'\',\''.$row->namaSekolah.'\',\''.$row->alamatSekolah.'\',\''.$row->nomorRegistrasi.'\',\''.$row->jumlahSiswa.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="btn btn-sm btn-block btn-danger  waves-effect waves-light tombolHapusData" onclick="delete_data_sekolah('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }



    public function add_data_lembaga_kesehatan()
    {

        $jenisLembaga = $this->input->post('jenisLembaga');
        $namaLembaga = $this->input->post('namaLembaga');
        $alamatLembaga = $this->input->post('alamatLembaga');

                            $dataInput = array(

                                  'jenisLembaga' => $jenisLembaga,
                                  'namaLembaga' => $namaLembaga,
                                  'alamatLembaga' => $alamatLembaga,
                                  'status' => "Aktif",
                                  
                            );
                            $simpan = $this->Home_model->insertData('data_lembaga_kesehatan' , $dataInput);
                        

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function update_data_lembaga_kesehatan()
    {
        
        $IDUpdateLembaga = $this->input->post('IDUpdateLembaga');
        $jenisLembaga = $this->input->post('jenisLembaga');
        $namaLembaga = $this->input->post('namaLembaga');
        $alamatLembaga = $this->input->post('alamatLembaga');

                            $dataInput = array(
                                  'jenisLembaga' => $jenisLembaga,
                                  'namaLembaga' => $namaLembaga,
                                  'alamatLembaga' => $alamatLembaga,
                                  
                            );
                            $simpan = $this->Home_model->updateData('data_lembaga_kesehatan' , $dataInput,"id=$IDUpdateLembaga");


            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_data_lembaga_kesehatan()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('data_lembaga_kesehatan' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }



    public function showTable_data_lembaga_kesehatan()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","data_lembaga_kesehatan", "WHERE (data_lembaga_kesehatan.jenisLembaga LIKE '%$keyword%' || data_lembaga_kesehatan.namaLembaga LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","data_lembaga_kesehatan", "WHERE (data_lembaga_kesehatan.jenisLembaga LIKE '%$keyword%' || data_lembaga_kesehatan.namaLembaga LIKE '%$keyword%')"); 
        }
       
        

        $number=0;

           

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            

            array_push($result,array(
                $number+=1,
                $row->jenisLembaga,
                $row->namaLembaga,
                $row->alamatLembaga,
                $btnSide='
                                     
                                          <button class="btn btn-sm btn-block btn-warning  waves-light tombolHapusData" onclick="update_data_lembaga_kesehatan('.$row->id.',\''.$row->jenisLembaga.'\',\''.$row->namaLembaga.'\',\''.$row->alamatLembaga.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="btn btn-sm btn-block btn-danger  waves-effect waves-light tombolHapusData" onclick="delete_data_lembaga_kesehatan('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>

                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

    //------------------------ Administrasi Online - Penduduk - Buku Induk Penduduk -------------------------


    public function buku_induk_penduduk()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['dataPekerjaan'] = $this->Home_model->getSelectData("*,UPPER(jenisPekerjaan) jenPekerjaan","o_jenis_pekerjaan", "");
            $data['dataAgama'] = $this->Home_model->getSelectData("*,UPPER(agama) agamaa","o_agama", "");
            $data['dataPendidikan'] = $this->Home_model->getSelectData("*,UPPER(jenjangpendidikan) jenPendidikan","o_jenjang_pendidikan", "");
            $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "ORDER BY idDusun ASC");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "ORDER BY namaLengkap ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/buku_induk_penduduk/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }


    public function add_buku_induk_penduduk()
    {
        
        $NIK = $this->input->post('NIK');
        $namaLengkap = $this->input->post('namaLengkap');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $agama = $this->input->post('agama');
        $pendidikanTerakhir = $this->input->post('pendidikanTerakhir');
        $pekerjaan = $this->input->post('pekerjaan');
        $rt = $this->input->post('rt');
        $rw = $this->input->post('rw');
        $kampung = $this->input->post('kampung');
        $dapatMembacaHuruf = $this->input->post('dapatMembacaHuruf');
        $kewarganegaraan = $this->input->post('kewarganegaraan');
        $jenisPenambahan = $this->input->post('jenisPenambahan');
        $jenisPengurangan = $this->input->post('jenisPengurangan');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $nomorKK = $this->input->post('nomorKK');
        $kedudukanDalamKeluarga = $this->input->post('kedudukanDalamKeluarga');
        $statusPerkawinan = $this->input->post('statusPerkawinan');
        $keterangan = $this->input->post('keterangan');


        $golonganDarah = $this->input->post('golonganDarah');
        $nomorRumah = $this->input->post('nomorRumah');
        $dusun = $this->input->post('dusun');
        $kebangsaan = $this->input->post('kebangsaan');
        $suku = $this->input->post('suku');


        $tempatDilahirkan = $this->input->post('tempatDilahirkan');
        $jamLahir = $this->input->post('jamLahir');
        $waktuLahir = $this->input->post('waktuLahir');
        $anakKe = $this->input->post('anakKe');
        $jenisKelahiran = $this->input->post('jenisKelahiran');
        $penolongKelahiran = $this->input->post('penolongKelahiran');
        $beratBayi = $this->input->post('beratBayi');
        $panjangBayi = $this->input->post('panjangBayi');
        $aktaKelahiran = $this->input->post('aktaKelahiran');
        $nomorAktaKelahiran = $this->input->post('nomorAktaKelahiran');
        $tanggalAktaKelahiran = $this->input->post('tanggalAktaKelahiran');
        $tempatDiterbitkanKTP = $this->input->post('tempatDiterbitkanKTP');
        $tanggalDiterbitkanKTP = $this->input->post('tanggalDiterbitkanKTP');
        $nikIbuKandung = $this->input->post('nikIbuKandung');
        $nikAyahKandung = $this->input->post('nikAyahKandung');
        $namaIbuKandung = $this->input->post('namaIbuKandung');
        $namaAyahKandung = $this->input->post('namaAyahKandung');


        $tempatKematian = $this->input->post('tempatKematian');
        $desaKelurahanKematian = $this->input->post('desaKelurahanKematian');
        $kecamatanKematian = $this->input->post('kecamatanKematian');
        $kabupatenKotaKematian = $this->input->post('kabupatenKotaKematian');
        $provinsiKematian = $this->input->post('provinsiKematian');
        $tanggalKematian = $this->input->post('tanggalKematian');
        $jamKematian = $this->input->post('jamKematian');
        $waktuKematian = $this->input->post('waktuKematian');
        $umurSaatMeninggal = $this->input->post('umurSaatMeninggal');
        $sebabKematian = $this->input->post('sebabKematian');
        $yangMengabarkanKematian = $this->input->post('yangMengabarkanKematian');
        $aktaKematian = $this->input->post('aktaKematian');
        $nomorAktaKematian = $this->input->post('nomorAktaKematian');
        $tanggalAktaKematian = $this->input->post('tanggalAktaKematian');


        $aktaPerkawinan = $this->input->post('aktaPerkawinan');
        $nomorAktaPerkawinan = $this->input->post('nomorAktaPerkawinan');
        $tanggalPerkawinan = $this->input->post('tanggalPerkawinan');
        $lokasiPerkawinan = $this->input->post('lokasiPerkawinan');
        $aktaPerceraian = $this->input->post('aktaPerceraian');
        $nomorAktaPerceraian = $this->input->post('nomorAktaPerceraian');
        $tanggalPerceraian = $this->input->post('tanggalPerceraian');
        $lokasiPerceraian = $this->input->post('lokasiPerceraian');

        $kelainanFisik = $this->input->post('kelainanFisik');
        $penyandangCacat = $this->input->post('penyandangCacat');  

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                            'NIK' => $NIK,
                            'namaLengkap' => $namaLengkap,
                            'jenisKelamin' => $jenisKelamin,
                            'agama' => $agama,
                            'pendidikanTerakhir' => $pendidikanTerakhir,
                            'pekerjaan' => $pekerjaan,
                            'alamatLengkap' => $kampung.", RT ".$rt."/RW ".$rw, 
                            'dapatMembacaHuruf' => $dapatMembacaHuruf,
                            'kewarganegaraan' => $kewarganegaraan,
                            'jenisPenambahan' => $jenisPenambahan,
                            'jenisPengurangan' => $jenisPengurangan,
                            'tempatLahir' => $tempatLahir,
                            'tanggalLahir' => $tanggalLahir,
                            'nomorKK' => $nomorKK,
                            'kedudukanDalamKeluarga' => $kedudukanDalamKeluarga,
                            'statusPerkawinan' => $statusPerkawinan,
                            'keterangan' => $keterangan,
                            'jenisPenambahan' => $jenisPenambahan,
                            'jenisPengurangan' => $jenisPengurangan,
                            'umum' => $golonganDarah.";".$nomorRumah.";".$dusun.";".$kebangsaan.";".$suku,
                            'kelahiran' => $tempatDilahirkan.";".$jamLahir.";".$waktuLahir.";".$anakKe.";".$jenisKelahiran.";".$penolongKelahiran.";".$beratBayi.";".$panjangBayi.";".$aktaKelahiran.";".$nomorAktaKelahiran.";".$tanggalAktaKelahiran.";".$tempatDiterbitkanKTP.";".$tanggalDiterbitkanKTP.";".$nikIbuKandung.";".$nikAyahKandung.";".$namaIbuKandung.";".$namaAyahKandung,
                            'kematian' => $tempatKematian.";".$desaKelurahanKematian.";".$kecamatanKematian.";".$kabupatenKotaKematian.";".$provinsiKematian.";".$tanggalKematian.";".$jamKematian.";".$waktuKematian.";".$umurSaatMeninggal.";".$sebabKematian.";".$yangMengabarkanKematian.";".$aktaKematian.";".$nomorAktaKematian.";".$tanggalAktaKematian,
                            'nikahCerai' => $aktaPerkawinan.";".$nomorAktaPerkawinan.";".$tanggalPerkawinan.";".$lokasiPerkawinan.";".$aktaPerceraian.";".$nomorAktaPerceraian.";".$tanggalPerceraian.";".$lokasiPerceraian,
                            'lainLain' => $kelainanFisik.";".$penyandangCacat,
                                
                            );

                        $simpan = $this->Home_model->insertData('penduduk' , $dataInput);

                        $dataInputOrtu = array(
                            'NIK' => $NIK,
                            'NIK_ibu' => $nikIbuKandung,
                            'namaIbu' => $namaIbuKandung,
                            'NIK_ayah' => $nikAyahKandung,
                            'namaAyah' => $namaAyahKandung,
                            );

                        $simpanOrtu = $this->Home_model->insertData('penduduk_orangtua' , $dataInputOrtu);

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function update_buku_induk_penduduk()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $NIK = $this->input->post('NIK');
        $namaLengkap = $this->input->post('namaLengkap');
        $jenisKelamin = $this->input->post('jenisKelamin');
        $agama = $this->input->post('agama');
        $pendidikanTerakhir = $this->input->post('pendidikanTerakhir');
        $pekerjaan = $this->input->post('pekerjaan');
        $rt = $this->input->post('rt');
        $rw = $this->input->post('rw');
        $kampung = $this->input->post('kampung');
        $dapatMembacaHuruf = $this->input->post('dapatMembacaHuruf');
        $kewarganegaraan = $this->input->post('kewarganegaraan');
        $jenisPenambahan = $this->input->post('jenisPenambahan');
        $jenisPengurangan = $this->input->post('jenisPengurangan');
        $tempatLahir = $this->input->post('tempatLahir');
        $tanggalLahir = $this->input->post('tanggalLahir');
        $nomorKK = $this->input->post('nomorKK');
        $kedudukanDalamKeluarga = $this->input->post('kedudukanDalamKeluarga');
        $statusPerkawinan = $this->input->post('statusPerkawinan');
        $keterangan = $this->input->post('keterangan');


        $golonganDarah = $this->input->post('golonganDarah');
        $nomorRumah = $this->input->post('nomorRumah');
        $dusun = $this->input->post('dusun');
        $kebangsaan = $this->input->post('kebangsaan');
        $suku = $this->input->post('suku');


        $tempatDilahirkan = $this->input->post('tempatDilahirkan');
        $jamLahir = $this->input->post('jamLahir');
        $waktuLahir = $this->input->post('waktuLahir');
        $anakKe = $this->input->post('anakKe');
        $jenisKelahiran = $this->input->post('jenisKelahiran');
        $penolongKelahiran = $this->input->post('penolongKelahiran');
        $beratBayi = $this->input->post('beratBayi');
        $panjangBayi = $this->input->post('panjangBayi');
        $aktaKelahiran = $this->input->post('aktaKelahiran');
        $nomorAktaKelahiran = $this->input->post('nomorAktaKelahiran');
        $tanggalAktaKelahiran = $this->input->post('tanggalAktaKelahiran');
        $tempatDiterbitkanKTP = $this->input->post('tempatDiterbitkanKTP');
        $tanggalDiterbitkanKTP = $this->input->post('tanggalDiterbitkanKTP');
        $nikIbuKandung = $this->input->post('nikIbuKandung');
        $nikAyahKandung = $this->input->post('nikAyahKandung');
        $namaIbuKandung = $this->input->post('namaIbuKandung');
        $namaAyahKandung = $this->input->post('namaAyahKandung');


        $tempatKematian = $this->input->post('tempatKematian');
        $desaKelurahanKematian = $this->input->post('desaKelurahanKematian');
        $kecamatanKematian = $this->input->post('kecamatanKematian');
        $kabupatenKotaKematian = $this->input->post('kabupatenKotaKematian');
        $provinsiKematian = $this->input->post('provinsiKematian');
        $tanggalKematian = $this->input->post('tanggalKematian');
        $jamKematian = $this->input->post('jamKematian');
        $waktuKematian = $this->input->post('waktuKematian');
        $umurSaatMeninggal = $this->input->post('umurSaatMeninggal');
        $sebabKematian = $this->input->post('sebabKematian');
        $yangMengabarkanKematian = $this->input->post('yangMengabarkanKematian');
        $aktaKematian = $this->input->post('aktaKematian');
        $nomorAktaKematian = $this->input->post('nomorAktaKematian');
        $tanggalAktaKematian = $this->input->post('tanggalAktaKematian');


        $aktaPerkawinan = $this->input->post('aktaPerkawinan');
        $nomorAktaPerkawinan = $this->input->post('nomorAktaPerkawinan');
        $tanggalPerkawinan = $this->input->post('tanggalPerkawinan');
        $lokasiPerkawinan = $this->input->post('lokasiPerkawinan');
        $aktaPerceraian = $this->input->post('aktaPerceraian');
        $nomorAktaPerceraian = $this->input->post('nomorAktaPerceraian');
        $tanggalPerceraian = $this->input->post('tanggalPerceraian');
        $lokasiPerceraian = $this->input->post('lokasiPerceraian');

        $kelainanFisik = $this->input->post('kelainanFisik');
        $penyandangCacat = $this->input->post('penyandangCacat');  

        $randomCode = $this->input->post('randomCode');
       
                        $dataInput = array(
                            'NIK' => $NIK,
                            'namaLengkap' => $namaLengkap,
                            'jenisKelamin' => $jenisKelamin,
                            'agama' => $agama,
                            'pendidikanTerakhir' => $pendidikanTerakhir,
                            'pekerjaan' => $pekerjaan,
                            'alamatLengkap' => $kampung.", RT ".$rt."/RW ".$rw,
                            'dapatMembacaHuruf' => $dapatMembacaHuruf,
                            'kewarganegaraan' => $kewarganegaraan,
                            'jenisPenambahan' => $jenisPenambahan,
                            'jenisPengurangan' => $jenisPengurangan,
                            'tempatLahir' => $tempatLahir,
                            'tanggalLahir' => $tanggalLahir,
                            'nomorKK' => $nomorKK,
                            'kedudukanDalamKeluarga' => $kedudukanDalamKeluarga,
                            'statusPerkawinan' => $statusPerkawinan,
                            'keterangan' => $keterangan,
                            'jenisPenambahan' => $jenisPenambahan,
                            'jenisPengurangan' => $jenisPengurangan,
                            'umum' => $golonganDarah.";".$nomorRumah.";".$dusun.";".$kebangsaan.";".$suku,
                            'kelahiran' => $tempatDilahirkan.";".$jamLahir.";".$waktuLahir.";".$anakKe.";".$jenisKelahiran.";".$penolongKelahiran.";".$beratBayi.";".$panjangBayi.";".$aktaKelahiran.";".$nomorAktaKelahiran.";".$tanggalAktaKelahiran.";".$tempatDiterbitkanKTP.";".$tanggalDiterbitkanKTP.";".$nikIbuKandung.";".$nikAyahKandung.";".$namaIbuKandung.";".$namaAyahKandung,
                            'kematian' => $tempatKematian.";".$desaKelurahanKematian.";".$kecamatanKematian.";".$kabupatenKotaKematian.";".$provinsiKematian.";".$tanggalKematian.";".$jamKematian.";".$waktuKematian.";".$umurSaatMeninggal.";".$sebabKematian.";".$yangMengabarkanKematian.";".$aktaKematian.";".$nomorAktaKematian.";".$tanggalAktaKematian,
                            'nikahCerai' => $aktaPerkawinan.";".$nomorAktaPerkawinan.";".$tanggalPerkawinan.";".$lokasiPerkawinan.";".$aktaPerceraian.";".$nomorAktaPerceraian.";".$tanggalPerceraian.";".$lokasiPerceraian,
                            'lainLain' => $kelainanFisik.";".$penyandangCacat,
                                
                            );
                        
                        $simpan = $this->Home_model->updateData('penduduk' , $dataInput," idPenduduk=$IDDataUpdate");

                        $dataInputOrtu = array(
                            'NIK_ibu' => $nikIbuKandung,
                            'namaIbu' => $namaIbuKandung,
                            'NIK_ayah' => $nikAyahKandung,
                            'namaAyah' => $namaAyahKandung,
                            );

                        $simpanOrtu = $this->Home_model->updateData('penduduk_orangtua' , $dataInputOrtu," NIK=$NIK");

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function delete_buku_induk_penduduk()
    {
        
        $idData = $this->input->post('idData');
        $NIK = $this->input->post('NIK');

        $simpan = $this->Home_model->deleteData('penduduk' , "idPenduduk='$idData'");
        $simpanortu = $this->Home_model->deleteData('penduduk_orangtua' , "NIK='$NIK'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function showTable_buku_induk_penduduk()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*,TIMESTAMPDIFF(YEAR,tanggalLahir,CURDATE()) as umur","penduduk", "WHERE penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%'");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*,TIMESTAMPDIFF(YEAR,tanggalLahir,CURDATE()) as umur","penduduk", "WHERE penduduk.namaLengkap LIKE '%$keyword%' || penduduk.NIK LIKE '%$keyword%'");
        }
       
        

        $number=0;
        $namaLengkapParsed="";
        


        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 

            $namaLengkapParsed = str_replace('\'', '&#39;', $row->namaLengkap);

            array_push($result,array(
                $number+=1,
                $row->NIK,
                $namaLengkapParsed,
                $row->jenisKelamin,
                $row->tempatLahir,
                $row->umur,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-warning btn-sm " onclick="update_buku_induk_penduduk('.$row->idPenduduk.',\''.$row->NIK.'\',\''.$namaLengkapParsed.'\',\''.$row->jenisKelamin.'\',\''.$row->statusPerkawinan.'\',\''.$row->tempatLahir.'\',\''.$row->tanggalLahir.'\',\''.$row->agama.'\',\''.$row->pendidikanTerakhir.'\',\''.$row->pekerjaan.'\',\''.$row->dapatMembacaHuruf.'\',\''.$row->kewarganegaraan.'\',\''.$row->alamatLengkap.'\',\''.$row->kedudukanDalamKeluarga.'\',\''.$row->nomorKK.'\',\''.$row->umum.'\',\''.$row->kelahiran.'\',\''.$row->kematian.'\',\''.$row->nikahCerai.'\',\''.$row->lainLain.'\',\''.$row->jenisPenambahan.'\',\''.$row->jenisPengurangan.'\',\''.$row->keterangan.'\')" href="#"><i class="icofont icofont-pencil"></i></button>
                                    </div>
                                    <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-danger btn-sm" onclick="delete_buku_induk_penduduk('.$row->idPenduduk.')" href="#"><i class="icofont icofont-trash"></i></button>
                                        </button>
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

    //----------------------------------- Layanan aspirasi dan Pengaduan Masyarakat ----------------------------------

    //PENGADUAN

    public function pengaduan()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            $data['jabatan'] = $jabatan;
            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/pengaduan/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }





    public function showTable_data_pengaduan()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","aspirasi_dan_pengaduan", "WHERE aspirasi_dan_pengaduan.jenis='pengaduanLainnya' AND (aspirasi_dan_pengaduan.judul LIKE '%$keyword%' || aspirasi_dan_pengaduan.kategori LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","aspirasi_dan_pengaduan", "WHERE aspirasi_dan_pengaduan.jenis='pengaduanLainnya' AND (aspirasi_dan_pengaduan.judul LIKE '%$keyword%' || aspirasi_dan_pengaduan.kategori LIKE '%$keyword%')");    
        }
       
        

        $number=0;

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            if($row->status=="Ditolak"){
                $showStats = '<label class="badge badge-danger">Ditolak</label>';
            }else if($row->status=="Telah Ditangani"){
                $showStats = '<label class="badge badge-success">Telah ditangani</label>';
            }else if($row->status=="Menunggu"){
                $showStats = '<label class="badge badge-warning">Belum diolah dan masih menunggu</label>';
            }
            

            array_push($result,array(
                $number+=1,
                $row->judul."<br/>".$showStats,
                $row->kategori,
                $row->dateCreated,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-secondary btn-sm " onclick="info_pengaduan('.$row->id.',\''.$row->judul.'\',\''.$row->kategori.'\',\''.$row->isi.'\',\''.$row->foto.'\',\''.$row->nikPelapor.'\',\''.$row->namaPelapor.'\',\''.$row->dateCreated.'\')" href="#"><i class="fa fa-info-circle fa-2x"></i></button>
                                    </div>

                                    <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-warning btn-sm" title="Ubah status ke menunggu" onclick="status_menunggu('.$row->id.')" href="#"><i class="fa fa-circle-o fa-2x"></i></button>
                                        </button>
                                    </div>

                                    <div style="height: 3px;"></div>

                                    <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-success btn-sm " title="Ubah status ke telah tertangani"  onclick="status_sudahditangani('.$row->id.')" href="#"><i class="fa fa-check-square fa-2x"></i></button>
                                    </div>

                                    <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-danger btn-sm" title="Ubah status ke ditolak"  onclick="status_ditolak('.$row->id.')" href="#"><i class="fa fa-times-circle fa-2x"></i></button>
                                        </button>
                                    </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }


    public function pengaduan_menunggu()
    {
        
        $idData = $this->input->post('idData');

                            $dataInput = array(
                                  'status' => "Menunggu",
                                  
                            );

                            $simpan = $this->Home_model->updateData('aspirasi_dan_pengaduan' , $dataInput,"id=$idData");


            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function pengaduan_sudahditangani()
    {
        
        $idData = $this->input->post('idData');

                            $dataInput = array(
                                  'status' => "Telah Ditangani",
                                  
                            );

                            $simpan = $this->Home_model->updateData('aspirasi_dan_pengaduan' , $dataInput,"id=$idData");


            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    public function pengaduan_ditolak()
    {
        
        $idData = $this->input->post('idData');

                            $dataInput = array(
                                  'status' => "Ditolak",
                                  
                            );

                            $simpan = $this->Home_model->updateData('aspirasi_dan_pengaduan' , $dataInput,"id=$idData");


            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }


    //ASPIRASI


    public function aspirasi()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            $data['jabatan'] = $jabatan;
            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/aspirasi/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }



    public function showTable_data_aspirasi()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","aspirasi_dan_pengaduan", "WHERE aspirasi_dan_pengaduan.jenis='aspirasi' AND (aspirasi_dan_pengaduan.judul LIKE '%$keyword%' || aspirasi_dan_pengaduan.kategori LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","aspirasi_dan_pengaduan", "WHERE aspirasi_dan_pengaduan.jenis='aspirasi' AND (aspirasi_dan_pengaduan.judul LIKE '%$keyword%' || aspirasi_dan_pengaduan.kategori LIKE '%$keyword%')");    
        }
       
        

        $number=0;

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            if($row->status=="Ditolak"){
                $showStats = '<label class="badge badge-danger">Ditolak</label>';
            }else if($row->status=="Telah Ditangani"){
                $showStats = '<label class="badge badge-success">Telah ditangani</label>';
            }else if($row->status=="Menunggu"){
                $showStats = '<label class="badge badge-warning">Belum diolah dan masih menunggu</label>';
            }
            

            array_push($result,array(
                $number+=1,
                $row->judul."<br/>".$showStats,
                $row->kategori,
                $row->dateCreated,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-secondary btn-sm " onclick="info_aspirasi('.$row->id.',\''.$row->judul.'\',\''.$row->kategori.'\',\''.$row->isi.'\',\''.$row->foto.'\',\''.$row->nikPelapor.'\',\''.$row->namaPelapor.'\',\''.$row->dateCreated.'\')" href="#"><i class="fa fa-info-circle fa-2x"></i></button>
                                    </div>

                                    <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-warning btn-sm" onclick="status_menunggu('.$row->id.')" href="#"><i class="fa fa-circle-o fa-2x"></i></button>
                                        </button>
                                    </div>

                                    <div style="height: 3px;"></div>

                                    <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-success btn-sm " onclick="status_sudahditangani('.$row->id.')" href="#"><i class="fa fa-check-square fa-2x"></i></button>
                                    </div>

                                    <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-danger btn-sm" onclick="status_ditolak('.$row->id.')" href="#"><i class="fa fa-times-circle fa-2x"></i></button>
                                        </button>
                                    </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }


    //PERMINTAAN INFORMASI


    public function permintaan_informasi()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            $data['jabatan'] = $jabatan;
            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/permintaan_informasi/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }
    


    public function showTable_data_permintaan_informasi()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","aspirasi_dan_pengaduan", "WHERE aspirasi_dan_pengaduan.jenis='permintaanInformasi' AND (aspirasi_dan_pengaduan.judul LIKE '%$keyword%' || aspirasi_dan_pengaduan.kategori LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","aspirasi_dan_pengaduan", "WHERE aspirasi_dan_pengaduan.jenis='permintaanInformasi' AND (aspirasi_dan_pengaduan.judul LIKE '%$keyword%' || aspirasi_dan_pengaduan.kategori LIKE '%$keyword%')");    
        }
       
        

        $number=0;

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           if($row->status=="Ditolak"){
                $showStats = '<label class="badge badge-danger">Ditolak</label>';
            }else if($row->status=="Telah Ditangani"){
                $showStats = '<label class="badge badge-success">Telah ditangani</label>';
            }else if($row->status=="Menunggu"){
                $showStats = '<label class="badge badge-warning">Belum diolah dan masih menunggu</label>';
            }
            

            array_push($result,array(
                $number+=1,
                $row->judul."<br/>".$showStats,
                $row->kategori,
                $row->dateCreated,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-secondary btn-sm " onclick="info_permintaan_informasi('.$row->id.',\''.$row->judul.'\',\''.$row->kategori.'\',\''.$row->isi.'\',\''.$row->foto.'\',\''.$row->nikPelapor.'\',\''.$row->namaPelapor.'\',\''.$row->dateCreated.'\')" href="#"><i class="fa fa-info-circle fa-2x"></i></button>
                                    </div>

                                    <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-warning btn-sm" onclick="status_menunggu('.$row->id.')" href="#"><i class="fa fa-circle-o fa-2x"></i></button>
                                        </button>
                                    </div>

                                    <div style="height: 3px;"></div>

                                    <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-success btn-sm " onclick="status_sudahditangani('.$row->id.')" href="#"><i class="fa fa-check-square fa-2x"></i></button>
                                    </div>

                                    <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-danger btn-sm" onclick="status_ditolak('.$row->id.')" href="#"><i class="fa fa-times-circle fa-2x"></i></button>
                                        </button>
                                    </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }



    //KEBAKARAN


    public function kebakaran()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            $data['jabatan'] = $jabatan;
            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/kebakaran/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }
    


    public function showTable_data_kebakaran()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","aspirasi_dan_pengaduan", "WHERE aspirasi_dan_pengaduan.jenis='kebakaran' AND (aspirasi_dan_pengaduan.judul LIKE '%$keyword%' || aspirasi_dan_pengaduan.kategori LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","aspirasi_dan_pengaduan", "WHERE aspirasi_dan_pengaduan.jenis='kebakaran' AND (aspirasi_dan_pengaduan.judul LIKE '%$keyword%' || aspirasi_dan_pengaduan.kategori LIKE '%$keyword%')");    
        }
       
        

        $number=0;

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            if($row->status=="Ditolak"){
                $showStats = '<label class="badge badge-danger">Ditolak</label>';
            }else if($row->status=="Telah Ditangani"){
                $showStats = '<label class="badge badge-success">Telah ditangani</label>';
            }else if($row->status=="Menunggu"){
                $showStats = '<label class="badge badge-warning">Belum diolah dan masih menunggu</label>';
            }
            

            array_push($result,array(
                $number+=1,
                $row->judul."<br/>".$showStats,
                $row->dateCreated,
                $row->nikPelapor.'<div style="height: 3px;"></div>'.$row->namaPelapor,
                $row->nikKorban.'<div style="height: 3px;"></div>'.$row->namaKorban,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-secondary btn-sm " onclick="info_kebakaran('.$row->id.',\''.$row->judul.'\',\''.$row->foto.'\',\''.$row->nikPelapor.'\',\''.$row->namaPelapor.'\',\''.$row->dateCreated.'\',\''.$row->nikKorban.'\',\''.$row->namaKorban.'\',\''.$row->alamatKorban.'\')" href="#"><i class="fa fa-info-circle fa-2x"></i></button>
                                    </div>

                                    <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-warning btn-sm" onclick="status_menunggu('.$row->id.')" href="#"><i class="fa fa-circle-o fa-2x"></i></button>
                                        </button>
                                    </div>

                                    <div style="height: 3px;"></div>

                                    <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-success btn-sm " onclick="status_sudahditangani('.$row->id.')" href="#"><i class="fa fa-check-square fa-2x"></i></button>
                                    </div>

                                    <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-danger btn-sm" onclick="status_ditolak('.$row->id.')" href="#"><i class="fa fa-times-circle fa-2x"></i></button>
                                        </button>
                                    </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }


    //DARURAT KESEHATAN


    public function darurat_kesehatan()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            $data['jabatan'] = $jabatan;
            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/darurat_kesehatan/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }
    


    public function showTable_data_darurat_kesehatan()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","aspirasi_dan_pengaduan", "WHERE aspirasi_dan_pengaduan.jenis='daruratKesehatan' AND (aspirasi_dan_pengaduan.judul LIKE '%$keyword%' || aspirasi_dan_pengaduan.kategori LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","aspirasi_dan_pengaduan", "WHERE aspirasi_dan_pengaduan.jenis='daruratKesehatan' AND (aspirasi_dan_pengaduan.judul LIKE '%$keyword%' || aspirasi_dan_pengaduan.kategori LIKE '%$keyword%')");    
        }
       
        

        $number=0;

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            if($row->status=="Ditolak"){
                $showStats = '<label class="badge badge-danger">Ditolak</label>';
            }else if($row->status=="Telah Ditangani"){
                $showStats = '<label class="badge badge-success">Telah ditangani</label>';
            }else if($row->status=="Menunggu"){
                $showStats = '<label class="badge badge-warning">Belum diolah dan masih menunggu</label>';
            }
            

            array_push($result,array(
                $number+=1,
                $row->judul."<br/>".$showStats,
                $row->dateCreated,
                $row->nikPelapor.'<div style="height: 3px;"></div>'.$row->namaPelapor,
                $row->nikKorban.'<div style="height: 3px;"></div>'.$row->namaKorban,
                $btnSide='
                                     <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-secondary btn-sm " onclick="info_darurat_kesehatan('.$row->id.',\''.$row->judul.'\',\''.$row->foto.'\',\''.$row->nikPelapor.'\',\''.$row->namaPelapor.'\',\''.$row->dateCreated.'\',\''.$row->nikKorban.'\',\''.$row->namaKorban.'\',\''.$row->alamatKorban.'\')" href="#"><i class="fa fa-info-circle fa-2x"></i></button>
                                    </div>

                                    <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-warning btn-sm" onclick="status_menunggu('.$row->id.')" href="#"><i class="fa fa-circle-o fa-2x"></i></button>
                                        </button>
                                    </div>

                                    <div style="height: 3px;"></div>

                                    <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-success btn-sm " onclick="status_sudahditangani('.$row->id.')" href="#"><i class="fa fa-check-square fa-2x"></i></button>
                                    </div>

                                    <div class="btn-group dropdown-split-primary" style="margin-bottom: 0px;padding-bottom: 0px">
                                        <button type="button" class="btn btn-danger btn-sm" onclick="status_ditolak('.$row->id.')" href="#"><i class="fa fa-times-circle fa-2x"></i></button>
                                        </button>
                                    </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }


    public function add_data_tanggap_desa()
    {
        
        $nikUSERLOGINED = $this->input->post('nikUSERLOGINED');
        $judul = $this->input->post('judul');
        $namapelapor = $this->input->post('namapelapor');
        $nikpelapor = $this->input->post('nikpelapor');
        $namakorban = $this->input->post('namakorban');
        $alamatkorban = $this->input->post('alamatkorban');
        $kategori = $this->input->post('kategori');
        $keterangan = $this->input->post('keterangan');
        $tipePage = $this->input->post('tipePage');

                                $imagename = "";

                                $initialize = $this->upload->initialize(array(
                                    "upload_path" => 'assets/jpg/pengaduan/',
                                    "allowed_types" => "*",
                                    "remove_spaces" => TRUE,
                                    "overwrite" => TRUE
                                ));

                                if (!$this->upload->do_upload('filesss')) {
                                    $error = array('error' => $this->upload->display_errors());
                                    // echo $this->upload->display_errors();
                                } else {
                                    $data = $this->upload->data();
                                    $imagename = $data['file_name'];
                                    
                                } 

                                if($imagename!=""){
                                    $dataInput = array(
                                          'judul' => $judul,
                                          'jenis' => $tipePage,
                                          'kategori' => $kategori,
                                          'isi' => $keterangan,
                                          'nikPelapor' => $nikpelapor,
                                          'namaPelapor' => $namapelapor,
                                          'namaKorban' => $namakorban,
                                          'alamatKorban' => $alamatkorban,
                                          'status' => "Menunggu",
                                          'foto' => 'assets/jpg/pengaduan/'.$imagename,
                                    );
                                    $simpan = $this->Home_model->insertData('aspirasi_dan_pengaduan' , $dataInput);
                                }else {
                                    $dataInput = array(
                                          'judul' => $judul,
                                          'jenis' => $tipePage,
                                          'kategori' => $kategori,
                                          'isi' => $keterangan,
                                          'nikPelapor' => $nikpelapor,
                                          'namaPelapor' => $namapelapor,
                                          'namaKorban' => $namakorban,
                                          'alamatKorban' => $alamatkorban,
                                          'status' => "Menunggu",
                                          
                                          
                                    );
                                    $simpan = $this->Home_model->insertData('aspirasi_dan_pengaduan' , $dataInput);
                                }

                                //Menampilkan Array dalam Format JSON
                                if ($simpan) {
                                    $hasil['resultnya'] = "true";
                                    echo json_encode($hasil);
                                }else {
                                    $hasil['resultnya'] = "false";
                                    echo json_encode($hasil);
                                }


    }

    // Data UMUM Monografi
    public function add_data_monografi_umum()
    {

        $lahanSawah = $this->input->post('lahanSawah');
        $lahanLadang = $this->input->post('lahanLadang');
        $lahanPerkebunan = $this->input->post('lahanPerkebunan');
        $lahanPeternakan = $this->input->post('lahanPeternakan');
        $hutan = $this->input->post('hutan');
        $lahanLainnya = $this->input->post('lahanLainnya');
        //bataswilayah
        $sebelahUtara = $this->input->post('sebelahUtara');
        $sebelahSelatan = $this->input->post('sebelahSelatan');
        $sebelahBarat = $this->input->post('sebelahBarat');
        $sebelahTimur = $this->input->post('sebelahTimur');
        //orbitasi
        $pusatKecamatan = $this->input->post('pusatKecamatan');
        $pusatKabupaten = $this->input->post('pusatKabupaten');
        $pusatProvinsi = $this->input->post('pusatProvinsi');
        //sarana prasarana
        $kantorDesa = $this->input->post('kantorDesa');
        $poskesdes = $this->input->post('poskesdes');

                            $updateStatus = array(

                                  'status' => "Off",
                                  
                            );

                            $update = $this->Home_model->updateData('data_monografi_umum' , $updateStatus,"status='Aktif'");

                            $dataInput = array(

                                  'luasWilayah' => $lahanSawah.";".$lahanLadang.";".$lahanPerkebunan.";".$lahanPeternakan.";".$hutan.";".$lahanLainnya,
                                  'batasWilayah' => $sebelahUtara.";".$sebelahSelatan.";".$sebelahBarat.";".$sebelahTimur,
                                  'orbitasi' => $pusatKecamatan.";".$pusatKabupaten.";".$pusatProvinsi,
                                  'saranaPrasarana' => $kantorDesa.";".$poskesdes,
                                  'status' => "Aktif",
                                  
                            );
                            $simpan = $this->Home_model->insertData('data_monografi_umum' , $dataInput);
                        

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function update_data_monografi_umum()
    {
        
        $IDUpdateMonografi = $this->input->post('IDUpdateMonografi');
        $lahanSawah = $this->input->post('lahanSawah');
        $lahanLadang = $this->input->post('lahanLadang');
        $lahanPerkebunan = $this->input->post('lahanPerkebunan');
        $lahanPeternakan = $this->input->post('lahanPeternakan');
        $hutan = $this->input->post('hutan');
        $lahanLainnya = $this->input->post('lahanLainnya');
        //bataswilayah
        $sebelahUtara = $this->input->post('sebelahUtara');
        $sebelahSelatan = $this->input->post('sebelahSelatan');
        $sebelahBarat = $this->input->post('sebelahBarat');
        $sebelahTimur = $this->input->post('sebelahTimur');
        //orbitasi
        $pusatKecamatan = $this->input->post('pusatKecamatan');
        $pusatKabupaten = $this->input->post('pusatKabupaten');
        $pusatProvinsi = $this->input->post('pusatProvinsi');
        //sarana prasarana
        $kantorDesa = $this->input->post('kantorDesa');
        $poskesdes = $this->input->post('poskesdes');

                            $dataInput = array(
                                  'luasWilayah' => $lahanSawah.";".$lahanLadang.";".$lahanPerkebunan.";".$lahanPeternakan.";".$hutan.";".$lahanLainnya,
                                  'batasWilayah' => $sebelahUtara.";".$sebelahSelatan.";".$sebelahBarat.";".$sebelahTimur,
                                  'orbitasi' => $pusatKecamatan.";".$pusatKabupaten.";".$pusatProvinsi,
                                  'saranaPrasarana' => $kantorDesa.";".$poskesdes,
                                  
                            );
                            $simpan = $this->Home_model->updateData('data_monografi_umum' , $dataInput,"id=$IDUpdateMonografi");


            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function aktifkan_data_monografi_umum()
    {
        
        $idData = $this->input->post('idData');

        $updateOff = array(

              'status' => "Off",
              
        );

        $off = $this->Home_model->updateData('data_monografi_umum' , $updateOff,"status='Aktif'");

        $updateStatus = array(

              'status' => "Aktif",
              
        );

        $update = $this->Home_model->updateData('data_monografi_umum' , $updateStatus,"id=$idData");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($update) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }
    

    public function delete_data_monografi_umum()
    {
        
        $idData = $this->input->post('idData');

        $updateStatus = array(

              'status' => "Delete",
              
        );

        $update = $this->Home_model->updateData('data_monografi_umum' , $updateStatus,"id=$idData");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($update) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }



    public function showTable_data_monografi_umum()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","data_monografi_umum", "WHERE (data_monografi_umum.luasWilayah LIKE '%$keyword%' || data_monografi_umum.orbitasi LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","data_monografi_umum", "WHERE status='Aktif' OR status='Off' AND (data_monografi_umum.luasWilayah LIKE '%$keyword%' || data_monografi_umum.orbitasi LIKE '%$keyword%')"); 
        }
        

        $number=0;
           

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            if($row->status=="Off"){
                $showStats = '<label class="badge badge-danger">Off</label>';
            }else if($row->status=="Aktif"){
                $showStats = '<label class="badge badge-success">Aktif</label>';
            }

            $lwilayah = explode(";", $row->luasWilayah);
            $bwilayah = explode(";", $row->batasWilayah);
            $orbt = explode(";", $row->orbitasi);
            $saranapras = explode(";", $row->saranaPrasarana);

            array_push($result,array(
                $number+=1,

                "Lahan Sawah :".$lwilayah[0]."<br>".
                "Lahan Ladang :".$lwilayah[1]."<br>".
                "Lahan Perkebunan :".$lwilayah[2]."<br>".
                "Lahan Peternakan :".$lwilayah[3]."<br>".
                "Hutan :".$lwilayah[4]."<br>".
                "Lahan Lainnya :".$lwilayah[5],

                "Sebelah Utara :".$bwilayah[0]."<br>".
                "Sebelah Selatan :".$bwilayah[1]."<br>".
                "Sebelah Barat :".$bwilayah[2]."<br>".
                "Sebelah Timur :".$bwilayah[3],

                "Kecamatan :".$orbt[0]."<br>".
                "Kabupaten :".$orbt[1]."<br>".
                "Provinsi :".$orbt[2],

                "Kantor Desa :".$saranapras[0]."<br>".
                "Poskesdes :".$saranapras[1],

                $showStats,

                $btnSide='
                                     
                                          <div class="" style="margin-bottom: 0px;padding-bottom: 0px">
                                        
                                          <button class="btn btn-sm btn-block btn-success waves-effect waves-light tombolHapusData" onclick="aktifkan_data_monografi_umum('.$row->id.')" href="#"><i class="icofont icofont-check"></i> Aktifkan</button>
                                          <div style="height: 1px;"></div>
                                          <button class="btn btn-sm btn-block btn-warning waves-effect waves-light tombolHapusData" onclick="update_data_monografi_umum('.$row->id.',\''.$row->luasWilayah.'\',\''.$row->batasWilayah.'\',\''.$row->orbitasi.'\'
                                          ,\''.$row->saranaPrasarana.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="btn btn-sm btn-block btn-danger waves-effect waves-light tombolHapusData" onclick="delete_data_monografi_umum('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>

                                          </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

    public function selectLastFormNumber()
    {
        $result = array();
        $kodeForm = $this->input->post('kodeForm');

        $suratKe = 0;
        $inisialSurat = "";       
        
        
        // $suratKe = $selectForm->num_rows()+1;

        $selectListForm = $this->Home_model->getSelectData("*",'list_formulir', "WHERE nama_function LIKE '$kodeForm%'");
        foreach ($selectListForm->result() as $row) {
            $inisialSurat = $row->inisialSurat;
        }

        $putQueryAllTable = "";
        $selectAllTable = $this->Home_model->getSelectData("*",'list_formulir', "ORDER BY id ASC");
        foreach ($selectAllTable->result() as $row) {
            $putQueryAllTable.= "SELECT ".$row->nama_table.".id,".$row->nama_table.".nomorSurat FROM ".$row->nama_table." WHERE ".$row->nama_table.".nomorSurat NOT LIKE 'Diisi oleh%' AND YEAR(".$row->nama_table.".dateCreated)=YEAR(NOW()) UNION ";
        }

        $putQueryAllTable = substr($putQueryAllTable, 0,-7);
        

        $arrayUrutanSuratDalamSetahun = array();
        $arrayUrutanPerForm = array();

        $v = "";
        $noSu = "";
        $getAllDataFromAllTables = $this->db->query($putQueryAllTable);
        foreach ($getAllDataFromAllTables->result() as $row) {
            $v = $row->nomorSurat;
            $noSu = explode("/", $v);

            if(count($noSu)!=0){
                array_push($arrayUrutanSuratDalamSetahun, (int)$noSu[0]);
            }   
        }
        rsort($arrayUrutanSuratDalamSetahun);


        $v2 = "";
        $noSu2 = "";
        $selectForm = $this->Home_model->getSelectData("*",$kodeForm, "WHERE ".$kodeForm.".nomorSurat NOT LIKE 'Diisi oleh%' AND ".$kodeForm.".status NOT LIKE 'template' AND YEAR(".$kodeForm.".dateCreated)=YEAR(NOW())");
        foreach ($selectForm->result() as $row) {
            $v2 = $row->nomorSurat;
            $noSu2 = explode("/", $v2);

            if(count($noSu2)!=0){
                array_push($arrayUrutanPerForm, (int)$noSu2[4]);
            }
        }

        rsort($arrayUrutanPerForm);

        $nomorSuratFix = "";

                        $bulan = date('m');
                        if($bulan=='01'){
                            $bulan='I';
                        }else if($bulan=='02'){
                            $bulan='II';
                        }else if($bulan=='03'){
                            $bulan='III';
                        }else if($bulan=='04'){
                            $bulan='IV';
                        }else if($bulan=='05'){
                            $bulan='V';
                        }else if($bulan=='06'){
                            $bulan='VI';
                        }else if($bulan=='07'){
                            $bulan='VII';
                        }else if($bulan=='08'){
                            $bulan='VIII';
                        }else if($bulan=='09'){
                            $bulan='IX';
                        }else if($bulan=='10'){
                            $bulan='X';
                        }else if($bulan=='11'){
                            $bulan='XI';
                        }else if($bulan=='12'){
                            $bulan='XII';
                        }

        if(count($arrayUrutanPerForm)==0){
            $suratKe = "001";
        }else {

            $suratKe = $arrayUrutanPerForm[0]+1;

            if($arrayUrutanPerForm[0] < 10){
                $suratKe = "00".$suratKe;
            }else if($arrayUrutanPerForm[0] < 100){
                $suratKe = "0".$suratKe;
            }else {
                $suratKe = $suratKe;
            }
        }

        //nomor urut awal
        if(count($arrayUrutanSuratDalamSetahun)==0){
            $jmlSuratTahunIni = "001";
        }else {
            $jmlSuratTahunIni = $arrayUrutanSuratDalamSetahun[0]+1;

            if($arrayUrutanSuratDalamSetahun[0] < 10){
                $jmlSuratTahunIni = "00".$jmlSuratTahunIni;
            }else if($arrayUrutanSuratDalamSetahun[0] < 100){
                $jmlSuratTahunIni = "0".$jmlSuratTahunIni;
            }else {
                $jmlSuratTahunIni = $jmlSuratTahunIni;
            }
        }

        

        $nomorSuratFix = $jmlSuratTahunIni."/".$inisialSurat."/".$bulan."/".date('Y')."/".$suratKe;
        
            //Menampilkan Array dalam Format JSON
        $hasil['nomorSurat'] = $nomorSuratFix;
        
        
        echo json_encode($hasil);

    }



    public function add_data_lainnya()
    {

        $jenis = $this->input->post('jenis');
        $jumlah = $this->input->post('jumlah');
        $satuan = $this->input->post('satuan');

                            $dataInput = array(

                                  'idJenis' => $jenis,
                                  'jumlah' => $jumlah,
                                  'satuan' => $satuan,
                                  'status' => "aktif",
                                  
                            );
                            $simpan = $this->Home_model->insertData('monografi_seluruhnya' , $dataInput);
                        

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function update_data_lainnya()
    {
        
        $IDUpdateLainnya = $this->input->post('IDUpdateLainnya');
        $jenis = $this->input->post('jenis');
        $jumlah = $this->input->post('jumlah');
        $satuan = $this->input->post('satuan');

                            $dataInput = array(
                                  'idJenis' => $jenis,
                                  'jumlah' => $jumlah,
                                  'satuan' => $satuan,
                                  
                            );
                            $simpan = $this->Home_model->updateData('monografi_seluruhnya' , $dataInput,"idSeluruhnya=$IDUpdateLainnya");


            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

   


    public function delete_data_lainnya()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('monografi_seluruhnya' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }



    public function showTable_data_lainnya()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","monografi_seluruhnya,monografi_jenis,monografi_kategori", "WHERE monografi_kategori.idKategori=monografi_jenis.idKategori AND monografi_jenis.idJenis=monografi_seluruhnya.idJenis AND (monografi_jenis.namaJenis LIKE '%$keyword%' || monografi_kategori.namaKategori LIKE '%$keyword%') ORDER BY monografi_kategori.namaKategori");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","monografi_seluruhnya,monografi_jenis,monografi_kategori", "WHERE monografi_kategori.idKategori=monografi_jenis.idKategori AND monografi_jenis.idJenis=monografi_seluruhnya.idJenis AND (monografi_jenis.namaJenis LIKE '%$keyword%' || monografi_kategori.namaKategori LIKE '%$keyword%') ORDER BY monografi_kategori.namaKategori"); 
        }
       
        

        $number=0;


        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {
                //Memasukkan Nama dan ID kedalam Array Kosong yang telah dibuat 
           
            

            array_push($result,array(
                $number+=1,
                $row->namaKategori,
                $row->namaJenis,
                $row->jumlah." ".$row->satuan,
                $btnSide='
                                     <div class="" style="margin-bottom: 0px;padding-bottom: 0px">
                                        
                                          <button class="btn btn-sm btn-block btn-warning waves-effect waves-light tombolHapusData" onclick="update_data_lainnya('.$row->idSeluruhnya.',\''.$row->idKategori.'\',\''.$row->idJenis.'\',\''.$row->jumlah.'\'
                                          ,\''.$row->satuan.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="btn btn-sm btn-block btn-danger waves-effect waves-light tombolHapusData" onclick="delete_data_lainnya('.$row->idSeluruhnya.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>


                                        
                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

    // Data UMUM Monografi
    public function get_jenis_monografi()
    {

        $valueSent = $this->input->post('valueSent');
        
                            
                            $update = $this->Home_model->getSelectData('*' , "monografi_jenis","WHERE idKategori=$valueSent");

                            $sendOption = "";
                            foreach ($update->result() as $row) {
                                $sendOption.="<option value='".$row->idJenis."'>".$row->namaJenis."</option>";
                            }

                            
            //Menampilkan Array dalam Format JSON
                        if ($update) {
                            $hasil['resultnya'] = $sendOption;
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function add_data_kategori()
    {

        $namaKategori = $this->input->post('namaKategori');

                            $dataInput = array(

                                  'namaKategori' => $namaKategori,
                                  'status' => "aktif",
                                  
                            );
                            $simpan = $this->Home_model->insertData('monografi_kategori' , $dataInput);
                        

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }


    public function add_data_jenis()
    {

        $kategori = $this->input->post('kategori2');
        $namaJenis = $this->input->post('namaJenis');

                            $dataInput = array(

                                  'idKategori' => $kategori,
                                  'namaJenis' => $namaJenis,
                                  'status' => "aktif",
                                  
                            );
                            $simpan = $this->Home_model->insertData('monografi_jenis' , $dataInput);
                        

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }



    // -----------------------------------------------  DANA DESA -------------------------------

    public function dana_desa()
    {
        if($this->session->userdata('adminSession')){        
            $namaadmin = $this->session->userdata('adminSession');
            $data['namaLengkap'] = $namaadmin['namaLengkap'];
            $userLoginName = $namaadmin['namaLengkap'];
            $data['levelUser'] = $namaadmin['levelUser'];
            $data['idUser'] = $namaadmin['idUser'];
            
            $idUser = $namaadmin['idUser'];

            $namaUser = "";
            $pictureUser = "";
            $jabatan = "";

            $selectUser = $this->Home_model->getSelectData("*","user", "WHERE idUser=$idUser");
            $data['dataUser'] = $this->Home_model->getSelectData("*","user", "WHERE user.idUser=$idUser");
            $data['getDataKepalaKK'] = $this->Home_model->getSelectData("*","penduduk", "WHERE kedudukanDalamKeluarga='KEPALA KELUARGA' ORDER BY namaLengkap ASC");
            $data['getDataJenjangPendidikan'] = $this->Home_model->getSelectData("*","o_jenjang_pendidikan", "ORDER BY id ASC");
            $data['getDataPekerjaan'] = $this->Home_model->getSelectData("*","o_jenis_pekerjaan", "ORDER BY id ASC");
            $data['getDataDusun'] = $this->Home_model->getSelectData("*","o_data_dusun", "WHERE kodeDesa='14.09.07.2005' ORDER BY idDusun ASC");
            $data['getAgama'] = $this->Home_model->getSelectData("*","o_agama", "ORDER BY id ASC");
            
            foreach ($selectUser->result() as $row) {
                # code...
                $namaUser = $row->namaLengkap;
                $pictureUser = $row->pictureProfile;
                $jabatan = $row->jabatan;
            }

            $data['namaUserGiven'] = $namaUser;
            $data['pictureUserGiven'] = $pictureUser;
            strtolower($data['jabatan'] = $jabatan);$data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");
            $data['kodeForm'] = "f21_suket_pengantar_barang";

            
            $this->load->view('adminPage/template/header',$data);
            $this->load->view('adminPage/template/navigasi' ,$data);
            $this->load->view('adminPage/dana_desa/index' ,$data);
        }else{

            $data['getDataDesa'] = $this->Home_model->getSelectData("*","o_data_desa", "WHERE status='aktif'");  
            $this->load->view('loginregister/login.php',$data); 
        }

        // $this->load->view('index');
    }

    

    public function add_dana_desa()
    {
        
        $namaSumberDana = $this->input->post('namaSumberDana');
        $keterangan = $this->input->post('keterangan');
        $nominal = $this->input->post('nominal');

        $keteranganParsed = "";
        $nominalParsed = "";
        
        for ($i=0; $i < count($keterangan); $i++) { 
            $keteranganParsed.= $keterangan[$i].";";
        }

        for ($i=0; $i < count($nominal); $i++) { 
            $nominalParsed.= $nominal[$i].";";
        }




        $imagename = "";

                                $initialize = $this->upload->initialize(array(
                                    "upload_path" => 'assets/jpg/dokumen_danadesa/',
                                    "allowed_types" => "*",
                                    "remove_spaces" => TRUE,
                                    "overwrite" => TRUE
                                ));

                                if (!$this->upload->do_upload('filesss')) {
                                    $error = array('error' => $this->upload->display_errors());
                                    // echo $this->upload->display_errors();
                                } else {
                                    $data = $this->upload->data();
                                    $imagename = $data['file_name'];
                                    
                                } 

                                if($imagename!=""){
                                    $dataInput = array(
                                          'kodeDesa' => "14.09.07.2005",
                                          'namaSumberDana' => $namaSumberDana,
                                          'keterangan' => $keteranganParsed,
                                          'nominal' => $nominalParsed,
                                          'urlFileDokumen' => 'assets/jpg/dokumen_danadesa/'.$imagename,
                                    );
                                    $simpan = $this->Home_model->insertData('dana_desa' , $dataInput);
                                }else {
                                    $dataInput = array(
                                          'kodeDesa' => "14.09.07.2005",
                                          'namaSumberDana' => $namaSumberDana,
                                          'keterangan' => $keteranganParsed,
                                          'nominal' => $nominalParsed,
                                          
                                          
                                    );
                                    $simpan = $this->Home_model->insertData('dana_desa' , $dataInput);
                                }

            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function update_dana_desa()
    {
        
        $IDDataUpdate = $this->input->post('IDDataUpdate');
        $namaSumberDana = $this->input->post('namaSumberDana');
        $keterangan = $this->input->post('keterangan');
        $nominal = $this->input->post('nominal');

        $keteranganParsed = "";
        $nominalParsed = "";
        
        for ($i=0; $i < count($keterangan); $i++) { 
            $keteranganParsed.= $keterangan[$i].";";
        }

        for ($i=0; $i < count($nominal); $i++) { 
            $nominalParsed.= $nominal[$i].";";
        }
       

        $imagename = "";

                                $initialize = $this->upload->initialize(array(
                                    "upload_path" => 'assets/jpg/dokumen_danadesa/',
                                    "allowed_types" => "*",
                                    "remove_spaces" => TRUE,
                                    "overwrite" => TRUE
                                ));

                                if (!$this->upload->do_upload('filesss')) {
                                    $error = array('error' => $this->upload->display_errors());
                                    // echo $this->upload->display_errors();
                                } else {
                                    $data = $this->upload->data();
                                    $imagename = $data['file_name'];
                                    
                                } 

                                if($imagename!=""){
                                    $dataInput = array(
                                          'kodeDesa' => "14.09.07.2005",
                                          'namaSumberDana' => $namaSumberDana,
                                          'keterangan' => $keteranganParsed,
                                          'nominal' => $nominalParsed,
                                          'urlFileDokumen' => 'assets/jpg/dokumen_danadesa/'.$imagename,
                                    );

                                    $simpan = $this->Home_model->updateData('dana_desa' , $dataInput,"id=$IDDataUpdate");
                                }else {
                                    $dataInput = array(
                                          'kodeDesa' => "14.09.07.2005",
                                          'namaSumberDana' => $namaSumberDana,
                                          'keterangan' => $keteranganParsed,
                                          'nominal' => $nominalParsed,
                                    );

                                    $simpan = $this->Home_model->updateData('dana_desa' , $dataInput,"id=$IDDataUpdate");
                                }


            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            

    }

    public function delete_dana_desa()
    {
        
        $idData = $this->input->post('idData');

        $simpan = $this->Home_model->deleteData('dana_desa' , "id='$idData'");
        
     
            //Menampilkan Array dalam Format JSON
                        if ($simpan) {
                            $hasil['resultnya'] = "true";
                            echo json_encode($hasil);
                        }else {
                            $hasil['resultnya'] = "false";
                            echo json_encode($hasil);
                        }
                            
    }

    public function showTable_dana_desa()
    {
        $result = array();

        $keyword = $this->uri->segment(3);
        // $keyword = $this->input->post('term');

        if ($keyword!="") {
            $selectAllShop = $this->Home_model->getSelectData("*","dana_desa", "WHERE (dana_desa.namaSumberDana LIKE '%$keyword%')");    
        }else {
            $selectAllShop = $this->Home_model->getSelectData("*","dana_desa", "WHERE (dana_desa.namaSumberDana LIKE '%$keyword%')");   
        }
       
        

        $number=0;

        $btnSide = "";
        foreach ($selectAllShop->result() as $row) {

            array_push($result,array(
                $number+=1,
                $row->namaSumberDana,
                $btnSide='             

                                    <button class="btn btn-sm btn-block btn-warning  waves-light tombolHapusData" onclick="update_dana_desa('.$row->id.',\''.$row->namaSumberDana.'\',\''.$row->keterangan.'\',\''.$row->nominal.'\',\''.$row->urlFileDokumen.'\')" href="#"><i class="icofont icofont-pencil"></i> Edit</button>
                                          <div class="dropdown-divider" style="padding:0px;margin:0px;"></div>
                                          <button class="btn btn-sm btn-block btn-danger  waves-effect waves-light tombolHapusData" onclick="delete_dana_desa('.$row->id.')" href="#"><i class="icofont icofont-trash"></i> Hapus</button>

                                      </div>'
                
            ));
        }

        
            //Menampilkan Array dalam Format JSON
        echo json_encode(array( "draw" => 1,"recordsTotal" => $selectAllShop->num_rows(),"recordsFiltered" => $selectAllShop->num_rows(),'data'=>$result));

    }

}